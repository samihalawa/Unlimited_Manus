import{e as k}from"./emitter-E5P-NQ8u.js";import{q as A,u as L,c as I,r as m,a1 as P,d as U,h as $,e as a,w as p,F as R,Z as G,i as B,ax as K,a5 as V,k as X,t as x,x as j,a4 as Y,O as q,P as D,l as _,Q as F,U as ee,ac as E,a9 as te,ay as H,W as z,az as oe,o as ae,f as J,a6 as le,aa as Q}from"./index-BlGINy0I.js";import{s as C}from"./default-model-setting-BLTNnQx2.js";import{A as ne}from"./driver-BxHdV7Lz.js";import{S as W}from"./SettingOutlined-DBsrnDLF.js";import"./http-BD0bo4QE.js";const se={class:"select-model"},ie={__name:"selectModel",props:{platform_models:{type:Array,default:()=>[]},model_choose:{type:Number,default:()=>0},select_type:{type:String,default:()=>"assistant"}},setup(T){const{t:r}=L(),h=T,M=I(()=>Array.isArray(h.platform_models)&&h.platform_models.length>0),l=m(M.value?h.model_choose:null);P(()=>h.model_choose,e=>{M.value&&(l.value=e)});const g=I(()=>{const e=[];if(M.value)for(const n of h.platform_models){let t=e.find(v=>v.name===n.platform_name);t||(t={name:n.platform_name,models:[]},e.push(t)),t.models.push({id:n.id,model_name:n.model_name,group_name:n.group_name,model_id:n.model_id})}return e});return P(l,async e=>{e&&k.emit("default-model-changed",{setting_type:h.select_type,model_id:Number(e)})}),(e,n)=>{const t=V,v=K,o=Y;return $(),U("div",se,[a(o,{value:l.value,"onUpdate:value":n[0]||(n[0]=u=>l.value=u),style:{width:"97%"},placeholder:j(r)("setting.defaultModel.emptymodelTips"),disabled:!M.value,class:"select_model_ed"},{default:p(()=>[($(!0),U(R,null,G(g.value,u=>($(),B(v,{key:u.name,label:u.name},{default:p(()=>[($(!0),U(R,null,G(u.models,b=>($(),B(t,{key:b.id,value:b.name},{default:p(()=>[X(x(b.model_name)+" | "+x(b.group_name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["value","placeholder","disabled"])])}}},Z=A(ie,[["__scopeId","data-v-b83e4c8f"]]),de={__name:"assistantSetting",props:{modelValue:{type:Object,required:!0}},setup(T,{expose:r}){var b;const{t:h}=L(),M=T,l=m(!1),g=m(!1),e={assistant_name:null,prompt:null,temperature:1,top_p:1,max_tokens:5,enable_length_limit:!1},n=((b=M.modelValue)==null?void 0:b.config)||{},t=q({...e,...n});P(()=>M.modelValue,s=>{if(s&&s.config){const i=s.config;for(const S in e)t[S]=i.hasOwnProperty(S)?i[S]:e[S]}},{deep:!0,immediate:!0});const v=()=>{l.value=!0},o=()=>{g.value=!0,k.emit("default-assistant-setting-save",t),setTimeout(()=>{l.value=!1,g.value=!1},300)},u=()=>{l.value=!1};return r({showModal:v}),(s,i)=>{const S=ee,f=F,O=E,c=te,N=H,d=D,w=z;return $(),B(w,{open:l.value,"onUpdate:open":i[6]||(i[6]=y=>l.value=y),class:"assistant-setting-modal",title:s.$t("setting.defaultModel.assistantSettings"),onOk:o,onCancel:u,confirmLoading:g.value,okButtonProps:{disabled:!1},okText:s.$t("setting.defaultModel.confirm"),cancelText:s.$t("setting.defaultModel.cancel"),centered:!0},{default:p(()=>[a(d,{class:"assistant-setting-form",layout:"vertical"},{default:p(()=>[a(f,{label:s.$t("setting.defaultModel.assistantName")},{default:p(()=>[a(S,{value:t.assistant_name,"onUpdate:value":i[0]||(i[0]=y=>t.assistant_name=y),placeholder:s.$t("setting.defaultModel.assistantNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(f,{label:s.$t("setting.defaultModel.prompt")},{default:p(()=>[a(O,{value:t.prompt,"onUpdate:value":i[1]||(i[1]=y=>t.prompt=y),rows:4,placeholder:s.$t("setting.defaultModel.promptPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),_("p",null,x(s.$t("setting.defaultModel.modelParameters")),1),a(f,{label:s.$t("setting.defaultModel.temperature")},{default:p(()=>[a(c,{value:t.temperature,"onUpdate:value":i[2]||(i[2]=y=>t.temperature=y),min:0,max:1,step:.01,marks:{0:"0",.5:"0.5",1:"1"},style:{width:"90%"}},null,8,["value"])]),_:1},8,["label"]),a(f,{label:s.$t("setting.defaultModel.topP")},{default:p(()=>[a(c,{value:t.top_p,"onUpdate:value":i[3]||(i[3]=y=>t.top_p=y),min:0,max:1,step:.01,marks:{0:"0",.5:"0.5",1:"1"},style:{width:"90%"}},null,8,["value"])]),_:1},8,["label"]),a(f,{label:s.$t("setting.defaultModel.maxTokens")},{default:p(()=>[a(c,{value:t.max_tokens,"onUpdate:value":i[4]||(i[4]=y=>t.max_tokens=y),min:1,max:20,step:1,marks:{1:"1",5:"5",10:"10",15:"15",20:"20"},style:{width:"90%"}},null,8,["value"])]),_:1},8,["label"]),a(f,{label:s.$t("setting.defaultModel.enableLengthLimit")},{default:p(()=>[a(N,{checked:t.enable_length_limit,"onUpdate:checked":i[5]||(i[5]=y=>t.enable_length_limit=y)},null,8,["checked"])]),_:1},8,["label"])]),_:1})]),_:1},8,["open","title","confirmLoading","okText","cancelText"])}}},ue=A(de,[["__scopeId","data-v-19123fec"]]),re={__name:"TopicNaming",props:{modelValue:{type:Object,required:!0}},setup(T,{expose:r}){const{t:h}=L(),M=T,l=m(!1),g=m(!1),e=q({config:{prompt:"",auto_naming:!1},originalConfig:null});I(()=>e.originalConfig?JSON.stringify(e.config)!==JSON.stringify(e.originalConfig):!1),P(()=>M.modelValue,o=>{o&&o.config&&(Object.assign(e.config,o.config),e.originalConfig=JSON.parse(JSON.stringify(o.config)))},{deep:!0});const n=()=>{l.value=!0},t=()=>{g.value=!0,k.emit("default-topic_naming-setting-save",e.config),setTimeout(()=>{l.value=!1,g.value=!1},1e3)},v=()=>{l.value=!1};return r({showModal:n}),(o,u)=>{const b=H,s=F,i=E,S=D,f=z;return $(),B(f,{class:"topic-naming",open:l.value,"onUpdate:open":u[2]||(u[2]=O=>l.value=O),title:o.$t("setting.defaultModel.topicNamingSettings"),onOk:t,onCancel:v,confirmLoading:g.value,okButtonProps:{disabled:!1},centered:!0,okText:o.$t("setting.defaultModel.confirm"),cancelText:o.$t("setting.defaultModel.cancel")},{default:p(()=>[a(S,{model:e,layout:"vertical"},{default:p(()=>[a(s,{label:o.$t("setting.defaultModel.topicAutoNaming")},{default:p(()=>[a(b,{checked:e.config.auto_naming,"onUpdate:checked":u[0]||(u[0]=O=>e.config.auto_naming=O)},null,8,["checked"])]),_:1},8,["label"]),a(s,{label:o.$t("setting.defaultModel.topicNamingPrompt")},{default:p(()=>[a(i,{value:e.config.prompt,"onUpdate:value":u[1]||(u[1]=O=>e.config.prompt=O),rows:4,placeholder:o.$t("setting.defaultModel.promptPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading","okText","cancelText"])}}},ce={__name:"translation",props:{modelValue:{type:Object,required:!0}},setup(T,{expose:r}){const{t:h}=L(),M=T,l=m(!1),g=m(!1),e=q({config:{prompt:""},originalConfig:null});I(()=>e.originalConfig?JSON.stringify(e.config)!==JSON.stringify(e.originalConfig):!1),P(()=>M.modelValue,o=>{o&&o.config&&(Object.assign(e.config,o.config),e.originalConfig=JSON.parse(JSON.stringify(o.config)))},{deep:!0});const n=()=>{l.value=!0},t=()=>{g.value=!0,k.emit("default-translation-setting-save",e.config),setTimeout(()=>{l.value=!1,g.value=!1},1e3)},v=()=>{l.value=!1};return r({showModal:n}),(o,u)=>{const b=E,s=F,i=D,S=z;return $(),B(S,{open:l.value,"onUpdate:open":u[1]||(u[1]=f=>l.value=f),title:o.$t("setting.defaultModel.translationSettings"),onOk:t,onCancel:v,confirmLoading:g.value,okButtonProps:{disabled:!1},centered:!0,okText:o.$t("setting.defaultModel.confirm"),cancelText:o.$t("setting.defaultModel.cancel")},{default:p(()=>[a(i,{model:e,layout:"vertical"},{default:p(()=>[a(s,{label:o.$t("setting.defaultModel.translationPrompt")},{default:p(()=>[a(b,{value:e.config.prompt,"onUpdate:value":u[0]||(u[0]=f=>e.config.prompt=f),rows:4,placeholder:o.$t("setting.defaultModel.promptPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading","okText","cancelText"])}}},me={class:"default-model-container"},pe={class:"default-item assistant-container"},fe={class:"item-header item"},_e={class:"item-title"},ge={class:"item-model item"},ve={class:"assistant setting"},Me={class:"item-tips item"},he={class:"default-item topic-naming-contianer"},be={class:"item-header item"},ye={class:"item-title"},Se={class:"item-model item"},ke={class:"topic_naming setting"},Ne={class:"item-tips item"},$e={__name:"index",setup(T){const{t:r}=L(),h=m([]),M=m(0),l=m(0),g=m(0),e=m(0),n=m({setting_type:"assistant",config:{assistant_name:null,prompt:null,temperature:1,top_p:1,max_tokens:5,enable_length_limit:!1},model_id:0}),t=m({setting_type:"topic-naming",config:{auto_naming:!1,prompt:""},model_id:0}),v=m({setting_type:"translation",config:{prompt:""},model_id:0}),o=m({setting_type:"browser-use",config:{},model_id:0}),u=m(),b=m(),s=m(),i=()=>{u.value.showModal()},S=()=>{b.value.showModal()};oe(async()=>{const c=await C.getModels();h.value=c,(await C.getModelBySetting()).forEach(d=>{d.setting_type==="assistant"&&(n.value=d,M.value=d.model_id),d.setting_type==="topic-naming"&&(t.value=d,l.value=d.model_id),d.setting_type==="translation"&&(v.value=d,g.value=d.model_id),d.setting_type==="browser-use"&&(o.value=d,e.value=d.model_id)})});let f=null;const O=async()=>{f=ne({animate:!0,showProgress:!0,prevBtnText:r("setting.prevStep"),nextBtnText:r("setting.nextStep"),doneBtnText:r("setting.doneStep"),steps:[{element:".assistant-container",popover:{side:"bottom",title:r("setting.defaultModel.defaultAssistantModel"),description:r("setting.defaultModel.assistantModelTips"),onNextClick:async()=>{Q(()=>{f.moveNext()})}}},{element:".topic-naming-contianer",popover:{side:"bottom",title:r("setting.defaultModel.topicNamingModel"),description:r("setting.defaultModel.topicNamingModelTips"),onNextClick:async()=>{Q(()=>{localStorage.setItem("tour_end","true"),localStorage.setItem("tour","false"),f.moveNext()})}}}]}),f.drive()};return ae(async()=>{localStorage.getItem("tour")==="true"&&localStorage.getItem("tour_end")!=="true"&&O(),k.on("default-assistant-setting-save",c=>{n.value.config=c,console.log(n.value),C.updateModel(n.value).then(N=>{J.success(r("setting.defaultModel.saveSuccess"))})}),k.on("default-topic_naming-setting-save",c=>{t.value.config=c,C.updateModel(t.value).then(N=>{J.success(r("setting.defaultModel.saveSuccess"))})}),k.on("default-translation-setting-save",c=>{v.value.config=c,C.updateModel(v.value).then(N=>{J.success(r("setting.defaultModel.saveSuccess"))})}),k.on("default-model-changed",c=>{const N=c.setting_type,d=c.model_id;N==="assistant"?(M.value=d,n.value.model_id=d,C.updateModel(n.value).then(w=>{})):N==="topic-naming"?(l.value=d,t.value.model_id=d,C.updateModel(t.value).then(w=>{})):N==="translation"?(g.value=d,v.value.model_id=d,C.updateModel(v.value).then(w=>{})):N==="browser-use"&&(e.value=d,o.value.model_id=d,C.updateModel(o.value).then(w=>{}))})}),le(()=>{k.off("default-assistant-setting-save"),k.off("default-topic_naming-setting-save"),k.off("default-translation-setting-save"),k.off("default-model-changed")}),(c,N)=>($(),U(R,null,[_("div",me,[_("div",pe,[_("div",fe,[_("p",_e,x(c.$t("setting.defaultModel.defaultAssistantModel")),1)]),_("div",ge,[a(Z,{class:"select_model",platform_models:h.value,model_choose:M.value,select_type:n.value.setting_type},null,8,["platform_models","model_choose","select_type"]),_("div",ve,[a(j(W),{class:"icon",onClick:i})])]),_("div",Me,[_("p",null,x(c.$t("setting.defaultModel.assistantModelTips")),1)])]),_("div",he,[_("div",be,[_("p",ye,x(c.$t("setting.defaultModel.topicNamingModel")),1)]),_("div",Se,[a(Z,{class:"select_model",platform_models:h.value,model_choose:l.value,select_type:t.value.setting_type},null,8,["platform_models","model_choose","select_type"]),_("div",ke,[a(j(W),{class:"icon",onClick:S})])]),_("div",Ne,[_("p",null,x(c.$t("setting.defaultModel.topicNamingModelTips")),1)])])]),a(ue,{ref_key:"assistantSettingRef",ref:u,"model-value":n.value},null,8,["model-value"]),a(re,{ref_key:"topicNamingSettingRef",ref:b,"model-value":t.value},null,8,["model-value"]),a(ce,{ref_key:"translationSettingRef",ref:s,"model-value":v.value},null,8,["model-value"])],64))}},Te=A($e,[["__scopeId","data-v-aed76351"]]),Oe={class:"default-model-service"},Ce={__name:"defaultModelSetting",setup(T){return(r,h)=>($(),U("div",Oe,[_("h2",null,x(r.$t("setting.defaultModel.DefaultModelSetting")),1),a(Te)]))}},Ie=A(Ce,[["__scopeId","data-v-8006b2f1"]]);export{Ie as default};
