import{_ as L,c as Y,l as n,a as d,t as r,w as m,X as j,C as B,d as h,u as k,o as C,r as c,$ as M,g as w,h as E,V as H,W as A,a0 as G}from"./index-COUhflQL.js";import{s as x}from"./membership-C5eKkiGZ.js";import{s as U}from"./auth-D-et7D_s.js";import{u as V}from"./user-B_oAAdlF.js";import"./http-B5vhwVWP.js";const J={__name:"UserProfile",setup(I,{expose:a}){a();const{user:i,membership:e,points:P}=V(),y=h(),{t}=k();C(()=>{b()});const l=c(1),u=c(5),_=c(0),p=c([]),o=c(!1),g=c(""),v=c(!1),f=c(""),T=()=>{o.value=!0,g.value=i.user_name},z=async()=>{v.value=!0,f.value=""},N=async()=>{await U.updateUsername(g.value),o.value=!1,i.user_name=g.value,w.success(t("account.updateSuccess"))},O=async()=>{await U.resetPassword("",f.value,i.mobile),v.value=!1,w.success(t("account.updateSuccess"))},b=async()=>{const s=await x.getOrderList({page:l.value,pageSize:u.value});console.log(s),_.value=s.total,p.value=s.list},R=s=>{l.value=s.current,u.value=s.pageSize,b()},D=[{title:t("account.table.orderId"),dataIndex:"order_sn",key:"order_sn"},{title:t("account.table.orderAmount"),dataIndex:"amount",key:"amount"},{title:t("account.table.time"),dataIndex:"created_at",key:"created_at",customRender:({text:s})=>M(s).format("YYYY-MM-DD HH:mm")},{title:t("account.table.status"),key:"status",customRender:({record:s})=>{switch(s.status){case"pending":return t("account.orderStatus.pending");case"paid":return t("account.orderStatus.paid");case"cancelled":return t("account.orderStatus.cancelled");case"failed":return t("account.orderStatus.failed");default:return t("account.orderStatus.unknown")}}}],S={user:i,membership:e,points:P,router:y,t,page:l,pageSize:u,total:_,data:p,isUsernameModalVisible:o,newUsername:g,isPasswordModalVisible:v,newPassword:f,openUpdateName:T,resetPassword:z,updateUsername:N,updatePassword:O,getOrderList:b,handleTableChange:R,columns:D,ref:c,onMounted:C,get membershipService(){return x},get authService(){return U},get useUserStore(){return V},get dayjs(){return M},get useRouter(){return h},get message(){return w},get useI18n(){return k}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}},W={class:"usage"},X={class:"account-management"},q={class:"username-section",style:{"margin-bottom":"16px"}},F={class:"label"},K={class:"password-reset-section"},Q={class:"label"};function Z(I,a,i,e,P,y){const t=H,l=j,u=A,_=G,p=B;return E(),Y("div",W,[n("div",X,[n("div",q,[n("div",null,[n("span",F,r(e.t("account.usernameLabel")),1),n("span",null,r(e.user.user_name),1)]),n("button",{onClick:e.openUpdateName},r(e.t("account.edit")),1)]),n("div",K,[n("span",Q,r(e.t("account.passwordLabel")),1),n("button",{onClick:e.resetPassword},r(e.t("account.resetPassword")),1)]),d(l,{centered:"",title:e.t("account.editUsernameTitle"),open:e.isUsernameModalVisible,"onUpdate:open":a[2]||(a[2]=o=>e.isUsernameModalVisible=o)},{footer:m(()=>[n("button",{onClick:a[1]||(a[1]=o=>e.isUsernameModalVisible=!1),style:{"background-color":"#0000330f","border-color":"#0000330f",color:"#1a1a19","margin-right":"8px"}},r(e.t("account.cancel")),1),n("button",{type:"primary",onClick:e.updateUsername},r(e.t("account.save")),1)]),default:m(()=>[d(t,{value:e.newUsername,"onUpdate:value":a[0]||(a[0]=o=>e.newUsername=o),placeholder:e.t("account.newUsernamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["title","open"]),d(l,{centered:"",title:e.t("account.resetPasswordTitle"),open:e.isPasswordModalVisible,"onUpdate:open":a[5]||(a[5]=o=>e.isPasswordModalVisible=o)},{footer:m(()=>[n("button",{onClick:a[4]||(a[4]=o=>e.isPasswordModalVisible=!1),style:{"background-color":"#0000330f","border-color":"#0000330f",color:"#1a1a19","margin-right":"8px"}},r(e.t("account.cancel")),1),n("button",{type:"primary",onClick:e.updatePassword},r(e.t("account.save")),1)]),default:m(()=>[d(u,{value:e.newPassword,"onUpdate:value":a[3]||(a[3]=o=>e.newPassword=o),placeholder:e.t("account.newPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["title","open"])]),d(p,{title:e.t("account.ordersTitle")},{default:m(()=>[d(_,{columns:e.columns,onChange:e.handleTableChange,"data-source":e.data,"row-key":"id",pagination:{current:e.page,pageSize:e.pageSize,page:e.page,total:e.total}},null,8,["data-source","pagination"])]),_:1},8,["title"])])}const ne=L(J,[["render",Z],["__scopeId","data-v-1ca6fb13"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/UserProfile.vue"]]);export{ne as default};
