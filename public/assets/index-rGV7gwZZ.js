import{q as Q,d as n,h as s,l as e,x as c,g as re,a as fe,X as J,r as f,c as ne,a1 as Me,o as ce,a6 as ue,e as o,F as G,Z as le,aP as N,ag as W,j as U,i as Ve,t as _,aJ as Be,k as se,aS as De,aD as He,aT as Ee,w as A,U as xe,W as pe,f as ze,aa as $e,u as ge,a7 as ae,a8 as ie,A as Ue,aU as ye,B as Pe,aV as Te,s as Ne}from"./index-Dj8kHHbN.js";import{R as Oe,A as Se,K as je,s as ke}from"./KnowledgeModal-MoOtRC5Q.js";import{e as d}from"./emitter-E5P-NQ8u.js";import{u as de,f as he,c as Ie,M as Re,e as We}from"./edit-B__ctS2J.js";import{s as Ce}from"./auth-l2OdLYqE.js";import{u as Ae}from"./user-CP0SY-lp.js";import{s as Fe}from"./default-model-setting-dgh9t0Qv.js";import{A as Ze}from"./driver-BxHdV7Lz.js";import"./mcp-aBATD4E5.js";import"./http-yCFEzgv3.js";import"./index-TjCxX7sJ.js";const Ke="/assets/LemonAI-BW_u9Iwu.png",qe={class:"logo-title"},Xe=["src"],Je={__name:"logo",setup(y){return(i,p)=>(s(),n("div",qe,[e("img",{class:"logo",src:c(Ke),alt:"logo"},null,8,Xe)]))}},Ge=Q(Je,[["__scopeId","data-v-fc138ffa"]]),Qe={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"#8f8f8f","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-search h-5 w-5 text-var(--icon-secondary)",viewBox:"0 0 24 24"};function Ye(y,i){return s(),n("svg",Qe,i[0]||(i[0]=[e("circle",{cx:"11",cy:"11",r:"8"},null,-1),e("path",{d:"m21 21-4.3-4.3"},null,-1)]))}const me={render:Ye},et={class:"agent"},tt={class:"agent-header"},ot={class:"agent-list"},st=["onMouseenter","onClick"],nt=["title"],lt=["onClick"],at=["onClick"],it=["onClick"],rt=["onClick"],ct={class:"search-header"},ut={class:"search-header-icon"},dt={class:"search-content"},vt=["onClick"],pt={class:"search-item-content"},ht={class:"search-item-name"},mt={class:"search-item-time"},ft={key:0,class:"no-results"},gt={__name:"index",setup(y){const i=re(),p=fe(),H=de(),{agent:L,conversationId:S}=J(H),b=f([]),B=f(!1),M=f(null),E=f(null),w=f(null),x=f(null),k=f(null),O=f({}),I=f(!1),g=f(""),$=f(null),h=ne(()=>g.value.trim()?b.value.filter(t=>t.name.toLowerCase().includes(g.value.toLowerCase())):b.value),R=async()=>{var t;I.value=!0,g.value="",await $e(),(t=$.value)==null||t.focus()},z=()=>{I.value=!1,g.value=""};function j(t){B.value=!0,M.value=t}function V(t){pe.confirm({title:"Confirm Delete",content:"Are you sure you want to delete this agent?",onOk:async()=>{await ke.delete(t),P(),ze.success("Delete Success"),i.push("/lemon")}})}const F=()=>{d.emit("preview-close",!1),d.emit("terminal-visible",!1),d.emit("fullPreviewVisable-close")};function Y(t){M.value=t,E.value.visible=!0}function ee(t,l){x.value=x.value===t?null:t;const a=l.currentTarget.getBoundingClientRect(),m=120,r=8;let D=0;window.innerHeight-a.bottom<m+r?D=a.top-m+25:D=a.bottom,O.value={position:"fixed",top:`${D}px`,left:`${a.left}px`,zIndex:99999}}const P=async()=>{let t=await ke.getList();t.sort((l,a)=>new Date(a.create_at)-new Date(l.create_at)),b.value=t};d.on("updateAgentList",P),d.on("addAgent",Z),d.on("selectedAgent",q);function Z(t){P(),T(t,!0,!1)}function q(t){const l=b.value.find(a=>a.id===t.id);l?T(l,!0,!1):Z(t)}async function T(t,l=!1,a=!0){var m,r;F(),I.value=!1,k.value=((m=k.value)==null?void 0:m.id)===t.id?null:t,M.value=((r=k.value)==null?void 0:r.id)??null,L.value=t,await H.init("task"),a&&await H.selectFirst(),window.innerWidth<=768&&d.emit("toggleMobileMenu",!1),l&&(S.value?i.push(`/lemon/${L.value.id}/${S.value}`):i.push(`/lemon/${L.value.id}`))}Me(()=>p.params.agentId,t=>{t||(k.value=null)});function K(){x.value=null}const X=t=>{if(t.key==="/"&&!I.value){t.preventDefault(),R();return}if(t.key==="Escape"&&I.value){z();return}if(I.value&&h.value.length>0){const l=k.value?h.value.findIndex(a=>a.id===k.value.id):-1;if(t.key==="ArrowDown"){t.preventDefault();const a=l<h.value.length-1?l+1:0;k.value=h.value[a]}if(t.key==="ArrowUp"){t.preventDefault();const a=l>0?l-1:h.value.length-1;k.value=h.value[a]}t.key==="Enter"&&k.value&&(t.preventDefault(),T(k.value,!0))}};return ce(async()=>{await P();const t=p.params.agentId;t&&t!="chat"&&T(b.value.find(l=>l.id==t),!1),window.addEventListener("click",K),window.addEventListener("keydown",X)}),ue(()=>{window.removeEventListener("click",K),window.removeEventListener("keydown",X)}),(t,l)=>{const a=xe,m=pe;return s(),n(G,null,[e("div",et,[e("div",tt,[l[6]||(l[6]=e("span",{class:"disabled"},"Agents",-1)),e("span",null,[o(c(me),{class:"search-icon",onClick:R})])]),e("div",ot,[(s(!0),n(G,null,le(b.value,r=>{var D;return s(),n("div",{key:r.id,class:W(["agent-item",{active:((D=k.value)==null?void 0:D.id)===r.id}]),onMouseenter:u=>w.value=r.id,onMouseleave:l[1]||(l[1]=u=>w.value=null),onClick:N(u=>T(r,!0),["stop"])},[e("span",{class:"agent-name",title:r.name.length>20?r.name:null},_(r.name),9,nt),w.value===r.id?(s(),n("div",{key:0,class:"ellipsis",onClick:N(u=>ee(r.id,u),["stop"])}," â‹¯ ",8,lt)):U("",!0),(s(),Ve(Ee,{to:"body"},[x.value===r.id?(s(),n("div",{key:0,class:"menu",style:Be(O.value),onMouseleave:l[0]||(l[0]=u=>x.value=null)},[e("div",{class:"menu-item",onClick:N(u=>j(r.id),["stop"])},[o(c(De),{class:"icon"}),l[7]||(l[7]=se(" Edit "))],8,at),e("div",{class:"menu-item",onClick:N(u=>Y(r.id),["stop"])},[o(c(Oe),{class:"icon"}),l[8]||(l[8]=se(" Experience "))],8,it),e("div",{class:"menu-item danger",onClick:N(u=>V(r.id),["stop"])},[o(c(He),{class:"icon"}),l[9]||(l[9]=se(" Delete "))],8,rt)],36)):U("",!0)]))],42,st)}),128))])]),o(Se,{visible:B.value,"onUpdate:visible":l[2]||(l[2]=r=>B.value=r),id:M.value,"onUpdate:id":l[3]||(l[3]=r=>M.value=r)},null,8,["visible","id"]),o(je,{agentId:M.value,ref_key:"knowledgeModalRef",ref:E},null,8,["agentId"]),o(m,{footer:null,centered:!0,open:I.value,"onUpdate:open":l[5]||(l[5]=r=>I.value=r),onCancel:z,closable:!1},{title:A(()=>[e("div",ct,[e("div",ut,[o(c(me))]),o(a,{ref_key:"searchInputRef",ref:$,value:g.value,"onUpdate:value":l[4]||(l[4]=r=>g.value=r),placeholder:"Search Agents..."},null,8,["value"]),e("div",{class:"search-header-icon",onClick:z},[o(c(Ie))])])]),default:A(()=>[e("div",dt,[(s(!0),n(G,null,le(h.value,r=>(s(),n("div",{key:r.id,class:"search-item",onClick:D=>T(r,!0)},[e("div",pt,[e("div",ht,_(r.name),1),e("div",mt,_(c(he)(r.create_at)),1)])],8,vt))),128)),h.value.length===0&&g.value.trim()?(s(),n("div",ft,' No agents found for "'+_(g.value)+'" ',1)):U("",!0)])]),_:1},8,["open"])],64)}}},wt=Q(gt,[["__scopeId","data-v-38c72aaa"]]),_t={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",stroke:"#F25A5A","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"h-4 w-4",color:"#468ff6",viewBox:"0 0 24 24"};function kt(y,i){return s(),n("svg",_t,i[0]||(i[0]=[e("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"},null,-1)]))}const Ct={render:kt},bt={class:"user-center-popup"},Mt={key:0,class:"userInfo"},xt={class:"userName"},$t={class:"userEmail"},yt={key:1,class:"memberInfo"},St={key:2},It={__name:"user-profile",props:{show:{type:Boolean,default:!1}},setup(y){const i=Ae(),{user:p,membership:H,points:L}=J(i),S=re(),{t:b}=ge(),B=ne(()=>p.user_name||p.mobile||p.user_email),M=()=>{S.push({name:"pricing"})},E=()=>{S.push({path:"/setting/basic"})},w=ne(()=>!!p.value.id),x=async()=>{await Ce.logout(),window.location.reload()},k=async()=>{S.push({name:"login"})},O=()=>{S.push({path:"/setting/usage"})};async function I(){if(!w.value)return;let g=await Ce.getUserInfo();H.value=g.membership,L.value=g.points}return ce(()=>{$e(()=>{I()})}),(g,$)=>{var h;return s(),n("div",bt,[w.value?(s(),n("div",Mt,[e("div",xt,_(B.value),1),e("div",$t,_(c(p).user_email),1)])):U("",!0),w.value?(s(),n("div",yt,[e("span",null,_(((h=c(H))==null?void 0:h.planName)||g.$t("member.freePlan")),1),e("button",{onClick:M,class:"upgrade"},_(g.$t("member.upgrade")),1)])):U("",!0),w.value?(s(),n("div",St,[e("div",{class:"score",onClick:O},[e("div",null,[$[0]||($[0]=e("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15.2102 1.57437C15.2709 1.39188 15.529 1.39188 15.5897 1.57437L15.9325 2.60482C16.1315 3.20299 16.6008 3.67234 17.199 3.87131L18.2294 4.21408C18.4119 4.27478 18.4119 4.53293 18.2294 4.59363L17.199 4.9364C16.6008 5.13537 16.1315 5.60472 15.9325 6.20289L15.5897 7.23334C15.529 7.41583 15.2709 7.41583 15.2102 7.23334L14.8674 6.20289C14.6684 5.60472 14.1991 5.13537 13.6009 4.9364L12.5705 4.59363C12.388 4.53293 12.388 4.27478 12.5705 4.21408L13.6009 3.87131C14.1991 3.67234 14.6684 3.20299 14.8674 2.60482L15.2102 1.57437Z",fill:"currentColor"}),e("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.10529 6.19431C7.64765 7.5701 6.56814 8.6496 5.19235 9.10724L2.42617 10.0274C1.96992 10.1791 1.96992 10.8245 2.42617 10.9763L5.19236 11.8964C6.56815 12.354 7.64765 13.4335 8.10529 14.8093L9.02543 17.5755C9.17719 18.0318 9.82255 18.0318 9.97431 17.5755L10.8945 14.8093C11.3521 13.4335 12.4316 12.354 13.8074 11.8964L16.5736 10.9763C17.0298 10.8245 17.0298 10.1791 16.5736 10.0274L13.8074 9.10724C12.4316 8.6496 11.3521 7.5701 10.8945 6.19431L9.97431 3.42812C9.82255 2.97188 9.17719 2.97188 9.02543 3.42812L8.10529 6.19431ZM9.49987 7.22075C8.86634 8.69339 7.69143 9.86829 6.2188 10.5018C7.69143 11.1354 8.86634 12.3103 9.49987 13.7829C10.1334 12.3103 11.3083 11.1354 12.7809 10.5018C11.3083 9.86829 10.1334 8.69339 9.49987 7.22075Z",fill:"currentColor"})],-1)),e("span",null,_(g.$t("member.points")),1)]),e("span",null,_(c(L).total),1)])])):U("",!0),e("div",{onClick:E},[$[1]||($[1]=e("svg",{t:"1744338498135",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5527",width:"20",height:"20"},[e("path",{d:"M439.816 101.851c-8.631-16.952-28.007-25.48-46.337-20.396-70.066 19.435-133.165 55.501-184.82 103.628-12.909 12.028-16.413 31.094-8.623 46.926 5.374 10.92 8.414 23.234 8.414 36.376 0 45.555-36.833 82.347-82.1 82.347-0.381 0-0.762-0.003-1.142-0.008-17.691-0.253-33.448 11.147-38.74 28.031C73.159 421.209 66 466.344 66 513.078c0 30.844 3.118 61.001 9.07 90.156 4.1 20.082 22.714 33.816 43.111 31.808a83.069 83.069 0 0 1 8.169-0.399c45.267 0 82.1 36.791 82.1 82.346 0 20.276-7.254 38.74-19.334 53.086-13.177 15.649-12.423 38.718 1.748 53.472 52.742 54.916 119.403 96.417 194.376 118.784 20.888 6.231 42.918-5.408 49.543-26.174 10.616-33.275 41.714-57.212 78.217-57.212s67.601 23.937 78.217 57.212c6.625 20.766 28.655 32.405 49.543 26.174 74.973-22.367 141.634-63.868 194.376-118.784 14.17-14.755 14.924-37.823 1.748-53.471-12.08-14.346-19.334-32.811-19.334-53.087 0-45.554 36.834-82.346 82.1-82.346 2.773 0 5.496 0.135 8.169 0.399 20.397 2.008 39.011-11.726 43.111-31.808 5.951-29.155 9.07-59.312 9.07-90.156 0-46.734-7.16-91.869-20.468-134.323-5.292-16.884-21.049-28.285-38.741-28.031-0.379 0.005-0.76 0.008-1.141 0.008-45.266 0-82.1-36.792-82.1-82.347 0-13.142 3.04-25.456 8.414-36.376 7.79-15.832 4.286-34.898-8.623-46.926-51.655-48.127-114.754-84.193-184.82-103.628-18.33-5.084-37.706 3.444-46.337 20.396-13.648 26.806-41.357 44.97-73.184 44.97-31.827 0-59.536-18.164-73.184-44.97zM288.45 268.385c0-14.471-1.9-28.535-5.47-41.936 31.114-25.118 66.377-45.232 104.576-59.156 29.686 36.285 74.82 59.528 125.444 59.528 50.624 0 95.758-23.243 125.444-59.528 38.199 13.924 73.462 34.038 104.576 59.156a162.748 162.748 0 0 0-5.47 41.936c0 79.513 57.113 145.772 132.604 159.667 6.434 27.261 9.846 55.723 9.846 85.026 0 14.581-0.845 28.951-2.485 43.065-79.109 10.814-139.965 78.769-139.965 160.846 0 26.162 6.201 50.922 17.202 72.84-30.829 27.076-66.197 49.043-104.786 64.612-28.717-45.337-79.271-75.496-136.966-75.496-57.695 0-108.249 30.159-136.966 75.496-38.589-15.569-73.957-37.536-104.787-64.612 11.002-21.918 17.203-46.678 17.203-72.84 0-82.077-60.856-150.032-139.965-160.846A373.007 373.007 0 0 1 146 513.078c0-29.304 3.411-57.765 9.845-85.026 75.492-13.894 132.605-80.154 132.605-159.667zM513 336c-97.202 0-176 78.798-176 176s78.798 176 176 176 176-78.798 176-176-78.798-176-176-176zM409 512c0-57.438 46.562-104 104-104s104 46.562 104 104-46.562 104-104 104-104-46.562-104-104z",fill:"#666","p-id":"5528"})],-1)),e("span",null,_(g.$t("settings")),1)]),w.value?(s(),n("div",{key:3,class:"logout",onClick:x},[o(c(Ct)),e("span",null,_(g.$t("auth.logOut")),1)])):(s(),n("div",{key:4,class:"login",onClick:k},[$[2]||($[2]=e("svg",{t:"1749714854005",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5537",width:"20",height:"20"},[e("path",{d:"M832 896H298.666667a104.533333 104.533333 0 0 1-106.666667-102.4v-101.973333h53.333333v102.826666A52.48 52.48 0 0 0 298.666667 845.653333h533.333333a52.48 52.48 0 0 0 53.333333-51.2V229.546667a52.48 52.48 0 0 0-53.333333-51.2H298.666667a52.48 52.48 0 0 0-53.333334 51.2v102.826666H192V229.546667A104.533333 104.533333 0 0 1 298.666667 128h533.333333A104.533333 104.533333 0 0 1 938.666667 229.546667v564.906666A104.533333 104.533333 0 0 1 832 896zM601.173333 352a25.6 25.6 0 0 1 0-36.693333 27.733333 27.733333 0 0 1 37.546667 0l184.32 177.066666a30.293333 30.293333 0 0 1 0 39.253334L640 708.693333a27.733333 27.733333 0 0 1-37.546667 0 25.173333 25.173333 0 0 1 0-36.266666l139.946667-134.826667H112.213333a25.6 25.6 0 1 1 0-51.2h628.906667z",fill:"#2c2c2c","p-id":"5538"})],-1)),e("span",null,_(g.$t("auth.login")),1)]))])}}},At=Q(It,[["__scopeId","data-v-955e913e"]]),Lt={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 19 18"};function Vt(y,i){return s(),n("svg",Lt,i[0]||(i[0]=[e("path",{"fill-rule":"evenodd",d:"M3.23 4.5a.75.75 0 0 1 .75-.75h11.28a.75.75 0 0 1 0 1.5H3.98a.75.75 0 0 1-.75-.75m0 4.5a.75.75 0 0 1 .75-.75h11.28a.75.75 0 0 1 0 1.5H3.98A.75.75 0 0 1 3.23 9m0 4.5a.75.75 0 0 1 .75-.75h7.533a.75.75 0 0 1 0 1.5H3.98a.75.75 0 0 1-.75-.75","clip-rule":"evenodd"},null,-1)]))}const be={render:Vt},Bt={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"#34322d","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-plus h-4 w-4 text-[var(--icon-primary)]",viewBox:"0 0 24 24"};function Dt(y,i){return s(),n("svg",Bt,i[0]||(i[0]=[e("path",{d:"M5 12h14M12 5v14"},null,-1)]))}const Ht={render:Dt},Et={xmlns:"http://www.w3.org/2000/svg",width:"38",height:"38",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-message-square-dashed",viewBox:"0 0 24 24"};function zt(y,i){return s(),n("svg",Et,i[0]||(i[0]=[e("path",{d:"M10 17H7l-4 4v-7M14 17h1M14 3h1M19 3a2 2 0 0 1 2 2M21 14v1a2 2 0 0 1-2 2M21 9v1M3 9v1M5 3a2 2 0 0 0-2 2M9 3h1"},null,-1)]))}const Ut={render:zt},Pt={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"#f25a5a","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-trash",viewBox:"0 0 24 24"};function Tt(y,i){return s(),n("svg",Pt,i[0]||(i[0]=[e("path",{d:"M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"},null,-1)]))}const Nt={render:Tt},Ot={class:"menu-icon"},jt={class:"sidebar-header"},Rt={class:"header-content"},Wt={class:"sidebar-new-task"},Ft={class:"plus-icon"},Zt={key:0,class:"button-text"},Kt={key:1,class:"button-text"},qt={class:"sidebar-content"},Xt={class:"chat-list"},Jt=["onClick"],Gt={class:"chat-details"},Qt={class:"chat-header"},Yt={class:"chat-title"},eo={class:"chat-time"},to=["title"],oo={class:"chat-footer"},so={class:"chat-model-info"},no={key:0,class:"chat-model-name"},lo={class:"more-options"},ao=["onClick"],io=["onClick"],ro={key:0,class:"no-chats"},co={class:"search-header"},uo={class:"search-header-icon"},vo={class:"search-content"},po=["onClick"],ho={class:"chat-details"},mo={class:"chat-header"},fo={class:"chat-title"},go={class:"chat-time"},wo={key:0,class:"chat-footer"},_o=["title"],ko={__name:"secondMenu",props:{chats:{type:Array,default:()=>[]}},emits:["update:isCollapsed","selectChat","newChat","editChat","deleteChat"],setup(y,{emit:i}){const p=de(),{chatInfo:H,agent:L,conversationId:S,mode:b}=J(p),{t:B}=ge(),M=re(),E=fe(),w=f(!0),x=f(!1),k=f(!1),O=()=>window.innerWidth<=768;function I(){if(console.log("route ===== ",E.path.includes("/lemon")),!E.path.includes("/lemon")){x.value=!1;return}x.value=!!E.params.agentId}I(),Me(()=>E.fullPath,()=>{I()});const g=f(null),$=f(!1),h=f(!1),R=f(!1),z=f(""),j=f(null),V=f(null),F=()=>{console.log("toggleCollapse",w),w.value=!w.value},Y=()=>{w.value=!0,p.conversationId=null,p.clearMessages(),setTimeout(()=>{d.emit("toggleMobileMenu",!0)},100),M.push("/lemon")},ee=()=>{O()&&(console.log("handleOverlayClick"),P())},P=()=>{w.value=!0},Z=()=>{w.value=!1};d.on("close-collapse",P),d.on("open-collapse",Z),d.on("preview",()=>{console.log("Preview opened, hiding second-menu"),k.value=!0}),d.on("preview-close",()=>{console.log("Preview closed, showing second-menu"),k.value=!1}),d.on("fullPreviewVisable",()=>{console.log("Preview opened, hiding second-menu"),k.value=!0}),d.on("fullPreviewVisable-close",()=>{k.value=!1}),ue(()=>{d.off("close-collapse",P),d.off("open-collapse",Z),d.off("preview"),d.off("preview-close"),d.off("fullPreviewVisable"),d.off("fullPreviewVisable-close")});const q=()=>{T(),p.conversationId=null,p.clearMessages(),b.value==="task"?M.push(`/lemon/${L.value.id}`):M.push("/lemon")},T=()=>{d.emit("preview-close",!1),d.emit("terminal-visible",!1),d.emit("fullPreviewVisable-close")},K=u=>{P(),T(),console.log("handleChatClick",u),p.conversationId=u.conversation_id,console.log("chatStore.conversationId",S.value),p.chat=u,p.clearMessages(),p.initConversation(u.conversation_id),b.value=="chat"?M.push(`/lemon/chat/${u.conversation_id}`):M.push(`/lemon/${L.value.id}/${u.conversation_id}`)},X=u=>{g.value=g.value===u?null:u},t=u=>{V.value=u,z.value=u.title,h.value=!0,g.value=null},l=()=>{h.value=!1,h.value=!1,p.updateConversationTitleById(z.value,V.value.conversation_id),V.value=null},a=()=>{h.value=!1,V.value=null},m=u=>{j.value=u,$.value=!0,g.value=null},r=async()=>{if(j.value)try{await p.removeConversation(j.value.conversation_id),$.value=!1,j.value=null,M.push("/lemon")}catch(u){console.error("Failed to delete conversation:",u)}},D=()=>{$.value=!1,R.value=!1,j.value=null};return(u,C)=>{const Le=ye,we=Pe,ve=pe,_e=xe;return ae((s(),n("div",{class:W(w.value?"second-menu":"second-menu collapsed"),onClick:ee},[w.value&&x.value&&!(k.value&&O())?(s(),n("button",{key:0,class:"menu-button",onClick:N(F,["stop"])},[e("span",Ot,[o(c(be),{style:{width:"22px",height:"22px"}})])])):U("",!0),ae(e("div",{class:"sidebar-container",onClick:C[1]||(C[1]=N(()=>{},["stop"]))},[e("div",{class:W(["sidebar",{collapsed:w.value}])},[e("div",jt,[e("div",Rt,[e("button",{class:"collapse-btn mobile-only",onClick:Y},[o(c(Ue),{style:{width:"20px",height:"20px"}})]),e("button",{class:"collapse-btn pc-only",onClick:F},[o(c(be),{style:{width:"20px",height:"20px"}})])])]),e("div",Wt,[e("button",{class:"new-task-button",onClick:q},[e("span",Ft,[o(c(Ht),{style:{width:"16px",height:"16px"}})]),c(b)=="task"?(s(),n("span",Zt,"New Task")):(s(),n("span",Kt,"New Chat"))])]),e("div",qt,[e("div",Xt,[(s(!0),n(G,null,le(y.chats,v=>{var te;return s(),n("div",{key:v.conversation_id,class:W(["chat-item",{active:v.conversation_id===c(S)}]),onClick:oe=>K(v)},[e("div",Gt,[e("div",Qt,[e("div",Yt,_(v.title),1),e("div",eo,_(c(he)(v.update_at,c(B))),1)]),e("div",{class:"chat-last-message",title:v.last_message},_((te=v==null?void 0:v.latest_message)==null?void 0:te.content),9,to),e("div",oo,[e("div",so,[v.model_name?(s(),n("div",no,_(v.model_name),1)):U("",!0)]),e("div",lo,[o(Le,{title:"More",placement:"top",arrow:!1},{default:A(()=>[o(c(Re),{class:"more-options-icon",onClick:N(oe=>X(v.conversation_id),["stop"])},null,8,["onClick"])]),_:2},1024),g.value===v.conversation_id?(s(),n("div",{key:0,class:"more-options-dropdown",onMouseleave:C[0]||(C[0]=oe=>g.value=null)},[e("div",{class:"more-options-item",onClick:N(oe=>t(v),["stop"])},[o(c(We)),C[7]||(C[7]=e("span",{class:"more-options-item-text"},"Rename",-1))],8,ao),e("div",{class:"more-options-item err",onClick:N(oe=>m(v),["stop"])},[o(c(Nt)),C[8]||(C[8]=e("span",{class:"more-options-item-text"},"Delete",-1))],8,io)],32)):U("",!0)])])])],10,Jt)}),128)),y.chats.length?U("",!0):(s(),n("div",ro,[o(c(Ut),{style:{width:"24px",height:"24px"}}),C[9]||(C[9]=e("span",null,"No Conversation",-1))]))])])],2)],512),[[ie,!w.value&&x.value]]),o(ve,{open:$.value,"onUpdate:open":C[2]||(C[2]=v=>$.value=v),title:u.$t("lemon.sidebar.confirmDelete")},{footer:A(()=>[o(we,{onClick:D},{default:A(()=>[se(_(u.$t("lemon.sidebar.cancel")),1)]),_:1}),o(we,{type:"primary",onClick:r},{default:A(()=>[se(_(u.$t("lemon.sidebar.confirm")),1)]),_:1})]),default:A(()=>[e("p",null,_(u.$t("lemon.sidebar.deleteConfirmation")),1)]),_:1},8,["open","title"]),o(ve,{open:h.value,"onUpdate:open":C[4]||(C[4]=v=>h.value=v),title:"Edit Title",centered:"",width:400,footer:null,class:"edit-title-modal"},{default:A(()=>[C[10]||(C[10]=e("span",{class:"edit-title"},"Enter new title",-1)),o(_e,{value:z.value,"onUpdate:value":C[3]||(C[3]=v=>z.value=v),class:"edit-title-input"},null,8,["value"]),e("footer",null,[e("div",{class:"footer-btn"},[e("div",{class:"cancel-btn",onClick:a},"Cancel"),e("div",{class:"confirm-btn",onClick:l},"Confirm")])])]),_:1},8,["open"]),o(ve,{open:R.value,"onUpdate:open":C[6]||(C[6]=v=>R.value=v),footer:null,centered:!0,closable:!1},{title:A(()=>[e("div",co,[e("div",uo,[o(c(me),{style:{width:"24px",height:"24px"}})]),o(_e,{value:u.searchValue,"onUpdate:value":C[5]||(C[5]=v=>u.searchValue=v),placeholder:"Search conversations"},null,8,["value"]),e("div",{class:"search-header-icon",onClick:D},[o(c(Ie),{style:{width:"24px",height:"24px"}})])])]),default:A(()=>[e("div",vo,[(s(!0),n(G,null,le(y.chats,v=>{var te;return s(),n("div",{key:v.conversation_id,class:W(["chat-item",{active:v.conversation_id===c(S)}]),onClick:oe=>K(v)},[e("div",ho,[e("div",mo,[e("div",fo,_(v.title),1),e("div",go,_(c(he)(v.update_at,c(B))),1)]),u.modal=="task"?(s(),n("div",wo,[e("div",{class:"chat-last-message",title:v.last_message},_((te=v==null?void 0:v.latest_message)==null?void 0:te.content),9,_o)])):U("",!0)])],10,po)}),128))])]),_:1},8,["open"])],2)),[[ie,!(k.value&&O())]])}}},Co=Q(ko,[["__scopeId","data-v-2fa36de7"]]),bo={xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200",class:"icon",viewBox:"0 0 1024 1024"};function Mo(y,i){return s(),n("svg",bo,i[0]||(i[0]=[e("path",{d:"M512 619.4c-152.3 0-276.2-123.9-276.2-276.2S359.7 67 512 67s276.2 123.9 276.2 276.2S664.3 619.4 512 619.4m0-491c-118.4 0-214.8 96.4-214.8 214.8S393.6 558 512 558s214.8-96.4 214.8-214.8S630.4 128.4 512 128.4"},null,-1),e("path",{d:"M910.9 957h-61.4c0-186.1-151.4-337.6-337.6-337.6S174.4 770.8 174.4 957H113c.1-220 179-399 399-399s398.9 179 398.9 399"},null,-1)]))}const xo={render:Mo},$o={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor","aria-hidden":"true",class:"icon"};function yo(y,i){return s(),n("svg",$o,i[0]||(i[0]=[e("path",{d:"M2.669 11.333V8.667c0-.922 0-1.655.048-2.244.048-.597.15-1.106.387-1.571l.155-.276a4 4 0 0 1 1.593-1.472l.177-.083c.418-.179.872-.263 1.395-.305.589-.048 1.32-.048 2.243-.048h.5a.665.665 0 0 1 0 1.33h-.5c-.944 0-1.613 0-2.135.043-.386.032-.66.085-.876.162l-.2.086a2.67 2.67 0 0 0-1.064.982l-.102.184c-.126.247-.206.562-.248 1.076-.043.523-.043 1.192-.043 2.136v2.666c0 .944 0 1.613.043 2.136.042.514.122.829.248 1.076l.102.184c.257.418.624.758 1.064.982l.2.086c.217.077.49.13.876.161.522.043 1.19.044 2.135.044h2.667c.944 0 1.612-.001 2.135-.044.514-.042.829-.121 1.076-.247l.184-.104c.418-.256.759-.623.983-1.062l.086-.2c.077-.217.13-.49.16-.876.043-.523.044-1.192.044-2.136v-.5a.665.665 0 0 1 1.33 0v.5c0 .922.001 1.655-.047 2.244-.043.522-.127.977-.306 1.395l-.083.176a4 4 0 0 1-1.471 1.593l-.276.154c-.466.238-.975.34-1.572.39-.59.047-1.321.047-2.243.047H8.667c-.923 0-1.654 0-2.243-.048-.523-.043-.977-.126-1.395-.305l-.177-.084a4 4 0 0 1-1.593-1.471l-.155-.276c-.237-.465-.339-.974-.387-1.57-.049-.59-.048-1.322-.048-2.245m10.796-8.22a2.43 2.43 0 0 1 3.255.167l.167.185c.727.892.727 2.18 0 3.071l-.168.185-5.046 5.048a4 4 0 0 1-1.945 1.072l-.317.058-1.817.26a.665.665 0 0 1-.752-.753l.26-1.816.058-.319a4 4 0 0 1 1.072-1.944L13.28 3.28zm2.314 1.108a1.103 1.103 0 0 0-1.476-.076l-.084.076-5.046 5.048a2.67 2.67 0 0 0-.716 1.296l-.04.212-.134.939.94-.134.211-.039a2.67 2.67 0 0 0 1.298-.716L15.78 5.78l.076-.084c.33-.404.33-.988 0-1.392z"},null,-1)]))}const So={render:yo},Io={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",viewBox:"0 0 1024 1024"};function Ao(y,i){return s(),n("svg",Io,i[0]||(i[0]=[e("path",{stroke:"currentColor",d:"M770.438 597.358a158 158 0 0 0 73.143 11.703v219.891a73.143 73.143 0 0 1-73.143 73.143H551.01V731.43h-73.143v170.666H258.438a73.143 73.143 0 0 1-73.143-73.143v-223.67a158.9 158.9 0 0 0 73.143 0v223.67h146.286V658.286h219.428v170.666h146.286zm-24.04-475.453a73.14 73.14 0 0 1 62.83 35.718l116.297 195.243-.317-.025a126.537 126.537 0 0 1-208.091 140.532A137.48 137.48 0 0 1 616.814 536.6a137.68 137.68 0 0 1-103.522-46.738A137.68 137.68 0 0 1 409.795 536.6a137.63 137.63 0 0 1-100.303-43.227 126.537 126.537 0 0 1-200.9-152.869l97.793-180.321a73.14 73.14 0 0 1 64.317-38.278h475.72zm0 73.143H270.702l-99.304 183.1-1.707 2.634a53.394 53.394 0 0 0 84.797 64.439l52.931-60.538 55.272 58.44c12.215 12.947 29.013 20.335 47.153 20.335 18.92 0 36.376-8.046 48.664-21.992l54.857-62.123 54.833 62.123c12.288 13.946 29.745 21.992 48.664 21.992 18.14 0 34.914-7.388 47.104-20.285l55.223-58.515 53.005 60.538a53.394 53.394 0 0 0 87.844-59.221l-.829-1.634-112.786-189.293z"},null,-1)]))}const Lo={render:Ao},Vo={class:"menu-panel"},Bo={class:"menu-top"},Do={class:"menu-header"},Ho={class:"menu-actions"},Eo={class:"menu-bottom"},zo={style:{display:"flex","align-items":"flex-end","justify-content":"space-between"}},Uo={class:"user-info-bar"},Po={class:"user-info-text"},To={class:"user-name"},No={class:"user-plan"},Oo={class:"profile-wrapper"},jo={class:"footer-social"},Ro={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"footer-social-icon",xmlns:"http://www.w3.org/2000/svg"},Wo={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"footer-social-icon",xmlns:"http://www.w3.org/2000/svg"},Fo={class:"second-menu"},Zo={__name:"index",setup(y){const i=re(),p=de(),H=Ae(),L=Te(),{agent:S,mode:b}=J(p),{user:B,membership:M}=J(H),{isDark:E}=J(L),{t:w}=ge();let x=null;const k=async()=>{x=Ze({animate:!0,showProgress:!1,prevBtnText:w("setting.prevStep"),nextBtnText:w("setting.nextStep"),doneBtnText:w("setting.doneStep"),steps:[{element:".user-profile-container",popover:{side:"top",title:w("setting.settingModel"),description:w("setting.tourHoverDescription"),showButtons:["next"],nextBtnText:w("setting.tourUnderstood"),onNextClick:()=>{localStorage.setItem("tour_end","true"),i.push({path:"/setting/basic"}),x.destroy()}}}]}),x.drive()},O=()=>{z.value=!0,x&&x.isActive()&&x.destroy()},I=()=>{z.value=!1},g=f("task"),$=f(!1),h=f(!1),R=f([]),z=f(!1);async function j(){if(localStorage.getItem("tour_end")=="true"){localStorage.setItem("tour","false");return}let a=await Fe.checkModel();a.has_default_platform&&a.has_enabled_platform&&a.has_search_setting?localStorage.setItem("tour","false"):(localStorage.setItem("tour","true"),k())}const V=f(window.innerWidth<=768),F=()=>{const a=window.innerWidth<=768;V.value&&!a&&h.value&&(h.value=!1),V.value=a};ce(()=>{j(),g.value=localStorage.getItem("mode")||"task",window.addEventListener("resize",F),d.on("toggleMobileMenu",q)}),ue(()=>{window.removeEventListener("resize",F),d.off("toggleMobileMenu",q)});const Y=ne(()=>!V.value||h.value);function ee(a){T(),g.value=a,b.value=a,console.log("changeMode",a),localStorage.getItem("mode")!==a&&(localStorage.setItem("mode",a),S.value={},p.conversationId=null),d.emit("close-collapse"),p.clearAgent(),V.value&&h.value&&(h.value=!1,d.emit("mobileMenuStateChange",!1)),i.push("/lemon")}function P(){V.value&&h.value&&(h.value=!1,d.emit("mobileMenuStateChange",!1)),window.open("https://app.lemonai.ai/store","_blank")}function Z(){V.value&&(h.value=!1,d.emit("mobileMenuStateChange",!1))}function q(a){V.value&&(typeof a=="boolean"?h.value=a:h.value=!h.value,d.emit("mobileMenuStateChange",h.value))}function T(){d.emit("preview-close",!1),d.emit("terminal-visible",!1),d.emit("fullPreviewVisible-close")}const K=ne(()=>p.list),X=f({localVersion:"0.4.1",latestVersion:"0.4.1",isLatest:!0,updateUrl:"https://github.com/yu-mengyun/vue-admin-template",message:"the current version is the latest version"}),t=()=>{window.open("https://lemon-11.gitbook.io/lemonai/version-update","_blank")},l=()=>{L.toggleTheme()};return(a,m)=>{var D;const r=ye;return s(),n(G,null,[ae(e("div",{class:W(["left-menu",{"menu-visible":h.value}]),onClick:N(Z,["self"])},[e("div",Vo,[e("div",Bo,[e("div",Do,[o(Ge)]),e("div",Ho,[e("div",{class:"menu-button",onClick:m[0]||(m[0]=u=>ee("task"))},[o(c(So)),m[2]||(m[2]=e("span",{class:"truncate"},"New Agent",-1))]),e("div",{class:W(["menu-button store-button",{active:a.isStorePage}]),onClick:P},[o(c(Lo)),m[3]||(m[3]=e("span",{class:"truncate"},"Agent Store",-1))],2)]),o(wt)]),e("div",Eo,[e("div",zo,[e("div",{class:"user-profile-container",onMouseenter:O,onMouseleave:I},[e("div",Uo,[o(c(xo),{style:{height:"20px",width:"20px"}}),e("div",Po,[e("span",To,_(c(B).user_name||c(B).mobile||c(B).user_email),1),e("span",No,_(((D=c(M))==null?void 0:D.planName)||a.$t("member.freePlan")),1)])]),ae(e("div",Oo,[o(At,{isCollapsed:a.isCollapsed,chats:R.value},null,8,["isCollapsed","chats"])],512),[[ie,z.value]])],32),e("div",{class:"version-text",onClick:t}," V "+_(X.value.localVersion),1)]),e("div",jo,[o(r,{title:c(E)?"Light Mode":"Dark Mode"},{default:A(()=>[e("div",{onClick:l,class:"footer-social-link theme-toggle"},[c(E)?(s(),n("svg",Wo,m[5]||(m[5]=[e("circle",{cx:"12",cy:"12",r:"5"},null,-1),e("line",{x1:"12",y1:"1",x2:"12",y2:"3"},null,-1),e("line",{x1:"12",y1:"21",x2:"12",y2:"23"},null,-1),e("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},null,-1),e("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},null,-1),e("line",{x1:"1",y1:"12",x2:"3",y2:"12"},null,-1),e("line",{x1:"21",y1:"12",x2:"23",y2:"12"},null,-1),e("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},null,-1),e("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},null,-1)]))):(s(),n("svg",Ro,m[4]||(m[4]=[e("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},null,-1)])))])]),_:1},8,["title"]),o(r,{title:"Homepage"},{default:A(()=>m[6]||(m[6]=[e("a",{href:"https://www.lemonai.ai",target:"_blank",rel:"noopener noreferrer",class:"footer-social-link"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"footer-social-icon",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e("polyline",{points:"9,22 9,12 15,12 15,22"})])],-1)])),_:1}),o(r,{title:"Email"},{default:A(()=>m[7]||(m[7]=[e("a",{href:"mailto:hello@lemonai.ai",target:"_blank",rel:"noopener noreferrer",class:"footer-social-link"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"footer-social-icon",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e("polyline",{points:"22,6 12,13 2,6"})])],-1)])),_:1}),o(r,{title:"Discord"},{default:A(()=>m[8]||(m[8]=[e("a",{href:"https://discord.gg/gjEXg4UBR4",target:"_blank",rel:"noopener noreferrer",class:"footer-social-link"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"footer-social-icon",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0189 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"})])],-1)])),_:1}),o(r,{title:"Documentation"},{default:A(()=>m[9]||(m[9]=[e("a",{href:"https://lemon-11.gitbook.io/lemonai",target:"_blank",rel:"noopener noreferrer",class:"footer-social-link"},[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"footer-social-icon",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),e("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})])],-1)])),_:1})])])])],2),[[ie,Y.value]]),e("div",Fo,[o(Co,{chats:K.value},null,8,["chats"])]),o(Se,{visible:$.value,"onUpdate:visible":m[1]||(m[1]=u=>$.value=u),id:""},null,8,["visible"])],64)}}},Ko=Q(Zo,[["__scopeId","data-v-6020a30c"]]),qo={class:"lemon-content"},Xo={__name:"index",setup(y){fe();const i=de();f(!1);const p=f(!1),H=b=>{typeof b=="boolean"?p.value=b:p.value=!p.value},L=()=>{d.emit("toggleMobileMenu",!1)},S=async()=>{let b=localStorage.getItem("mode")||"task";await i.init(b)};return ce(()=>{S(),d.on("mobileMenuStateChange",H)}),ue(()=>{d.off("mobileMenuStateChange",H)}),(b,B)=>{const M=Ne("router-view");return s(),n("div",{class:W(["lemon-container",{"mobile-menu-open":p.value}])},[o(Ko),e("div",qo,[p.value?(s(),n("div",{key:0,class:"mobile-overlay",onClick:L})):U("",!0),o(M)])],2)}}},is=Q(Xo,[["__scopeId","data-v-1fd30527"]]);export{is as default};
