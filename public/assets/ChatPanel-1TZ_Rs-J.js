import{a as X,I as Fe,_ as Ee,c as ee,h as J,l as M,a6 as nn,j as ie,b9 as rn,F as ge,Y as Se,d as Ae,Z as ve,r as ne,e as ue,aQ as sn,aE as on,af as Be,t as re,i as ye,w as de,B as Ke,ba as an,bb as Ht,X as We,k as xe,T as mt,z as ln,bc as _t,aI as cn,a4 as $t,aM as Ne,aR as ft,o as Ue,x as rt,bd as it,a9 as dt,A as He,az as st,aO as Gt,a1 as dn,u as Le,g as pt,$ as un,ab as hn,be as fn,b as ot,v as je,a3 as pn,bf as ut,bg as mn,bh as _n,bi as gn,q as vn,aa as Re,bj as bn,Q as Mt,aU as wn,aK as yn,bk as kn,aD as Sn,aS as Cn,bl as xn}from"./index-COUhflQL.js";import{u as ke,f as It,s as On,a as En,c as Mn,m as In}from"./edit-BCG9471i.js";import{f as qt,s as Ze,u as Ye,i as zn,v as zt,b as et,c as tt,d as An,m as Tn,e as Pe,g as Pn,L as At,P as Ln,C as Dn,a as Rn}from"./fullPreview-Bg9vLttA.js";import{u as Ve}from"./user-B_oAAdlF.js";import{s as at}from"./default-model-setting-BBEOO4VJ.js";import{P as Jt}from"./pricing-BX1draoB.js";import{s as Yt}from"./auth-D-et7D_s.js";import{s as Je}from"./membership-C5eKkiGZ.js";import{W as Bn,S as Un}from"./wechatpay-tED_5vSf.js";import{e as Oe}from"./emitter-E5P-NQ8u.js";import{s as Tt}from"./mcp-CPgW5lOl.js";import{s as lt,A as Fn,K as jn,R as Nn}from"./KnowledgeModal-CX_jzjVa.js";import{T as Wn}from"./ToolOutlined-387Pheo8.js";import"./index-TjCxX7sJ.js";import"./http-B5vhwVWP.js";import"./index-B4pkpufg.js";import"./marked.esm-BktMfnUh.js";import"./lemon-D5W0kMi6.js";var Zn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"};function Pt(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){Vn(z,f,i[f])})}return z}function Vn(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var gt=function(w,i){var e=Pt({},w,i.attrs);return X(Fe,Pt({},e,{icon:Zn}),null)};gt.displayName="BulbOutlined";gt.inheritAttrs=!1;var Hn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M704 446H320c-4.4 0-8 3.6-8 8v402c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8V454c0-4.4-3.6-8-8-8zm-328 64h272v117H376V510zm272 290H376V683h272v117z"}},{tag:"path",attrs:{d:"M424 748a32 32 0 1064 0 32 32 0 10-64 0zm0-178a32 32 0 1064 0 32 32 0 10-64 0z"}},{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}}]},name:"cloud-server",theme:"outlined"};function Lt(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){$n(z,f,i[f])})}return z}function $n(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var vt=function(w,i){var e=Lt({},w,i.attrs);return X(Fe,Lt({},e,{icon:Hn}),null)};vt.displayName="CloudServerOutlined";vt.inheritAttrs=!1;var Gn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 100c-61.8 0-112 50.2-112 112 0 47.7 29.9 88.5 72 104.6v27.6L512 601.4 312 344.2v-27.6c42.1-16.1 72-56.9 72-104.6 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 50.6 33.8 93.5 80 107.3v34.4c0 9.7 3.3 19.3 9.3 27L476 672.3v33.6c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-33.6l226.7-291.6c6-7.7 9.3-17.3 9.3-27v-34.4c46.2-13.8 80-56.7 80-107.3 0-61.8-50.2-112-112-112zM224 212a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm336 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm192-552a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"fork",theme:"outlined"};function Dt(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){qn(z,f,i[f])})}return z}function qn(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var bt=function(w,i){var e=Dt({},w,i.attrs);return X(Fe,Dt({},e,{icon:Gn}),null)};bt.displayName="ForkOutlined";bt.inheritAttrs=!1;var Jn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};function Rt(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){Yn(z,f,i[f])})}return z}function Yn(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var wt=function(w,i){var e=Rt({},w,i.attrs);return X(Fe,Rt({},e,{icon:Jn}),null)};wt.displayName="MessageOutlined";wt.inheritAttrs=!1;var Kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};function Bt(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){Xn(z,f,i[f])})}return z}function Xn(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var yt=function(w,i){var e=Bt({},w,i.attrs);return X(Fe,Bt({},e,{icon:Kn}),null)};yt.displayName="PlayCircleOutlined";yt.inheritAttrs=!1;var Qn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"};function Ut(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){er(z,f,i[f])})}return z}function er(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var kt=function(w,i){var e=Ut({},w,i.attrs);return X(Fe,Ut({},e,{icon:Qn}),null)};kt.displayName="RobotOutlined";kt.inheritAttrs=!1;var tr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function Ft(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){nr(z,f,i[f])})}return z}function nr(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var St=function(w,i){var e=Ft({},w,i.attrs);return X(Fe,Ft({},e,{icon:tr}),null)};St.displayName="SyncOutlined";St.inheritAttrs=!1;var rr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"};function jt(z){for(var w=1;w<arguments.length;w++){var i=arguments[w]!=null?Object(arguments[w]):{},e=Object.keys(i);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(f){return Object.getOwnPropertyDescriptor(i,f).enumerable}))),e.forEach(function(f){ir(z,f,i[f])})}return z}function ir(z,w,i){return w in z?Object.defineProperty(z,w,{value:i,enumerable:!0,configurable:!0,writable:!0}):z[w]=i,z}var Ct=function(w,i){var e=jt({},w,i.attrs);return X(Fe,jt({},e,{icon:rr}),null)};Ct.displayName="TeamOutlined";Ct.inheritAttrs=!1;const sr={__name:"ConversationList",setup(z,{expose:w}){w();const i=ke(),e=Ae(),{list:f,conversationId:h,agent:n,mode:s}=ve(i),d=ne(""),p=ue(()=>{const a=h.value;return a==null?null:String(a)}),v=ue(()=>{const a=d.value.trim().toLowerCase();return a?f.value.filter(m=>{var O;const k=(m.title||"Untitled conversation").toLowerCase(),I=(((O=m==null?void 0:m.latest_message)==null?void 0:O.content)||"").toLowerCase();return k.includes(a)||I.includes(a)}):f.value}),c={chatStore:i,router:e,list:f,conversationId:h,agent:n,mode:s,searchTerm:d,activeConversationId:p,filteredConversations:v,handleSelectConversation:a=>{var k;if(!a||String(a.conversation_id)===p.value)return;i.conversationId=a.conversation_id,i.chat=a,i.clearMessages(),i.initConversation(a.conversation_id);const m=a.agent_id||((k=n.value)==null?void 0:k.id);s.value==="chat"?e.push(`/lemon/chat/${a.conversation_id}`):m?e.push(`/lemon/${m}/${a.conversation_id}`):e.push(`/lemon/${a.conversation_id}`)},handleNewChat:()=>{var a;i.conversationId=null,i.chat={},i.clearMessages(),s.value==="chat"?e.push("/lemon/chat"):(a=n.value)!=null&&a.id?e.push(`/lemon/${n.value.id}`):e.push("/lemon")},formatTitle:a=>(a==null?void 0:a.trim())||"Untitled conversation",formatPreview:a=>{if(!a)return"No messages yet";const m=a.replace(/\s+/g," ").trim();return m.length>80?`${m.slice(0,80)}…`:m},formatUpdatedAt:a=>{if(!a)return"";try{return It(a)}catch(m){return console.warn("Failed to format time",m),""}},computed:ue,ref:ne,get useRouter(){return Ae},get storeToRefs(){return ve},get PlusOutlined(){return on},get SearchOutlined(){return sn},get useChatStore(){return ke},get formatTime(){return It}};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}},or={class:"conversation-list"},ar={class:"list-header"},lr={class:"search-box"},cr={class:"search-wrapper"},dr={key:0,class:"conversation-items"},ur=["onClick"],hr={class:"conversation-title"},fr={class:"conversation-preview"},pr={class:"conversation-meta"},mr={class:"conversation-time"},_r={key:0,class:"conversation-model"},gr={key:1,class:"empty-state"};function vr(z,w,i,e,f,h){return J(),ee("div",or,[M("div",ar,[M("button",{class:"new-chat-btn",type:"button",onClick:e.handleNewChat},[X(e.PlusOutlined),w[2]||(w[2]=M("span",null,"New Chat",-1))])]),M("div",lr,[M("div",cr,[X(e.SearchOutlined,{class:"search-icon"}),nn(M("input",{"onUpdate:modelValue":w[0]||(w[0]=n=>e.searchTerm=n),class:"search-input",type:"text",placeholder:"Search conversations","aria-label":"Search conversations"},null,512),[[rn,e.searchTerm]]),e.searchTerm?(J(),ee("button",{key:0,class:"clear-button",type:"button",onClick:w[1]||(w[1]=n=>e.searchTerm=""),"aria-label":"Clear search"}," × ")):ie("v-if",!0)])]),e.filteredConversations.length?(J(),ee("div",dr,[(J(!0),ee(ge,null,Se(e.filteredConversations,n=>{var s;return J(),ee("button",{key:n.conversation_id,type:"button",class:Be(["conversation-item",{active:String(n.conversation_id)===e.activeConversationId}]),onClick:d=>e.handleSelectConversation(n)},[M("div",hr,re(e.formatTitle(n.title)),1),M("div",fr,re(e.formatPreview((s=n==null?void 0:n.latest_message)==null?void 0:s.content)),1),M("div",pr,[M("span",mr,re(e.formatUpdatedAt(n.update_at)),1),n.model_name?(J(),ee("span",_r,re(n.model_name),1)):ie("v-if",!0)])],10,ur)}),128))])):(J(),ee("div",gr,w[3]||(w[3]=[M("p",{class:"empty-title"},"No conversations found",-1),M("p",{class:"empty-subtitle"},"Try adjusting your search or start a new chat.",-1)])))])}const br=Ee(sr,[["render",vr],["__scopeId","data-v-b23da1f0"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/ConversationList.vue"]]),wr={xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-x text-white",viewBox:"0 0 24 24"};function yr(z,w){return J(),ee("svg",wr,w[0]||(w[0]=[M("path",{d:"M18 6 6 18M6 6l12 12"},null,-1)]))}const kr={render:yr},Sr={__name:"ChatInputFileList",props:{fileList:{type:Array,default:()=>[]},conversation_id:{type:String,default:""}},emits:["update:fileList"],setup(z,{expose:w,emit:i}){w();const e=z,f=i,s={props:e,emit:f,handleDelete:d=>{console.log("delete file",d),Ze.deleteFile(d.id,e.conversation_id),f("update:fileList",e.fileList.filter(p=>p.id!==d.id))},formatFileSize:d=>d<1024?`${d} B`:d<1024*1024?`${(d/1024).toFixed(2)} KB`:`${(d/(1024*1024)).toFixed(2)} MB`,fileSvg:qt,get deleteFile(){return kr},get files(){return Ze}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},Cr={style:{overflow:"auto",width:"100%","min-width":"0"}},xr={class:"upload-fileList"},Or={style:{"min-width":"0",width:"100%"}},Er={key:0,style:{display:"flex",width:"100%","align-items":"center"}},Mr={class:"file-name"},Ir=["onClick"],zr={key:1,style:{display:"flex",width:"100%","align-items":"center",color:"#34322d"}},Ar={key:2},Tr={class:"file-size"};function Pr(z,w,i,e,f,h){return J(),ee("div",Cr,[M("div",xr,[(J(!0),ee(ge,null,Se(i.fileList,(n,s)=>(J(),ee("div",{class:"upload-fileList-item",key:s},[X(e.fileSvg,{url:n.name,"is-update":!0,class:"file-icon"},null,8,["url"]),M("div",Or,[n.uploading?(J(),ee("div",zr,[...w[0]||(w[0]=[M("div",{class:"loading-spinner"},null,-1),M("div",{style:{"margin-left":"8px"}},"Uploading...",-1)])])):(J(),ee("div",Er,[M("div",Mr,re(n.name),1),M("div",{class:"delete-button",onClick:d=>e.handleDelete(n)},[X(e.deleteFile)],8,Ir)])),n.uploading?ie("v-if",!0):(J(),ee("div",Ar,[M("div",Tr,re(e.formatFileSize(n.size)),1)]))])]))),128))])])}const Lr=Ee(Sr,[["render",Pr],["__scopeId","data-v-473ffb2d"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/ChatInputFileList.vue"]]),Dr={__name:"ChatInputUpload",props:{fileList:{type:Array,default:()=>[]},conversation_id:{type:String,default:""},isPublic:{type:Boolean,default:!1}},emits:["update:fileList"],setup(z,{expose:w,emit:i}){w();const e=z,f=()=>localStorage.getItem("hasShownPublicWarning")==="true",h=u=>{localStorage.setItem("hasShownPublicWarning",u.toString())},n=ne(f()),s=ne(!1),d=i,b={props:e,getHasShownPublicWarning:f,setHasShownPublicWarning:h,hasShownPublicWarning:n,uploadDisabled:s,emit:d,handleUploadClick:async u=>{if(e.isPublic&&!n.value){if(u.stopPropagation(),await new Promise(_=>{We.confirm({title:"Public File Upload Warning",content:"You have selected public mode. The uploaded files will be made public. Please confirm to continue?",okText:"Continue",cancelText:"Cancel",centered:!0,onOk:()=>{n.value=!0,h(!0),_(!0)},onCancel:()=>{_(!1)}})})){const _=u.target.closest(".ant-upload").querySelector('input[type="file"]');_&&_.click()}return}},beforeUpload:async u=>{u.uid=Date.now()+Math.random();const o={uid:u.uid,name:u.name,size:u.size,uploading:!0,error:!1};d("update:fileList",[...e.fileList,o]);try{const _=new FormData;_.append("conversation_id",e.conversation_id||""),_.append("files",u);let c=(await Ze.uploadFile(_))[0];console.log("upload",c);const a=e.fileList.filter(m=>m.uid!==u.uid).concat({name:c.name,size:u.size,url:c.url,id:c.id,workspace_dir:c.workspace_dir,uploading:!1,error:!1});console.log("newFileList",a),d("update:fileList",a)}catch(_){console.log("上传失败，更新对应文件状态",_);const l=e.fileList.map(c=>c.uid===u.uid?{...c,uploading:!1,error:!0}:c);d("update:fileList",l)}return!1},ref:ne,get Modal(){return We},get PaperClipOutlined(){return Ht},get files(){return Ze}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}};function Rr(z,w,i,e,f,h){const n=Ke,s=an;return J(),ye(s,{"file-list":i.fileList,"before-upload":e.beforeUpload,"show-upload-list":!1,disabled:e.uploadDisabled},{default:de(()=>[X(n,{type:"text",class:"upload-button",onClick:e.handleUploadClick},{icon:de(()=>[X(e.PaperClipOutlined)]),_:1})]),_:1},8,["file-list","disabled"])}const Br=Ee(Dr,[["render",Rr],["__scopeId","data-v-2997d40f"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/ChatInputUpload.vue"]]),Ur={__name:"SelectionPreview",setup(z,{expose:w}){w();const i=Ye(),{editorMode:e,selectedElement:f,selectedScreenshot:h,showSelectionPreview:n}=ve(i),s=ue(()=>{var o;if(!f.value)return"";const v=((o=f.value.tagName)==null?void 0:o.toLowerCase())||"",b=f.value.id?`#${f.value.id}`:"",u=f.value.className?`.${f.value.className.split(" ")[0]}`:"";return`${v}${b}${u}`}),p={editorStore:i,editorMode:e,selectedElement:f,selectedScreenshot:h,showSelectionPreview:n,selectedElementTag:s,handleClose:()=>{i.setShowSelectionPreview(!1)},computed:ue,get storeToRefs(){return ve},get useEditorStore(){return Ye},get CloseOutlined(){return _t}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}},Fr={key:0,class:"selection-preview"},jr={class:"preview-header"},Nr={class:"preview-title"},Wr={class:"preview-content"},Zr={class:"preview-image-container"},Vr=["src"];function Hr(z,w,i,e,f,h){const n=mt,s=Ke;return J(),ye(ln,{name:"preview-slide"},{default:de(()=>[e.showSelectionPreview&&e.selectedScreenshot&&e.editorMode==="ai-edit"?(J(),ee("div",Fr,[M("div",jr,[M("div",Nr,[w[0]||(w[0]=M("i",{class:"fas fa-crosshairs"},null,-1)),w[1]||(w[1]=M("span",null,"Selected",-1)),X(n,{size:"small",color:"blue"},{default:de(()=>[xe(re(e.selectedElementTag),1)]),_:1})]),X(s,{type:"text",size:"small",onClick:e.handleClose,class:"close-btn"},{default:de(()=>[X(e.CloseOutlined)]),_:1})]),M("div",Wr,[M("div",Zr,[M("img",{src:e.selectedScreenshot,alt:"Selected element preview",class:"preview-image"},null,8,Vr)])])])):ie("v-if",!0)]),_:1})}const $r=Ee(Ur,[["render",Hr],["__scopeId","data-v-7e5f7c9e"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/SelectionPreview.vue"]]),Gr={__name:"ModelSelect",setup(z,{expose:w}){w();const i=Ve(),{membership:e}=ve(i),f=ke(),{model_id:h}=ve(f),n=ne([]),s=ne(null),d=ne(null),p=ne(!1),v=ne(!1),b=ne("Upgrade"),u=ne(!1),o=ne(!1),_=ne(!1),l=ue(()=>!!localStorage.getItem("access_token")),c=ne(!1),a=()=>{_.value=window.innerWidth<=768};let m;const k=ue(()=>!!e.value),I=()=>{v.value=!1},O=()=>{u.value=!1},D=()=>{O(),console.log("跳转到登录页面")},P=C=>{if(C.requiresLogin){N(),u.value=!0;return}if(C.requires_membership&&!k.value){N(),v.value=!0;return}B(C.value),N()},U=()=>{N(),v.value=!0},T=()=>{o.value=!0},N=()=>{const C=document.querySelector(".mobile-model-selector");C&&C.classList.add("closing"),setTimeout(()=>{o.value=!1},250)},te=C=>{p.value=C},S=async()=>{console.log("[MODELSELECT] initModel started"),console.log("[MODELSELECT] membership.value",e.value);const C=localStorage.getItem("modelList");if(console.log("[MODELSELECT] cachedData:",C),C)try{if(n.value=JSON.parse(C),console.log("[MODELSELECT] Loaded from cache, modelList.value.length:",n.value.length),n.value.length>0&&!h.value){const q=n.value[0].id*1;h.value=q,s.value=q}}catch(q){console.error("[MODELSELECT] Failed to parse cached modelList",q)}try{console.log("[MODELSELECT] Calling modelService.getModels()...");const q=await at.getModels();if(console.log("[MODELSELECT] modelService.getModels() response:",q),console.log("[MODELSELECT] response type:",typeof q),console.log("[MODELSELECT] is array:",Array.isArray(q)),Array.isArray(q)){if(console.log("[MODELSELECT] Response is array, length:",q.length),n.value=q,localStorage.setItem("modelList",JSON.stringify(q)),q.length>0&&!h.value){const $=q[0].id*1;h.value=$,s.value=$}}else console.warn("[MODELSELECT] Response is NOT an array! Type:",typeof q,"Value:",q)}catch(q){console.error("[MODELSELECT] Failed to fetch models from API",q)}},B=C=>{const q=C*1,$=n.value.find(W=>W.id===q);if($&&$.is_subscribe&&!l.value){u.value=!0;return}if($&&$.requires_membership&&!k.value){v.value=!0;return}s.value=q,h.value=q},r=ue(()=>{var q;if(!n.value||n.value.length===0)return null;const C=s.value??h.value??((q=n.value[0])==null?void 0:q.id)??null;if(C&&n.value.length>0){const $=n.value.find(W=>W.id===C);if($&&$.is_subscribe&&!l.value){const W=n.value.find(le=>!le.is_subscribe);return W?W.id:null}if($&&$.requires_membership&&!k.value){const W=n.value.find(le=>!le.requires_membership&&(!le.is_subscribe||l.value));return W?W.id:null}}return C});m=ue(()=>{const C=r.value;return!C||!n.value||n.value.length===0?null:n.value.find(q=>q.id===C)});const j=C=>({cheap:{label:"Cheapest",color:"#52c41a"},normal:{label:"Cheap",color:"#1890ff"},expensive:{label:"Expensive",color:"#722ed1"},very_expensive:{label:"Very Expensive",color:"#ff4d4f"}})[C]||{label:"Unknown",color:"#d9d9d9"},se=ue(()=>{const q=n.value.map(W=>{const le=j(W.price_level_description),pe=W.is_subscribe&&!l.value;return{label:W.model_name,requires_membership:W.requires_membership,value:W.id,logo_url:W.logo_url,disabled:pe,priceLevel:le.level,priceLabel:le.label,priceColor:le.color,platform_name:W.platform_name,platform_id:W.platform_id,is_subscribe:W.is_subscribe,requiresLogin:pe}}).reduce((W,le)=>{const pe=le.platform_name||"Other";return W[pe]||(W[pe]=[]),W[pe].push(le),W},{}),$=Object.keys(q).map(W=>({label:W,options:q[W].sort((le,pe)=>le.priceLevel-pe.priceLevel)}));return console.log("groupedOptions:",$),$}),G=ue(()=>se.value.flatMap(C=>C.options)),ae=()=>{p.value=!1,v.value=!0},L=({menuNode:C})=>{const q=[He("span",{style:{fontSize:"14px",fontWeight:"500",color:"#333"}},st.global.t("lemon.model.models"))];return He("div",[He("div",{class:"model-dropdown-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid #f0f0f0",backgroundColor:"#fafafa",marginBottom:"8px"}},q),C])};Ue(()=>{S(),a(),window.addEventListener("resize",a)}),rt(()=>{window.removeEventListener("resize",a)});let Q=!1;it(()=>{if(Q)return;const C=r.value;C&&C!==h.value&&n.value&&n.value.length>0&&dt(()=>{Q=!0,B(C),dt(()=>{Q=!1})})});const A={userStore:i,membership:e,chatStore:f,model_id:h,modelList:n,selectedModelValue:s,selectRef:d,dropdownOpen:p,showUpgradeModal:v,upgradeTitle:b,showLoginPrompt:u,showMobileModal:o,isMobile:_,isLoggedIn:l,showLoginModal:c,checkMobile:a,get currentModelInfo(){return m},set currentModelInfo(C){m=C},isMember:k,closeModal:I,closeLoginPrompt:O,handleGoToLogin:D,handleMobileModelSelect:P,handleMobileUpgrade:U,openMobileModal:T,closeMobileModal:N,onDropdownVisibleChange:te,initModel:S,changeModel:B,selectedModel:r,getPriceLevel:j,groupedOptions:se,flatOptions:G,handleUpgrade:ae,dropdownRender:L,get isUpdatingFromWatchEffect(){return Q},set isUpdatingFromWatchEffect(C){Q=C},ref:ne,computed:ue,onMounted:Ue,onUnmounted:rt,watchEffect:it,nextTick:dt,h:He,get useChatStore(){return ke},get storeToRefs(){return ve},get DownOutlined(){return Gt},get CloseOutlined(){return _t},get useUserStore(){return Ve},get modelService(){return at},Pricing:Jt,get i18n(){return st}};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}},qr={style:{display:"flex","align-items":"center"}},Jr=["src"],Yr={style:{display:"flex","align-items":"center",gap:"6px"}},Kr={class:"selected-model"},Xr=["src"],Qr={class:"model-name"},ei={class:"modal-header"},ti={class:"model-list"},ni={class:"platform-header"},ri={class:"platform-name"},ii=["onClick"],si={class:"model-info"},oi=["src"],ai={class:"model-name"},li={class:"model-tags"},ci={style:{"text-align":"center",padding:"20px 0"}},di={style:{"margin-bottom":"20px","font-size":"16px"}},ui={style:{"margin-bottom":"20px",color:"#666"}};function hi(z,w,i,e,f,h){var v,b;const n=mt,s=$t,d=Ke,p=We;return J(),ee(ge,null,[ie(" 桌面端选择器 "),e.isMobile?(J(),ee(ge,{key:1},[ie(" 移动端按钮触发器 "),M("div",{class:"mobile-model-trigger",onClick:e.openMobileModal},[M("div",Kr,[(v=e.currentModelInfo)!=null&&v.logo_url?(J(),ee("img",{key:0,src:e.currentModelInfo.logo_url,alt:"logo",class:"model-logo"},null,8,Xr)):ie("v-if",!0),M("span",Qr,re(((b=e.currentModelInfo)==null?void 0:b.model_name)||"Select Model"),1)]),X(e.DownOutlined,{class:"dropdown-icon"})])],2112)):(J(),ye(s,{key:0,ref:"selectRef",class:"model-select",onChange:e.changeModel,value:e.selectedModel,placeholder:z.$t("lemon.input.chooseModel"),style:{"max-width":"200px",width:"100%"},options:e.groupedOptions,optionLabelProp:"label",fieldNames:{label:"label",value:"value"},dropdownMatchSelectWidth:!1,dropdownRender:e.dropdownRender,open:e.dropdownOpen,onDropdownVisibleChange:e.onDropdownVisibleChange},{option:de(({label:u,logo_url:o,requires_membership:_,disabled:l,priceLabel:c,priceColor:a,requiresLogin:m,is_subscribe:k})=>[M("div",{style:cn([{display:"flex","align-items":"center","justify-content":"space-between",width:"100%"},{opacity:l?.5:1}])},[M("div",qr,[o?(J(),ee("img",{key:0,src:o,alt:"logo",style:{"max-width":"20px",height:"20px","margin-right":"8px"}},null,8,Jr)):ie("v-if",!0),M("span",null,re(u),1)]),M("div",Yr,[m?(J(),ye(n,{key:0,size:"small",class:"model-tag-login"},{default:de(()=>[xe(re(z.$t("lemon.model.requiresLogin")),1)]),_:1})):ie("v-if",!0)])],4)]),_:1},8,["value","placeholder","options","open"])),ie(" 移动端底部弹出选择器 "),(J(),ye(ft,{to:"body"},[e.showMobileModal?(J(),ee("div",{key:0,class:"mobile-modal-overlay",onClick:e.closeMobileModal},[M("div",{class:"mobile-model-selector",onClick:w[0]||(w[0]=Ne(()=>{},["stop"]))},[ie(" 头部 "),M("div",ei,[M("h3",null,re(z.$t("lemon.input.chooseModel")),1),X(d,{type:"text",onClick:e.closeMobileModal,class:"close-btn"},{default:de(()=>[X(e.CloseOutlined)]),_:1})]),M("div",ti,[(J(!0),ee(ge,null,Se(e.groupedOptions,u=>(J(),ee("div",{key:u.label,class:"platform-group"},[M("div",ni,[M("span",ri,re(u.label),1)]),(J(!0),ee(ge,null,Se(u.options,o=>(J(),ee("div",{key:o.value,class:Be(["model-item",{selected:o.value===e.selectedModel,disabled:o.disabled}]),onClick:_=>e.handleMobileModelSelect(o)},[M("div",si,[o.logo_url?(J(),ee("img",{key:0,src:o.logo_url,alt:"logo",class:"model-logo"},null,8,oi)):ie("v-if",!0),M("span",ai,re(o.label||o.model_name||"Unknown Model"),1)]),M("div",li,[o.requiresLogin?(J(),ye(n,{key:0,size:"small",class:"model-tag-login"},{default:de(()=>[xe(re(z.$t("lemon.model.requiresLogin")),1)]),_:1})):ie("v-if",!0),o.requires_membership?(J(),ye(n,{key:1,size:"small",class:"model-tag-pro"},{default:de(()=>[...w[3]||(w[3]=[xe(" Pro+ ")])]),_:1})):ie("v-if",!0)])],10,ii))),128))]))),128))])])])):ie("v-if",!0)])),ie(" 升级弹窗 "),X(p,{open:e.showUpgradeModal,"onUpdate:open":w[1]||(w[1]=u=>e.showUpgradeModal=u),title:e.upgradeTitle,centered:"",width:"1200px",footer:null,onCancel:e.closeModal},{default:de(()=>[X(e.Pricing,{isWindow:"true",showTitle:"false",onClose_window:e.closeModal})]),_:1},8,["open","title"]),ie(" 登录提示弹窗 "),X(p,{open:e.showLoginPrompt,"onUpdate:open":w[2]||(w[2]=u=>e.showLoginPrompt=u),title:z.$t("lemon.model.loginRequired"),centered:"",width:"400px",footer:null,onCancel:e.closeLoginPrompt},{default:de(()=>[M("div",ci,[M("p",di,re(z.$t("lemon.model.loginRequiredDescription")),1),M("p",ui,re(z.$t("lemon.model.pleaseLoginFirst")),1),X(d,{type:"primary",onClick:e.handleGoToLogin,style:{"margin-right":"12px"}},{default:de(()=>[xe(re(z.$t("lemon.model.goToLogin")),1)]),_:1}),X(d,{onClick:e.closeLoginPrompt},{default:de(()=>[xe(re(z.$t("lemon.common.cancel")),1)]),_:1})])]),_:1},8,["open","title"])],64)}const fi=Ee(Gr,[["render",hi],["__scopeId","data-v-e7b24d57"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/ModelSelect.vue"]]),pi={__name:"rechargeProducts",props:{open:{type:Boolean,default:!1}},emits:["update:open"],setup(z,{expose:w,emit:i}){w();const{t:e}=Le(),f=Ae(),h=Ve(),{user:n,membership:s,points:d}=ve(h),p=z,v=i,b=ue({get:()=>p.open,set:N=>v("update:open",N)}),u=ne(!1),o=ne(""),_=ne(!1),l=ne(null),c=ne(null),a=ne(!1),m=ue(()=>"$"),k=ne([]),I=async N=>{_.value=!0,l.value=N};Ue(async()=>{await O()});const O=async()=>{let N=await Je.getRechargeProductList();k.value=N||[]},D=async N=>{if(_.value=!1,a.value=!0,N==="stripe"){let te=await Je.createStripePointPurchaseOrder(l.value.id);window.location.href=te.url,a.value=!1}else{let te=await Je.createPointPurchaseOrder(l.value.id);te&&te.code_url?(a.value=!1,o.value=te.code_url,u.value=!0,P(te.order_sn)):a.value=!1,console.log(te)}},P=async N=>{let S=0;c.value=setInterval(async()=>{S++;const B=await Je.checkOrderStatus(N);(B==null?void 0:B.status)==="paid"&&(clearInterval(c.value),u.value=!1,pt.success(e("member.paymentSuccess")),U(),console.log("支付成功")),S>=20&&(clearInterval(c.value),console.warn("支付超时，请重新下单"))},3e3)},U=()=>{window.location.reload()},T={t:e,router:f,userStore:h,user:n,membership:s,points:d,props:p,emit:v,visible:b,showQrCode:u,qrCodeUrl:o,showPaymentMethodModal:_,selectedPlan:l,pollingTimer:c,loading:a,currency:m,rechargeProducts:k,handleBuy:I,toPoints:O,handlePayment:D,checkOrderStatus:P,paySuccess:U,ref:ne,onMounted:Ue,computed:ue,get auth(){return Yt},get membershipService(){return Je},get useI18n(){return Le},get dayjs(){return un},get useRouter(){return Ae},get message(){return pt},get storeToRefs(){return ve},get useUserStore(){return Ve},get StripeLogo(){return Un},get WechatLogo(){return Bn}};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}},mi={key:0,class:"recharge-products"},_i={class:"product-title"},gi={class:"product-info"},vi={style:{"margin-top":"8px"}},bi=["loading","onClick"],wi={key:1},yi={style:{"text-align":"center",display:"flex","flex-direction":"column","align-items":"center"}},ki={style:{display:"inline-block"}},Si={style:{"margin-top":"12px"}},Ci={style:{display:"flex","flex-direction":"column",gap:"16px",padding:"12px 4px"}},xi={class:"payment-content"},Oi={class:"payment-title"},Ei={class:"payment-description"},Mi={class:"payment-content"},Ii={class:"payment-title"},zi={class:"payment-description"};function Ai(z,w,i,e,f,h){const n=dn,s=We;return J(),ye(s,{open:e.visible,"onUpdate:open":w[4]||(w[4]=d=>e.visible=d),width:"720px",centered:"",footer:null,title:"Buy add-on credits"},{default:de(()=>[ie(" 原来的内容 "),e.rechargeProducts.length?(J(),ee("div",mi,[(J(!0),ee(ge,null,Se(e.rechargeProducts,d=>(J(),ee("div",{key:d.id,class:"product-card"},[M("div",_i,re(d.product_name),1),M("div",gi,[M("p",vi,re(e.currency)+" "+re(d.amount),1),M("p",null,re(d.points_awarded)+re(e.t("member.pointsUnit")),1)]),M("button",{size:"small",loading:e.loading,onClick:p=>e.handleBuy(d)},re(e.t("member.buyNow")),9,bi)]))),128))])):(J(),ee("div",wi,re(e.t("member.noPackagesAvailable")),1)),ie(" 扫码支付弹窗 "),X(s,{open:e.showQrCode,"onUpdate:open":w[0]||(w[0]=d=>e.showQrCode=d),title:e.t("member.wechatScanToPay"),centered:"",footer:null},{default:de(()=>[M("div",yi,[M("div",ki,[X(n,{value:e.qrCodeUrl,size:200},null,8,["value"])]),M("p",Si,re(e.t("member.wechatScanPrompt")),1)])]),_:1},8,["open","title"]),ie(" 支付方式选择 "),X(s,{open:e.showPaymentMethodModal,"onUpdate:open":w[3]||(w[3]=d=>e.showPaymentMethodModal=d),footer:null,centered:"",width:"480",title:z.$t("member.selectPaymentMethod")},{default:de(()=>[M("div",Ci,[M("div",{class:"payment-option",onClick:w[1]||(w[1]=d=>e.handlePayment("stripe"))},[X(e.StripeLogo),M("div",xi,[M("div",Oi,re(z.$t("payment.stripe.title")),1),M("div",Ei,re(z.$t("payment.stripe.description")),1)])]),M("div",{class:"payment-option",onClick:w[2]||(w[2]=d=>e.handlePayment("wechat"))},[X(e.WechatLogo),M("div",Mi,[M("div",Ii,re(z.$t("payment.wechat.title")),1),M("div",zi,re(z.$t("payment.wechat.description")),1)])])])]),_:1},8,["open","title"])]),_:1},8,["open"])}const Ti=Ee(pi,[["render",Ai],["__scopeId","data-v-eea0ace6"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/pay/components/rechargeProducts.vue"]]),Pi={__name:"ChatInput",emits:["send"],setup(z,{expose:w,emit:i}){w();const{t:e}=Le(),f=Ae(),h=ot(),n=ne("Upgrade required"),s=Ve(),{user:d,membership:p,points:v}=ve(s),b=ke(),{agent:u,chat:o,model_id:_}=ve(b),l=ne(""),c=ne(e("lemon.welcome.placeholder")),a=ne([]),m=ne("text"),k=ne(!0),I=ne(!1),O=ne(localStorage.getItem("workMode")||"auto"),D=ue(()=>[{value:"auto",label:e("lemon.workMode.auto.label"),description:e("lemon.workMode.auto.description")},{value:"agent",label:e("lemon.workMode.agent.label"),description:e("lemon.workMode.agent.description")},{value:"chat",label:e("lemon.workMode.chat.label"),description:e("lemon.workMode.chat.description")}]),P=ne([]),U=ne([]),T=i,N=[{value:!0,label:"Public",desc:"Anyone can view and remix"},{value:!1,label:"Personal",desc:"Only visible to yourself"}],te=ne(!1),S=ne(""),B=ne(""),r=ne(!1),j=ne(!1),se=ne(!1),G=ue(()=>!!d.value.id),ae=ue(()=>b.mode),L=ue(()=>h.params.id||null),Q=ue(()=>U.value.length===0?["disable"]:U.value),A=ue(()=>{var Z;const x=b.list.find(K=>{var Y;return K.conversation_id===((Y=b.chat)==null?void 0:Y.conversation_id)});return console.log(" chat?.status",x==null?void 0:x.status),console.log(" chatStore.chat?.conversation_id ",(Z=b.chat)==null?void 0:Z.conversation_id),(x==null?void 0:x.status)!="running"}),C=()=>{r.value=window.innerWidth<=768},q=()=>{j.value=!0},$=()=>{const x=document.querySelector(".mobile-mode-selector");x&&x.classList.add("closing"),setTimeout(()=>{j.value=!1},250)},W=()=>{se.value=!0},le=()=>{const x=document.querySelector(".mobile-visibility-selector");x&&x.classList.add("closing"),setTimeout(()=>{se.value=!1},250)},pe=x=>{Ce(x),$()},ce=x=>{t(x),le()};Ue(async()=>{await R(),await fe(),C(),window.addEventListener("resize",C),Oe.on("changeMessageText",x=>{l.value=x}),Oe.on("showUpgrade",()=>{n.value="",S.value="You don't have enough credits, and the prediction can't complete the task. ",B.value="Please upgrade or purchase more credits.",te.value=!0})}),rt(()=>{window.removeEventListener("resize",C)}),je(()=>h.params.agentId,()=>{console.log("agent.value 改变",u.value),u.value&&(U.value=u.value.mcp_server_ids||[])});const fe=async()=>{const x=await Tt.activate_servers();Array.isArray(x)&&(P.value=x),u.value&&(U.value=u.value.mcp_server_ids||[])},we=({key:x})=>{if(x==="disable")U.value=[];else{const Z=U.value.indexOf(x);Z!==-1?U.value.splice(Z,1):U.value.push(x)}localStorage.setItem("selectedMcpServerIds",JSON.stringify(U.value)),u.value&&(u.value.mcp_server_ids=U.value,_e())},_e=async()=>{u.value&&(await lt.update(u.value.id,u.value.name,u.value.describe,u.value.mcp_server_ids,u.value.is_public),Oe.emit("updateAgentList"))},Me=()=>{te.value=!1},Ce=x=>{O.value=x,console.log("工作模式切换为:",x),localStorage.setItem("workMode",x)},t=x=>{var Z;if(console.log("handleVisibilityChange",x),!x&&!((Z=p.value)!=null&&Z.planName)){k.value=!0,n.value="Upgrade required",S.value="",te.value=!0;return}u.value.is_public=x,_e()};je(()=>u.value,x=>{var Z;u.value&&u.value.is_public!==void 0?k.value=(Z=u.value)==null?void 0:Z.is_public:k.value=!0},{immediate:!0}),window.addEventListener("message",x=>{if(x.origin!=="https://lemonai.ai")return;const{type:Z,payload:K}=x.data;console.log("监听 message 事件",x.data),Z==="transferData"&&(b.mode="task",l.value=K,y())});const F=ne([]),R=async()=>{console.log("membership.value",p.value);const x=K=>{if(K.length>0&&!_.value){const Y=K[0].id*1;_.value=Y}},Z=localStorage.getItem("modelList");if(Z)try{F.value=JSON.parse(Z),x(F.value)}catch(K){console.error("Failed to parse cached modelList",K)}try{const K=await at.getModels();Array.isArray(K)&&(F.value=K,localStorage.setItem("modelList",JSON.stringify(K)),x(K))}catch(K){console.error("Failed to fetch models from API",K)}},y=()=>{const x=l.value.trim();if(!x&&a.value.length===0)return;console.log("selectedModelValue.value",_.value);let K=JSON.parse(localStorage.getItem("modelList")).find(Y=>Y.id===_.value);if(console.log("modelDetail",K),v.value.total<=100&&K.is_subscribe){S.value="You don't have enough credits to use this subscription model. ",B.value="Please subscribe or purchase more credits to continue.",n.value="",te.value=!0;return}T("send",{text:x,mode:m.value,files:a.value,mcp_server_ids:U.value,is_public:k.value,workMode:O.value}),l.value="",a.value=[]},H={t:e,router:f,route:h,upgradeTitle:n,userStore:s,user:d,membership:p,points:v,chatStore:b,agent:u,chat:o,model_id:_,messageText:l,placeholder:c,fileList:a,currentMode:m,isPublic:k,showRechargeModal:I,workMode:O,workModeOptions:D,mcpServers:P,selectedMcpServerIds:U,emit:T,visibilityOptions:N,showUpgradeModal:te,upgradeDes:S,upgradeDes1:B,isMobile:r,showModeModal:j,showVisibilityModal:se,isLogin:G,chatMode:ae,conversation_id:L,mcpMenuSelectedKeys:Q,messageStatus:A,checkMobile:C,openModeModal:q,closeModeModal:$,openVisibilityModal:W,closeVisibilityModal:le,handleMobileModeSelect:pe,handleMobileVisibilitySelect:ce,fetchMcpServers:fe,handleMcpMenuClick:we,updateAgent:_e,closeModal:Me,handleModeChange:Ce,handleVisibilityChange:t,modelList:F,initModel:R,handleSend:y,handleStop:()=>{b.handleStop()},handleNotification:(x,Z,K)=>{const Y=`jump-${Date.now()}`;ut.warning({message:Z,key:Y,description:He("span",{style:{textDecoration:"underline",cursor:"pointer",color:"#1677ff"}},K),duration:2,onClick:()=>{ut.close(Y),f.push(x)}})},keydown:x=>{x.shiftKey&&x.key==="Enter"||x.isComposing||x.key==="Enter"&&(x.preventDefault(),y())},ref:ne,computed:ue,onMounted:Ue,onUnmounted:rt,watch:je,h:He,get useRoute(){return ot},get useRouter(){return Ae},get useI18n(){return Le},get notification(){return ut},get message(){return pt},get PaperClipOutlined(){return Ht},get CloudServerOutlined(){return vt},get CheckOutlined(){return pn},get MessageOutlined(){return wt},get ToolOutlined(){return Wn},get PlayCircleOutlined(){return yt},get TeamOutlined(){return Ct},get SyncOutlined(){return St},get ForkOutlined(){return bt},get RobotOutlined(){return kt},get BulbOutlined(){return gt},get DownOutlined(){return Gt},get CloseOutlined(){return _t},ChatInputFile:Lr,ChatInputUpload:Br,SelectionPreview:$r,ModelSelect:fi,Pricing:Jt,RechargeModal:Ti,get emitter(){return Oe},get mcpService(){return Tt},get files(){return Ze},get agentService(){return lt},get chatService(){return On},get modelService(){return at},get storeToRefs(){return ve},get useUserStore(){return Ve},get useChatStore(){return ke}};return Object.defineProperty(H,"__isScriptSetup",{enumerable:!1,value:!0}),H}},Li={class:"chat-input"},Di={class:"input-wrapper"},Ri={class:"input-area"},Bi={class:"input-container"},Ui={class:"input-actions"},Fi={class:"left-actions"},ji={class:"button-row first-row"},Ni={class:"mode-selector-dropdown"},Wi={class:"mode-option"},Zi={class:"mode-circle"},Vi={key:0,class:"mode-inner-circle"},Hi={class:"mode-texts"},$i={class:"mode-label"},Gi={class:"mode-desc"},qi={class:"mode-name"},Ji={class:"mcp-button-container"},Yi={class:"modal-header"},Ki={class:"option-list"},Xi=["onClick"],Qi={class:"option-info"},es={class:"option-circle"},ts={key:0,class:"option-inner-circle"},ns={class:"option-texts"},rs={class:"option-label"},is={class:"option-desc"},ss={class:"modal-header"},os={class:"option-list"},as=["onClick"],ls={class:"option-info"},cs={class:"option-circle"},ds={key:0,class:"option-inner-circle"},us={class:"option-texts"},hs={class:"option-label"},fs={class:"option-desc"},ps={class:"buy-credits"},ms={class:"upgrade-des-wrapper"},_s={key:0,class:"upgrade-des"},gs={key:1,class:"upgrade-des"};function vs(z,w,i,e,f,h){var l;const n=hn,s=$t,d=Ke,p=_n,v=gn,b=mn,u=fn,o=mt,_=We;return J(),ee(ge,null,[M("div",Li,[ie(" 选中元素预览组件 "),X(e.SelectionPreview),M("div",Di,[M("div",Ri,[X(e.ChatInputFile,{fileList:e.fileList,"onUpdate:fileList":w[0]||(w[0]=c=>e.fileList=c),conversation_id:e.conversation_id,"onUpdate:conversation_id":w[1]||(w[1]=c=>e.conversation_id=c)},null,8,["fileList","conversation_id"]),M("div",Bi,[X(n,{class:"input-textarea",value:e.messageText,"onUpdate:value":w[2]||(w[2]=c=>e.messageText=c),placeholder:e.placeholder,"auto-size":{minRows:2,maxRows:8},onKeydown:e.keydown},null,8,["value","placeholder"]),M("div",Ui,[M("div",Fi,[ie(" 第一行按钮 "),M("div",ji,[ie(" 文件上传 "),e.chatMode==="task"?(J(),ye(e.ChatInputUpload,{key:0,fileList:e.fileList,"onUpdate:fileList":w[3]||(w[3]=c=>e.fileList=c),conversation_id:e.conversation_id,"onUpdate:conversation_id":w[4]||(w[4]=c=>e.conversation_id=c),isPublic:e.isPublic},null,8,["fileList","conversation_id","isPublic"])):ie("v-if",!0),X(e.ModelSelect),ie(" 模式切换器 - 响应式 "),M("div",Ni,[ie(" 桌面端下拉框 "),e.isMobile?(J(),ee(ge,{key:1},[ie(" 移动端触发器 "),M("div",{class:"mobile-mode-trigger",onClick:e.openModeModal},[M("span",qi,re(((l=e.workModeOptions.find(c=>c.value===e.workMode))==null?void 0:l.label)||"Auto"),1),X(e.DownOutlined,{class:"dropdown-icon"})])],2112)):(J(),ye(s,{key:0,value:e.workMode,"onUpdate:value":w[5]||(w[5]=c=>e.workMode=c),class:"mode-select-dropdown",options:e.workModeOptions,onChange:e.handleModeChange,dropdownMatchSelectWidth:!1,bordered:!1},{option:de(({value:c,label:a,description:m})=>[M("div",Wi,[M("span",Zi,[e.workMode===c?(J(),ee("span",Vi)):ie("v-if",!0)]),M("div",Hi,[M("div",$i,re(a),1),M("div",Gi,re(m),1)])])]),_:1},8,["value","options"]))]),ie(` <div class="visibility-toggle">
                  <a-select
                    v-if="!isMobile"
                    v-model:value="isPublic"
                    class="visibility-select"
                    :options="visibilityOptions"
                    @change="handleVisibilityChange"
                    :dropdownMatchSelectWidth="false"
                    :bordered="false"
                  >
                    <template #option="{ value, label, desc }">
                      <div class="custom-option">
                        <span class="radio-circle">
                          <span v-if="isPublic === value" class="inner-circle" />
                        </span>
                        <div class="option-texts">
                          <div style="display: flex; align-items: center; gap: 8px">
                            {{ label }}
                            <a-tag v-if="!value" size="small" class="pro-tag">Pro+</a-tag>
                          </div>
                          <div class="desc">{{ desc }}</div>
                        </div>
                      </div>
                    </template>
                  </a-select>
                  <div v-else class="mobile-visibility-trigger" @click="openVisibilityModal">
                    <span class="visibility-name">{{ visibilityOptions.find((opt) => opt.value === isPublic)?.label || "Public" }}</span>
                    <DownOutlined class="dropdown-icon" />
                  </div>
                </div> `),M("div",Ji,[ie(" MCP服务器 "),X(u,{trigger:["click"],placement:"top",class:"mcp-dropdown"},{overlay:de(()=>[X(b,{selectedKeys:e.mcpMenuSelectedKeys,multiple:"",class:"mcp-server-menu",onClick:e.handleMcpMenuClick},{default:de(()=>[X(p,{key:"disable"},{default:de(()=>w[12]||(w[12]=[M("span",null,"Close MCP",-1)])),_:1}),X(v),(J(!0),ee(ge,null,Se(e.mcpServers,c=>(J(),ye(p,{key:c.id,class:"mcp-server-item"},{default:de(()=>[M("span",null,re(c.name),1),e.selectedMcpServerIds&&e.selectedMcpServerIds.includes(c.id)?(J(),ye(e.CheckOutlined,{key:0,class:"check-icon"})):ie("v-if",!0)]),_:2},1024))),128))]),_:1},8,["selectedKeys"])]),default:de(()=>[X(d,{class:Be(["mcp-button",{"mcp-button-active":e.selectedMcpServerIds&&e.selectedMcpServerIds.length>0}])},{icon:de(()=>[X(e.CloudServerOutlined)]),default:de(()=>[w[11]||(w[11]=xe(" MCP "))]),_:1},8,["class"])]),_:1})])]),ie(` 第二行按钮
              <div class="button-row second-row" v-if="chatMode === 'task'">
                

                
              </div> `)]),ie(" {{ messageStatus }} "),e.messageStatus?(J(),ye(d,{key:0,onClick:e.handleSend,class:"send-button",disabled:!e.messageText},{icon:de(()=>w[13]||(w[13]=[M("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 16 16",fill:"#fff"},[M("path",{d:"M7.91699 15.0642C7.53125 15.0642 7.22119 14.9397 6.98682 14.6907C6.75244 14.4465 6.63525 14.1218 6.63525 13.7166V6.39966L6.77441 3.34546L7.48486 3.89478L5.62451 6.12134L3.99121 7.76196C3.87402 7.87915 3.73975 7.97681 3.58838 8.05493C3.44189 8.13306 3.271 8.17212 3.07568 8.17212C2.73389 8.17212 2.4458 8.05981 2.21143 7.83521C1.98193 7.60571 1.86719 7.3103 1.86719 6.94897C1.86719 6.60229 1.99902 6.29712 2.2627 6.03345L6.97949 1.30933C7.0918 1.19214 7.2334 1.10181 7.4043 1.03833C7.5752 0.969971 7.74609 0.935791 7.91699 0.935791C8.08789 0.935791 8.25879 0.969971 8.42969 1.03833C8.60059 1.10181 8.74463 1.19214 8.86182 1.30933L13.5786 6.03345C13.8423 6.29712 13.9741 6.60229 13.9741 6.94897C13.9741 7.3103 13.8569 7.60571 13.6226 7.83521C13.3931 8.05981 13.1074 8.17212 12.7656 8.17212C12.5703 8.17212 12.397 8.13306 12.2456 8.05493C12.0991 7.97681 11.9673 7.87915 11.8501 7.76196L10.2095 6.12134L8.34912 3.89478L9.05957 3.34546L9.19141 6.39966V13.7166C9.19141 14.1218 9.07422 14.4465 8.83984 14.6907C8.60547 14.9397 8.29785 15.0642 7.91699 15.0642Z",fill:"var(--icon-onblack)"})],-1)])),_:1},8,["disabled"])):(J(),ee(ge,{key:1},[ie(" 停止按钮 "),M("button",{class:"stop-button",onClick:e.handleStop},w[14]||(w[14]=[M("div",null,null,-1)]))],2112))])])])])]),ie(" 移动端模式选择弹窗 "),(J(),ye(ft,{to:"body"},[e.showModeModal?(J(),ee("div",{key:0,class:"mobile-modal-overlay",onClick:e.closeModeModal},[M("div",{class:"mobile-mode-selector",onClick:w[6]||(w[6]=Ne(()=>{},["stop"]))},[M("div",Yi,[M("h3",null,re(e.t("lemon.workMode.title")),1),X(d,{type:"text",onClick:e.closeModeModal,class:"close-btn"},{default:de(()=>[X(e.CloseOutlined)]),_:1})]),M("div",Ki,[(J(!0),ee(ge,null,Se(e.workModeOptions,c=>(J(),ee("div",{key:c.value,class:Be(["option-item",{selected:c.value===e.workMode}]),onClick:a=>e.handleMobileModeSelect(c.value)},[M("div",Qi,[M("span",es,[e.workMode===c.value?(J(),ee("span",ts)):ie("v-if",!0)]),M("div",ns,[M("div",rs,re(c.label),1),M("div",is,re(c.description),1)])])],10,Xi))),128))])])])):ie("v-if",!0)])),ie(" 移动端可视选择弹窗 "),(J(),ye(ft,{to:"body"},[e.showVisibilityModal?(J(),ee("div",{key:0,class:"mobile-modal-overlay",onClick:e.closeVisibilityModal},[M("div",{class:"mobile-visibility-selector",onClick:w[7]||(w[7]=Ne(()=>{},["stop"]))},[M("div",ss,[w[15]||(w[15]=M("h3",null,"Visibility",-1)),X(d,{type:"text",onClick:e.closeVisibilityModal,class:"close-btn"},{default:de(()=>[X(e.CloseOutlined)]),_:1})]),M("div",os,[(J(),ee(ge,null,Se(e.visibilityOptions,c=>M("div",{key:c.value,class:Be(["option-item",{selected:c.value===e.isPublic}]),onClick:a=>e.handleMobileVisibilitySelect(c.value)},[M("div",ls,[M("span",cs,[e.isPublic===c.value?(J(),ee("span",ds)):ie("v-if",!0)]),M("div",us,[M("div",hs,[xe(re(c.label)+" ",1),c.value?ie("v-if",!0):(J(),ye(o,{key:0,size:"small",class:"pro-tag-mobile"},{default:de(()=>[...w[16]||(w[16]=[xe("Pro+")])]),_:1}))]),M("div",fs,re(c.desc),1)])])],10,as)),64))])])])):ie("v-if",!0)])),ie(" 升级弹窗 "),X(_,{open:e.showUpgradeModal,"onUpdate:open":w[9]||(w[9]=c=>e.showUpgradeModal=c),title:e.upgradeTitle,centered:"",width:"1200px",footer:null,onCancel:e.closeModal},{default:de(()=>{var c;return[ie(" 购买积分按钮 "),M("div",ps,[M("div",ms,[e.upgradeDes?(J(),ee("span",_s,re(e.upgradeDes),1)):ie("v-if",!0),e.upgradeDes1?(J(),ee("span",gs,re(e.upgradeDes1),1)):ie("v-if",!0)]),(c=e.membership)!=null&&c.planName?(J(),ye(d,{key:0,type:"primary",onClick:w[8]||(w[8]=a=>e.showRechargeModal=!0)},{default:de(()=>w[17]||(w[17]=[xe("Buy credits")])),_:1})):ie("v-if",!0)]),X(e.Pricing,{isWindow:"true",showTitle:"false",onClose_window:e.closeModal})]}),_:1},8,["open","title"]),X(e.RechargeModal,{open:e.showRechargeModal,"onUpdate:open":w[10]||(w[10]=c=>e.showRechargeModal=c)},null,8,["open"])],64)}const xt=Ee(Pi,[["render",vs],["__scopeId","data-v-140681a6"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/ChatInput.vue"]]),bs={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-arrow-down text-[var(--icon-primary)]",viewBox:"0 0 24 24"};function ws(z,w){return J(),ee("svg",bs,w[0]||(w[0]=[M("path",{d:"M12 5v14M19 12l-7 7-7-7"},null,-1)]))}const ys={render:ws};function nt(z){throw new Error('Could not dynamically require "'+z+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kt={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(z,w){(function(i){z.exports=i()})(function(){return function i(e,f,h){function n(p,v){if(!f[p]){if(!e[p]){var b=typeof nt=="function"&&nt;if(!v&&b)return b(p,!0);if(s)return s(p,!0);var u=new Error("Cannot find module '"+p+"'");throw u.code="MODULE_NOT_FOUND",u}var o=f[p]={exports:{}};e[p][0].call(o.exports,function(_){var l=e[p][1][_];return n(l||_)},o,o.exports,i,e,f,h)}return f[p].exports}for(var s=typeof nt=="function"&&nt,d=0;d<h.length;d++)n(h[d]);return n}({1:[function(i,e,f){var h=i("./utils"),n=i("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";f.encode=function(d){for(var p,v,b,u,o,_,l,c=[],a=0,m=d.length,k=m,I=h.getTypeOf(d)!=="string";a<d.length;)k=m-a,b=I?(p=d[a++],v=a<m?d[a++]:0,a<m?d[a++]:0):(p=d.charCodeAt(a++),v=a<m?d.charCodeAt(a++):0,a<m?d.charCodeAt(a++):0),u=p>>2,o=(3&p)<<4|v>>4,_=1<k?(15&v)<<2|b>>6:64,l=2<k?63&b:64,c.push(s.charAt(u)+s.charAt(o)+s.charAt(_)+s.charAt(l));return c.join("")},f.decode=function(d){var p,v,b,u,o,_,l=0,c=0,a="data:";if(d.substr(0,a.length)===a)throw new Error("Invalid base64 input, it looks like a data url.");var m,k=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===s.charAt(64)&&k--,d.charAt(d.length-2)===s.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=n.uint8array?new Uint8Array(0|k):new Array(0|k);l<d.length;)p=s.indexOf(d.charAt(l++))<<2|(u=s.indexOf(d.charAt(l++)))>>4,v=(15&u)<<4|(o=s.indexOf(d.charAt(l++)))>>2,b=(3&o)<<6|(_=s.indexOf(d.charAt(l++))),m[c++]=p,o!==64&&(m[c++]=v),_!==64&&(m[c++]=b);return m}},{"./support":30,"./utils":32}],2:[function(i,e,f){var h=i("./external"),n=i("./stream/DataWorker"),s=i("./stream/Crc32Probe"),d=i("./stream/DataLengthProbe");function p(v,b,u,o,_){this.compressedSize=v,this.uncompressedSize=b,this.crc32=u,this.compression=o,this.compressedContent=_}p.prototype={getContentWorker:function(){var v=new n(h.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),b=this;return v.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new n(h.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(v,b,u){return v.pipe(new s).pipe(new d("uncompressedSize")).pipe(b.compressWorker(u)).pipe(new d("compressedSize")).withStreamInfo("compression",b)},e.exports=p},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(i,e,f){var h=i("./stream/GenericWorker");f.STORE={magic:"\0\0",compressWorker:function(){return new h("STORE compression")},uncompressWorker:function(){return new h("STORE decompression")}},f.DEFLATE=i("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(i,e,f){var h=i("./utils"),n=function(){for(var s,d=[],p=0;p<256;p++){s=p;for(var v=0;v<8;v++)s=1&s?3988292384^s>>>1:s>>>1;d[p]=s}return d}();e.exports=function(s,d){return s!==void 0&&s.length?h.getTypeOf(s)!=="string"?function(p,v,b,u){var o=n,_=u+b;p^=-1;for(var l=u;l<_;l++)p=p>>>8^o[255&(p^v[l])];return-1^p}(0|d,s,s.length,0):function(p,v,b,u){var o=n,_=u+b;p^=-1;for(var l=u;l<_;l++)p=p>>>8^o[255&(p^v.charCodeAt(l))];return-1^p}(0|d,s,s.length,0):0}},{"./utils":32}],5:[function(i,e,f){f.base64=!1,f.binary=!1,f.dir=!1,f.createFolders=!0,f.date=null,f.compression=null,f.compressionOptions=null,f.comment=null,f.unixPermissions=null,f.dosPermissions=null},{}],6:[function(i,e,f){var h=null;h=typeof Promise<"u"?Promise:i("lie"),e.exports={Promise:h}},{lie:37}],7:[function(i,e,f){var h=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=i("pako"),s=i("./utils"),d=i("./stream/GenericWorker"),p=h?"uint8array":"array";function v(b,u){d.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=u,this.meta={}}f.magic="\b\0",s.inherits(v,d),v.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(p,b.data),!1)},v.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(u){b.push({data:u,meta:b.meta})}},f.compressWorker=function(b){return new v("Deflate",b)},f.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(i,e,f){function h(o,_){var l,c="";for(l=0;l<_;l++)c+=String.fromCharCode(255&o),o>>>=8;return c}function n(o,_,l,c,a,m){var k,I,O=o.file,D=o.compression,P=m!==p.utf8encode,U=s.transformTo("string",m(O.name)),T=s.transformTo("string",p.utf8encode(O.name)),N=O.comment,te=s.transformTo("string",m(N)),S=s.transformTo("string",p.utf8encode(N)),B=T.length!==O.name.length,r=S.length!==N.length,j="",se="",G="",ae=O.dir,L=O.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};_&&!l||(Q.crc32=o.crc32,Q.compressedSize=o.compressedSize,Q.uncompressedSize=o.uncompressedSize);var A=0;_&&(A|=8),P||!B&&!r||(A|=2048);var C=0,q=0;ae&&(C|=16),a==="UNIX"?(q=798,C|=function(W,le){var pe=W;return W||(pe=le?16893:33204),(65535&pe)<<16}(O.unixPermissions,ae)):(q=20,C|=function(W){return 63&(W||0)}(O.dosPermissions)),k=L.getUTCHours(),k<<=6,k|=L.getUTCMinutes(),k<<=5,k|=L.getUTCSeconds()/2,I=L.getUTCFullYear()-1980,I<<=4,I|=L.getUTCMonth()+1,I<<=5,I|=L.getUTCDate(),B&&(se=h(1,1)+h(v(U),4)+T,j+="up"+h(se.length,2)+se),r&&(G=h(1,1)+h(v(te),4)+S,j+="uc"+h(G.length,2)+G);var $="";return $+=`
\0`,$+=h(A,2),$+=D.magic,$+=h(k,2),$+=h(I,2),$+=h(Q.crc32,4),$+=h(Q.compressedSize,4),$+=h(Q.uncompressedSize,4),$+=h(U.length,2),$+=h(j.length,2),{fileRecord:b.LOCAL_FILE_HEADER+$+U+j,dirRecord:b.CENTRAL_FILE_HEADER+h(q,2)+$+h(te.length,2)+"\0\0\0\0"+h(C,4)+h(c,4)+U+j+te}}var s=i("../utils"),d=i("../stream/GenericWorker"),p=i("../utf8"),v=i("../crc32"),b=i("../signature");function u(o,_,l,c){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=l,this.encodeFileName=c,this.streamFiles=o,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(u,d),u.prototype.push=function(o){var _=o.meta.percent||0,l=this.entriesCount,c=this._sources.length;this.accumulate?this.contentBuffer.push(o):(this.bytesWritten+=o.data.length,d.prototype.push.call(this,{data:o.data,meta:{currentFile:this.currentFile,percent:l?(_+100*(l-c-1))/l:100}}))},u.prototype.openedSource=function(o){this.currentSourceOffset=this.bytesWritten,this.currentFile=o.file.name;var _=this.streamFiles&&!o.file.dir;if(_){var l=n(o,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(o){this.accumulate=!1;var _=this.streamFiles&&!o.file.dir,l=n(o,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),_)this.push({data:function(c){return b.DATA_DESCRIPTOR+h(c.crc32,4)+h(c.compressedSize,4)+h(c.uncompressedSize,4)}(o),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var o=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var l=this.bytesWritten-o,c=function(a,m,k,I,O){var D=s.transformTo("string",O(I));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+h(a,2)+h(a,2)+h(m,4)+h(k,4)+h(D.length,2)+D}(this.dirRecords.length,l,o,this.zipComment,this.encodeFileName);this.push({data:c,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(o){this._sources.push(o);var _=this;return o.on("data",function(l){_.processChunk(l)}),o.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),o.on("error",function(l){_.error(l)}),this},u.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(o){var _=this._sources;if(!d.prototype.error.call(this,o))return!1;for(var l=0;l<_.length;l++)try{_[l].error(o)}catch{}return!0},u.prototype.lock=function(){d.prototype.lock.call(this);for(var o=this._sources,_=0;_<o.length;_++)o[_].lock()},e.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(i,e,f){var h=i("../compressions"),n=i("./ZipFileWorker");f.generateWorker=function(s,d,p){var v=new n(d.streamFiles,p,d.platform,d.encodeFileName),b=0;try{s.forEach(function(u,o){b++;var _=function(m,k){var I=m||k,O=h[I];if(!O)throw new Error(I+" is not a valid compression method !");return O}(o.options.compression,d.compression),l=o.options.compressionOptions||d.compressionOptions||{},c=o.dir,a=o.date;o._compressWorker(_,l).withStreamInfo("file",{name:u,dir:c,date:a,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(v)}),v.entriesCount=b}catch(u){v.error(u)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(i,e,f){function h(){if(!(this instanceof h))return new h;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var n=new h;for(var s in this)typeof this[s]!="function"&&(n[s]=this[s]);return n}}(h.prototype=i("./object")).loadAsync=i("./load"),h.support=i("./support"),h.defaults=i("./defaults"),h.version="3.10.1",h.loadAsync=function(n,s){return new h().loadAsync(n,s)},h.external=i("./external"),e.exports=h},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(i,e,f){var h=i("./utils"),n=i("./external"),s=i("./utf8"),d=i("./zipEntries"),p=i("./stream/Crc32Probe"),v=i("./nodejsUtils");function b(u){return new n.Promise(function(o,_){var l=u.decompressed.getContentWorker().pipe(new p);l.on("error",function(c){_(c)}).on("end",function(){l.streamInfo.crc32!==u.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):o()}).resume()})}e.exports=function(u,o){var _=this;return o=h.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),v.isNode&&v.isStream(u)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):h.prepareContent("the loaded zip file",u,!0,o.optimizedBinaryString,o.base64).then(function(l){var c=new d(o);return c.load(l),c}).then(function(l){var c=[n.Promise.resolve(l)],a=l.files;if(o.checkCRC32)for(var m=0;m<a.length;m++)c.push(b(a[m]));return n.Promise.all(c)}).then(function(l){for(var c=l.shift(),a=c.files,m=0;m<a.length;m++){var k=a[m],I=k.fileNameStr,O=h.resolve(k.fileNameStr);_.file(O,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:o.createFolders}),k.dir||(_.file(O).unsafeOriginalName=I)}return c.zipComment.length&&(_.comment=c.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(i,e,f){var h=i("../utils"),n=i("../stream/GenericWorker");function s(d,p){n.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(p)}h.inherits(s,n),s.prototype._bindStream=function(d){var p=this;(this._stream=d).pause(),d.on("data",function(v){p.push({data:v,meta:{percent:0}})}).on("error",function(v){p.isPaused?this.generatedError=v:p.error(v)}).on("end",function(){p.isPaused?p._upstreamEnded=!0:p.end()})},s.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(i,e,f){var h=i("readable-stream").Readable;function n(s,d,p){h.call(this,d),this._helper=s;var v=this;s.on("data",function(b,u){v.push(b)||v._helper.pause(),p&&p(u)}).on("error",function(b){v.emit("error",b)}).on("end",function(){v.push(null)})}i("../utils").inherits(n,h),n.prototype._read=function(){this._helper.resume()},e.exports=n},{"../utils":32,"readable-stream":16}],14:[function(i,e,f){e.exports={isNode:typeof Buffer<"u",newBufferFrom:function(h,n){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(h,n);if(typeof h=="number")throw new Error('The "data" argument must not be a number');return new Buffer(h,n)},allocBuffer:function(h){if(Buffer.alloc)return Buffer.alloc(h);var n=new Buffer(h);return n.fill(0),n},isBuffer:function(h){return Buffer.isBuffer(h)},isStream:function(h){return h&&typeof h.on=="function"&&typeof h.pause=="function"&&typeof h.resume=="function"}}},{}],15:[function(i,e,f){function h(O,D,P){var U,T=s.getTypeOf(D),N=s.extend(P||{},v);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&16384&N.unixPermissions&&(N.dir=!0),N.dosPermissions&&16&N.dosPermissions&&(N.dir=!0),N.dir&&(O=a(O)),N.createFolders&&(U=c(O))&&m.call(this,U,!0);var te=T==="string"&&N.binary===!1&&N.base64===!1;P&&P.binary!==void 0||(N.binary=!te),(D instanceof b&&D.uncompressedSize===0||N.dir||!D||D.length===0)&&(N.base64=!1,N.binary=!0,D="",N.compression="STORE",T="string");var S=null;S=D instanceof b||D instanceof d?D:_.isNode&&_.isStream(D)?new l(O,D):s.prepareContent(O,D,N.binary,N.optimizedBinaryString,N.base64);var B=new u(O,S,N);this.files[O]=B}var n=i("./utf8"),s=i("./utils"),d=i("./stream/GenericWorker"),p=i("./stream/StreamHelper"),v=i("./defaults"),b=i("./compressedObject"),u=i("./zipObject"),o=i("./generate"),_=i("./nodejsUtils"),l=i("./nodejs/NodejsStreamInputAdapter"),c=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var D=O.lastIndexOf("/");return 0<D?O.substring(0,D):""},a=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},m=function(O,D){return D=D!==void 0?D:v.createFolders,O=a(O),this.files[O]||h.call(this,O,null,{dir:!0,createFolders:D}),this.files[O]};function k(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var D,P,U;for(D in this.files)U=this.files[D],(P=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&O(P,U)},filter:function(O){var D=[];return this.forEach(function(P,U){O(P,U)&&D.push(U)}),D},file:function(O,D,P){if(arguments.length!==1)return O=this.root+O,h.call(this,O,D,P),this;if(k(O)){var U=O;return this.filter(function(N,te){return!te.dir&&U.test(N)})}var T=this.files[this.root+O];return T&&!T.dir?T:null},folder:function(O){if(!O)return this;if(k(O))return this.filter(function(T,N){return N.dir&&O.test(T)});var D=this.root+O,P=m.call(this,D),U=this.clone();return U.root=P.name,U},remove:function(O){O=this.root+O;var D=this.files[O];if(D||(O.slice(-1)!=="/"&&(O+="/"),D=this.files[O]),D&&!D.dir)delete this.files[O];else for(var P=this.filter(function(T,N){return N.name.slice(0,O.length)===O}),U=0;U<P.length;U++)delete this.files[P[U].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var D,P={};try{if((P=s.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");s.checkSupport(P.type),P.platform!=="darwin"&&P.platform!=="freebsd"&&P.platform!=="linux"&&P.platform!=="sunos"||(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var U=P.comment||this.comment||"";D=o.generateWorker(this,P,U)}catch(T){(D=new d("error")).error(T)}return new p(D,P.type||"string",P.mimeType)},generateAsync:function(O,D){return this.generateInternalStream(O).accumulate(D)},generateNodeStream:function(O,D){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(D)}};e.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(i,e,f){e.exports=i("stream")},{stream:void 0}],17:[function(i,e,f){var h=i("./DataReader");function n(s){h.call(this,s);for(var d=0;d<this.data.length;d++)s[d]=255&s[d]}i("../utils").inherits(n,h),n.prototype.byteAt=function(s){return this.data[this.zero+s]},n.prototype.lastIndexOfSignature=function(s){for(var d=s.charCodeAt(0),p=s.charCodeAt(1),v=s.charCodeAt(2),b=s.charCodeAt(3),u=this.length-4;0<=u;--u)if(this.data[u]===d&&this.data[u+1]===p&&this.data[u+2]===v&&this.data[u+3]===b)return u-this.zero;return-1},n.prototype.readAndCheckSignature=function(s){var d=s.charCodeAt(0),p=s.charCodeAt(1),v=s.charCodeAt(2),b=s.charCodeAt(3),u=this.readData(4);return d===u[0]&&p===u[1]&&v===u[2]&&b===u[3]},n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},e.exports=n},{"../utils":32,"./DataReader":18}],18:[function(i,e,f){var h=i("../utils");function n(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var d,p=0;for(this.checkOffset(s),d=this.index+s-1;d>=this.index;d--)p=(p<<8)+this.byteAt(d);return this.index+=s,p},readString:function(s){return h.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},e.exports=n},{"../utils":32}],19:[function(i,e,f){var h=i("./Uint8ArrayReader");function n(s){h.call(this,s)}i("../utils").inherits(n,h),n.prototype.readData=function(s){this.checkOffset(s);var d=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},e.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(i,e,f){var h=i("./DataReader");function n(s){h.call(this,s)}i("../utils").inherits(n,h),n.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},n.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},n.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},n.prototype.readData=function(s){this.checkOffset(s);var d=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},e.exports=n},{"../utils":32,"./DataReader":18}],21:[function(i,e,f){var h=i("./ArrayReader");function n(s){h.call(this,s)}i("../utils").inherits(n,h),n.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,d},e.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(i,e,f){var h=i("../utils"),n=i("../support"),s=i("./ArrayReader"),d=i("./StringReader"),p=i("./NodeBufferReader"),v=i("./Uint8ArrayReader");e.exports=function(b){var u=h.getTypeOf(b);return h.checkSupport(u),u!=="string"||n.uint8array?u==="nodebuffer"?new p(b):n.uint8array?new v(h.transformTo("uint8array",b)):new s(h.transformTo("array",b)):new d(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(i,e,f){f.LOCAL_FILE_HEADER="PK",f.CENTRAL_FILE_HEADER="PK",f.CENTRAL_DIRECTORY_END="PK",f.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",f.ZIP64_CENTRAL_DIRECTORY_END="PK",f.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(i,e,f){var h=i("./GenericWorker"),n=i("../utils");function s(d){h.call(this,"ConvertWorker to "+d),this.destType=d}n.inherits(s,h),s.prototype.processChunk=function(d){this.push({data:n.transformTo(this.destType,d.data),meta:d.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(i,e,f){var h=i("./GenericWorker"),n=i("../crc32");function s(){h.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}i("../utils").inherits(s,h),s.prototype.processChunk=function(d){this.streamInfo.crc32=n(d.data,this.streamInfo.crc32||0),this.push(d)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(i,e,f){var h=i("../utils"),n=i("./GenericWorker");function s(d){n.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}h.inherits(s,n),s.prototype.processChunk=function(d){if(d){var p=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=p+d.data.length}n.prototype.processChunk.call(this,d)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(i,e,f){var h=i("../utils"),n=i("./GenericWorker");function s(d){n.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(v){p.dataIsReady=!0,p.data=v,p.max=v&&v.length||0,p.type=h.getTypeOf(v),p.isPaused||p._tickAndRepeat()},function(v){p.error(v)})}h.inherits(s,n),s.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,h.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(h.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,p=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,p);break;case"uint8array":d=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":d=this.data.slice(this.index,p)}return this.index=p,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(i,e,f){function h(n){this.name=n||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}h.prototype={push:function(n){this.emit("data",n)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(n){this.emit("error",n)}return!0},error:function(n){return!this.isFinished&&(this.isPaused?this.generatedError=n:(this.isFinished=!0,this.emit("error",n),this.previous&&this.previous.error(n),this.cleanUp()),!0)},on:function(n,s){return this._listeners[n].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(n,s){if(this._listeners[n])for(var d=0;d<this._listeners[n].length;d++)this._listeners[n][d].call(this,s)},pipe:function(n){return n.registerPrevious(this)},registerPrevious:function(n){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=n.streamInfo,this.mergeStreamInfo(),this.previous=n;var s=this;return n.on("data",function(d){s.processChunk(d)}),n.on("end",function(){s.end()}),n.on("error",function(d){s.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var n=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),n=!0),this.previous&&this.previous.resume(),!n},flush:function(){},processChunk:function(n){this.push(n)},withStreamInfo:function(n,s){return this.extraStreamInfo[n]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var n in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,n)&&(this.streamInfo[n]=this.extraStreamInfo[n])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var n="Worker "+this.name;return this.previous?this.previous+" -> "+n:n}},e.exports=h},{}],29:[function(i,e,f){var h=i("../utils"),n=i("./ConvertWorker"),s=i("./GenericWorker"),d=i("../base64"),p=i("../support"),v=i("../external"),b=null;if(p.nodestream)try{b=i("../nodejs/NodejsStreamOutputAdapter")}catch{}function u(_,l){return new v.Promise(function(c,a){var m=[],k=_._internalType,I=_._outputType,O=_._mimeType;_.on("data",function(D,P){m.push(D),l&&l(P)}).on("error",function(D){m=[],a(D)}).on("end",function(){try{var D=function(P,U,T){switch(P){case"blob":return h.newBlob(h.transformTo("arraybuffer",U),T);case"base64":return d.encode(U);default:return h.transformTo(P,U)}}(I,function(P,U){var T,N=0,te=null,S=0;for(T=0;T<U.length;T++)S+=U[T].length;switch(P){case"string":return U.join("");case"array":return Array.prototype.concat.apply([],U);case"uint8array":for(te=new Uint8Array(S),T=0;T<U.length;T++)te.set(U[T],N),N+=U[T].length;return te;case"nodebuffer":return Buffer.concat(U);default:throw new Error("concat : unsupported type '"+P+"'")}}(k,m),O);c(D)}catch(P){a(P)}m=[]}).resume()})}function o(_,l,c){var a=l;switch(l){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=l,this._mimeType=c,h.checkSupport(a),this._worker=_.pipe(new n(a)),_.lock()}catch(m){this._worker=new s("error"),this._worker.error(m)}}o.prototype={accumulate:function(_){return u(this,_)},on:function(_,l){var c=this;return _==="data"?this._worker.on(_,function(a){l.call(c,a.data,a.meta)}):this._worker.on(_,function(){h.delay(l,arguments,c)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(h.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},_)}},e.exports=o},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(i,e,f){if(f.base64=!0,f.array=!0,f.string=!0,f.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",f.nodebuffer=typeof Buffer<"u",f.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")f.blob=!1;else{var h=new ArrayBuffer(0);try{f.blob=new Blob([h],{type:"application/zip"}).size===0}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(h),f.blob=n.getBlob("application/zip").size===0}catch{f.blob=!1}}}try{f.nodestream=!!i("readable-stream").Readable}catch{f.nodestream=!1}},{"readable-stream":16}],31:[function(i,e,f){for(var h=i("./utils"),n=i("./support"),s=i("./nodejsUtils"),d=i("./stream/GenericWorker"),p=new Array(256),v=0;v<256;v++)p[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;p[254]=p[254]=1;function b(){d.call(this,"utf-8 decode"),this.leftOver=null}function u(){d.call(this,"utf-8 encode")}f.utf8encode=function(o){return n.nodebuffer?s.newBufferFrom(o,"utf-8"):function(_){var l,c,a,m,k,I=_.length,O=0;for(m=0;m<I;m++)(64512&(c=_.charCodeAt(m)))==55296&&m+1<I&&(64512&(a=_.charCodeAt(m+1)))==56320&&(c=65536+(c-55296<<10)+(a-56320),m++),O+=c<128?1:c<2048?2:c<65536?3:4;for(l=n.uint8array?new Uint8Array(O):new Array(O),m=k=0;k<O;m++)(64512&(c=_.charCodeAt(m)))==55296&&m+1<I&&(64512&(a=_.charCodeAt(m+1)))==56320&&(c=65536+(c-55296<<10)+(a-56320),m++),c<128?l[k++]=c:(c<2048?l[k++]=192|c>>>6:(c<65536?l[k++]=224|c>>>12:(l[k++]=240|c>>>18,l[k++]=128|c>>>12&63),l[k++]=128|c>>>6&63),l[k++]=128|63&c);return l}(o)},f.utf8decode=function(o){return n.nodebuffer?h.transformTo("nodebuffer",o).toString("utf-8"):function(_){var l,c,a,m,k=_.length,I=new Array(2*k);for(l=c=0;l<k;)if((a=_[l++])<128)I[c++]=a;else if(4<(m=p[a]))I[c++]=65533,l+=m-1;else{for(a&=m===2?31:m===3?15:7;1<m&&l<k;)a=a<<6|63&_[l++],m--;1<m?I[c++]=65533:a<65536?I[c++]=a:(a-=65536,I[c++]=55296|a>>10&1023,I[c++]=56320|1023&a)}return I.length!==c&&(I.subarray?I=I.subarray(0,c):I.length=c),h.applyFromCharCode(I)}(o=h.transformTo(n.uint8array?"uint8array":"array",o))},h.inherits(b,d),b.prototype.processChunk=function(o){var _=h.transformTo(n.uint8array?"uint8array":"array",o.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var l=_;(_=new Uint8Array(l.length+this.leftOver.length)).set(this.leftOver,0),_.set(l,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var c=function(m,k){var I;for((k=k||m.length)>m.length&&(k=m.length),I=k-1;0<=I&&(192&m[I])==128;)I--;return I<0||I===0?k:I+p[m[I]]>k?I:k}(_),a=_;c!==_.length&&(n.uint8array?(a=_.subarray(0,c),this.leftOver=_.subarray(c,_.length)):(a=_.slice(0,c),this.leftOver=_.slice(c,_.length))),this.push({data:f.utf8decode(a),meta:o.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:f.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},f.Utf8DecodeWorker=b,h.inherits(u,d),u.prototype.processChunk=function(o){this.push({data:f.utf8encode(o.data),meta:o.meta})},f.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(i,e,f){var h=i("./support"),n=i("./base64"),s=i("./nodejsUtils"),d=i("./external");function p(l){return l}function v(l,c){for(var a=0;a<l.length;++a)c[a]=255&l.charCodeAt(a);return c}i("setimmediate"),f.newBlob=function(l,c){f.checkSupport("blob");try{return new Blob([l],{type:c})}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return a.append(l),a.getBlob(c)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(l,c,a){var m=[],k=0,I=l.length;if(I<=a)return String.fromCharCode.apply(null,l);for(;k<I;)c==="array"||c==="nodebuffer"?m.push(String.fromCharCode.apply(null,l.slice(k,Math.min(k+a,I)))):m.push(String.fromCharCode.apply(null,l.subarray(k,Math.min(k+a,I)))),k+=a;return m.join("")},stringifyByChar:function(l){for(var c="",a=0;a<l.length;a++)c+=String.fromCharCode(l[a]);return c},applyCanBeUsed:{uint8array:function(){try{return h.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return h.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function u(l){var c=65536,a=f.getTypeOf(l),m=!0;if(a==="uint8array"?m=b.applyCanBeUsed.uint8array:a==="nodebuffer"&&(m=b.applyCanBeUsed.nodebuffer),m)for(;1<c;)try{return b.stringifyByChunk(l,a,c)}catch{c=Math.floor(c/2)}return b.stringifyByChar(l)}function o(l,c){for(var a=0;a<l.length;a++)c[a]=l[a];return c}f.applyFromCharCode=u;var _={};_.string={string:p,array:function(l){return v(l,new Array(l.length))},arraybuffer:function(l){return _.string.uint8array(l).buffer},uint8array:function(l){return v(l,new Uint8Array(l.length))},nodebuffer:function(l){return v(l,s.allocBuffer(l.length))}},_.array={string:u,array:p,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return s.newBufferFrom(l)}},_.arraybuffer={string:function(l){return u(new Uint8Array(l))},array:function(l){return o(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:p,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return s.newBufferFrom(new Uint8Array(l))}},_.uint8array={string:u,array:function(l){return o(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:p,nodebuffer:function(l){return s.newBufferFrom(l)}},_.nodebuffer={string:u,array:function(l){return o(l,new Array(l.length))},arraybuffer:function(l){return _.nodebuffer.uint8array(l).buffer},uint8array:function(l){return o(l,new Uint8Array(l.length))},nodebuffer:p},f.transformTo=function(l,c){if(c=c||"",!l)return c;f.checkSupport(l);var a=f.getTypeOf(c);return _[a][l](c)},f.resolve=function(l){for(var c=l.split("/"),a=[],m=0;m<c.length;m++){var k=c[m];k==="."||k===""&&m!==0&&m!==c.length-1||(k===".."?a.pop():a.push(k))}return a.join("/")},f.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":h.nodebuffer&&s.isBuffer(l)?"nodebuffer":h.uint8array&&l instanceof Uint8Array?"uint8array":h.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},f.checkSupport=function(l){if(!h[l.toLowerCase()])throw new Error(l+" is not supported by this platform")},f.MAX_VALUE_16BITS=65535,f.MAX_VALUE_32BITS=-1,f.pretty=function(l){var c,a,m="";for(a=0;a<(l||"").length;a++)m+="\\x"+((c=l.charCodeAt(a))<16?"0":"")+c.toString(16).toUpperCase();return m},f.delay=function(l,c,a){setImmediate(function(){l.apply(a||null,c||[])})},f.inherits=function(l,c){function a(){}a.prototype=c.prototype,l.prototype=new a},f.extend=function(){var l,c,a={};for(l=0;l<arguments.length;l++)for(c in arguments[l])Object.prototype.hasOwnProperty.call(arguments[l],c)&&a[c]===void 0&&(a[c]=arguments[l][c]);return a},f.prepareContent=function(l,c,a,m,k){return d.Promise.resolve(c).then(function(I){return h.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new d.Promise(function(O,D){var P=new FileReader;P.onload=function(U){O(U.target.result)},P.onerror=function(U){D(U.target.error)},P.readAsArrayBuffer(I)}):I}).then(function(I){var O=f.getTypeOf(I);return O?(O==="arraybuffer"?I=f.transformTo("uint8array",I):O==="string"&&(k?I=n.decode(I):a&&m!==!0&&(I=function(D){return v(D,h.uint8array?new Uint8Array(D.length):new Array(D.length))}(I))),I):d.Promise.reject(new Error("Can't read the data of '"+l+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(i,e,f){var h=i("./reader/readerFor"),n=i("./utils"),s=i("./signature"),d=i("./zipEntry"),p=i("./support");function v(b){this.files=[],this.loadOptions=b}v.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var u=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(u)+", expected "+n.pretty(b)+")")}},isSignature:function(b,u){var o=this.reader.index;this.reader.setIndex(b);var _=this.reader.readString(4)===u;return this.reader.setIndex(o),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),u=p.uint8array?"uint8array":"array",o=n.transformTo(u,b);this.zipComment=this.loadOptions.decodeFileName(o)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,u,o,_=this.zip64EndOfCentralSize-44;0<_;)b=this.reader.readInt(2),u=this.reader.readInt(4),o=this.reader.readData(u),this.zip64ExtensibleData[b]={id:b,length:u,value:o}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,u;for(b=0;b<this.files.length;b++)u=this.files[b],this.reader.setIndex(u.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),u.readLocalPart(this.reader),u.handleUTF8(),u.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(b=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var u=b;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var o=this.centralDirOffset+this.centralDirSize;this.zip64&&(o+=20,o+=12+this.zip64EndOfCentralSize);var _=u-o;if(0<_)this.isSignature(u,s.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(b){this.reader=h(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(i,e,f){var h=i("./reader/readerFor"),n=i("./utils"),s=i("./compressedObject"),d=i("./crc32"),p=i("./utf8"),v=i("./compressions"),b=i("./support");function u(o,_){this.options=o,this.loadOptions=_}u.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(o){var _,l;if(o.skip(22),this.fileNameLength=o.readInt(2),l=o.readInt(2),this.fileName=o.readData(this.fileNameLength),o.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=function(c){for(var a in v)if(Object.prototype.hasOwnProperty.call(v,a)&&v[a].magic===c)return v[a];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,_,o.readData(this.compressedSize))},readCentralPart:function(o){this.versionMadeBy=o.readInt(2),o.skip(2),this.bitFlag=o.readInt(2),this.compressionMethod=o.readString(2),this.date=o.readDate(),this.crc32=o.readInt(4),this.compressedSize=o.readInt(4),this.uncompressedSize=o.readInt(4);var _=o.readInt(2);if(this.extraFieldsLength=o.readInt(2),this.fileCommentLength=o.readInt(2),this.diskNumberStart=o.readInt(2),this.internalFileAttributes=o.readInt(2),this.externalFileAttributes=o.readInt(4),this.localHeaderOffset=o.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");o.skip(_),this.readExtraFields(o),this.parseZIP64ExtraField(o),this.fileComment=o.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var o=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),o==0&&(this.dosPermissions=63&this.externalFileAttributes),o==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var o=h(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=o.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=o.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=o.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=o.readInt(4))}},readExtraFields:function(o){var _,l,c,a=o.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});o.index+4<a;)_=o.readInt(2),l=o.readInt(2),c=o.readData(l),this.extraFields[_]={id:_,length:l,value:c};o.setIndex(a)},handleUTF8:function(){var o=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=p.utf8decode(this.fileName),this.fileCommentStr=p.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var l=n.transformTo(o,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var c=this.findExtraFieldUnicodeComment();if(c!==null)this.fileCommentStr=c;else{var a=n.transformTo(o,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var o=this.extraFields[28789];if(o){var _=h(o.value);return _.readInt(1)!==1||d(this.fileName)!==_.readInt(4)?null:p.utf8decode(_.readData(o.length-5))}return null},findExtraFieldUnicodeComment:function(){var o=this.extraFields[25461];if(o){var _=h(o.value);return _.readInt(1)!==1||d(this.fileComment)!==_.readInt(4)?null:p.utf8decode(_.readData(o.length-5))}return null}},e.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(i,e,f){function h(_,l,c){this.name=_,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=l,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}}var n=i("./stream/StreamHelper"),s=i("./stream/DataWorker"),d=i("./utf8"),p=i("./compressedObject"),v=i("./stream/GenericWorker");h.prototype={internalStream:function(_){var l=null,c="string";try{if(!_)throw new Error("No output type specified.");var a=(c=_.toLowerCase())==="string"||c==="text";c!=="binarystring"&&c!=="text"||(c="string"),l=this._decompressWorker();var m=!this._dataBinary;m&&!a&&(l=l.pipe(new d.Utf8EncodeWorker)),!m&&a&&(l=l.pipe(new d.Utf8DecodeWorker))}catch(k){(l=new v("error")).error(k)}return new n(l,c,"")},async:function(_,l){return this.internalStream(_).accumulate(l)},nodeStream:function(_,l){return this.internalStream(_||"nodebuffer").toNodejsStream(l)},_compressWorker:function(_,l){if(this._data instanceof p&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var c=this._decompressWorker();return this._dataBinary||(c=c.pipe(new d.Utf8EncodeWorker)),p.createWorkerFrom(c,_,l)},_decompressWorker:function(){return this._data instanceof p?this._data.getContentWorker():this._data instanceof v?this._data:new s(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},o=0;o<b.length;o++)h.prototype[b[o]]=u;e.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(i,e,f){(function(h){var n,s,d=h.MutationObserver||h.WebKitMutationObserver;if(d){var p=0,v=new d(_),b=h.document.createTextNode("");v.observe(b,{characterData:!0}),n=function(){b.data=p=++p%2}}else if(h.setImmediate||h.MessageChannel===void 0)n="document"in h&&"onreadystatechange"in h.document.createElement("script")?function(){var l=h.document.createElement("script");l.onreadystatechange=function(){_(),l.onreadystatechange=null,l.parentNode.removeChild(l),l=null},h.document.documentElement.appendChild(l)}:function(){setTimeout(_,0)};else{var u=new h.MessageChannel;u.port1.onmessage=_,n=function(){u.port2.postMessage(0)}}var o=[];function _(){var l,c;s=!0;for(var a=o.length;a;){for(c=o,o=[],l=-1;++l<a;)c[l]();a=o.length}s=!1}e.exports=function(l){o.push(l)!==1||s||n()}}).call(this,typeof Re<"u"?Re:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(i,e,f){var h=i("immediate");function n(){}var s={},d=["REJECTED"],p=["FULFILLED"],v=["PENDING"];function b(a){if(typeof a!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,a!==n&&l(this,a)}function u(a,m,k){this.promise=a,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function o(a,m,k){h(function(){var I;try{I=m(k)}catch(O){return s.reject(a,O)}I===a?s.reject(a,new TypeError("Cannot resolve promise with itself")):s.resolve(a,I)})}function _(a){var m=a&&a.then;if(a&&(typeof a=="object"||typeof a=="function")&&typeof m=="function")return function(){m.apply(a,arguments)}}function l(a,m){var k=!1;function I(P){k||(k=!0,s.reject(a,P))}function O(P){k||(k=!0,s.resolve(a,P))}var D=c(function(){m(O,I)});D.status==="error"&&I(D.value)}function c(a,m){var k={};try{k.value=a(m),k.status="success"}catch(I){k.status="error",k.value=I}return k}(e.exports=b).prototype.finally=function(a){if(typeof a!="function")return this;var m=this.constructor;return this.then(function(k){return m.resolve(a()).then(function(){return k})},function(k){return m.resolve(a()).then(function(){throw k})})},b.prototype.catch=function(a){return this.then(null,a)},b.prototype.then=function(a,m){if(typeof a!="function"&&this.state===p||typeof m!="function"&&this.state===d)return this;var k=new this.constructor(n);return this.state!==v?o(k,this.state===p?a:m,this.outcome):this.queue.push(new u(k,a,m)),k},u.prototype.callFulfilled=function(a){s.resolve(this.promise,a)},u.prototype.otherCallFulfilled=function(a){o(this.promise,this.onFulfilled,a)},u.prototype.callRejected=function(a){s.reject(this.promise,a)},u.prototype.otherCallRejected=function(a){o(this.promise,this.onRejected,a)},s.resolve=function(a,m){var k=c(_,m);if(k.status==="error")return s.reject(a,k.value);var I=k.value;if(I)l(a,I);else{a.state=p,a.outcome=m;for(var O=-1,D=a.queue.length;++O<D;)a.queue[O].callFulfilled(m)}return a},s.reject=function(a,m){a.state=d,a.outcome=m;for(var k=-1,I=a.queue.length;++k<I;)a.queue[k].callRejected(m);return a},b.resolve=function(a){return a instanceof this?a:s.resolve(new this(n),a)},b.reject=function(a){var m=new this(n);return s.reject(m,a)},b.all=function(a){var m=this;if(Object.prototype.toString.call(a)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=a.length,I=!1;if(!k)return this.resolve([]);for(var O=new Array(k),D=0,P=-1,U=new this(n);++P<k;)T(a[P],P);return U;function T(N,te){m.resolve(N).then(function(S){O[te]=S,++D!==k||I||(I=!0,s.resolve(U,O))},function(S){I||(I=!0,s.reject(U,S))})}},b.race=function(a){var m=this;if(Object.prototype.toString.call(a)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=a.length,I=!1;if(!k)return this.resolve([]);for(var O=-1,D=new this(n);++O<k;)P=a[O],m.resolve(P).then(function(U){I||(I=!0,s.resolve(D,U))},function(U){I||(I=!0,s.reject(D,U))});var P;return D}},{immediate:36}],38:[function(i,e,f){var h={};(0,i("./lib/utils/common").assign)(h,i("./lib/deflate"),i("./lib/inflate"),i("./lib/zlib/constants")),e.exports=h},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(i,e,f){var h=i("./zlib/deflate"),n=i("./utils/common"),s=i("./utils/strings"),d=i("./zlib/messages"),p=i("./zlib/zstream"),v=Object.prototype.toString,b=0,u=-1,o=0,_=8;function l(a){if(!(this instanceof l))return new l(a);this.options=n.assign({level:u,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:o,to:""},a||{});var m=this.options;m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var k=h.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(k!==b)throw new Error(d[k]);if(m.header&&h.deflateSetHeader(this.strm,m.header),m.dictionary){var I;if(I=typeof m.dictionary=="string"?s.string2buf(m.dictionary):v.call(m.dictionary)==="[object ArrayBuffer]"?new Uint8Array(m.dictionary):m.dictionary,(k=h.deflateSetDictionary(this.strm,I))!==b)throw new Error(d[k]);this._dict_set=!0}}function c(a,m){var k=new l(m);if(k.push(a,!0),k.err)throw k.msg||d[k.err];return k.result}l.prototype.push=function(a,m){var k,I,O=this.strm,D=this.options.chunkSize;if(this.ended)return!1;I=m===~~m?m:m===!0?4:0,typeof a=="string"?O.input=s.string2buf(a):v.call(a)==="[object ArrayBuffer]"?O.input=new Uint8Array(a):O.input=a,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new n.Buf8(D),O.next_out=0,O.avail_out=D),(k=h.deflate(O,I))!==1&&k!==b)return this.onEnd(k),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(n.shrinkBuf(O.output,O.next_out))):this.onData(n.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&k!==1);return I===4?(k=h.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===b):I!==2||(this.onEnd(b),!(O.avail_out=0))},l.prototype.onData=function(a){this.chunks.push(a)},l.prototype.onEnd=function(a){a===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},f.Deflate=l,f.deflate=c,f.deflateRaw=function(a,m){return(m=m||{}).raw=!0,c(a,m)},f.gzip=function(a,m){return(m=m||{}).gzip=!0,c(a,m)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(i,e,f){var h=i("./zlib/inflate"),n=i("./utils/common"),s=i("./utils/strings"),d=i("./zlib/constants"),p=i("./zlib/messages"),v=i("./zlib/zstream"),b=i("./zlib/gzheader"),u=Object.prototype.toString;function o(l){if(!(this instanceof o))return new o(l);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},l||{});var c=this.options;c.raw&&0<=c.windowBits&&c.windowBits<16&&(c.windowBits=-c.windowBits,c.windowBits===0&&(c.windowBits=-15)),!(0<=c.windowBits&&c.windowBits<16)||l&&l.windowBits||(c.windowBits+=32),15<c.windowBits&&c.windowBits<48&&!(15&c.windowBits)&&(c.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var a=h.inflateInit2(this.strm,c.windowBits);if(a!==d.Z_OK)throw new Error(p[a]);this.header=new b,h.inflateGetHeader(this.strm,this.header)}function _(l,c){var a=new o(c);if(a.push(l,!0),a.err)throw a.msg||p[a.err];return a.result}o.prototype.push=function(l,c){var a,m,k,I,O,D,P=this.strm,U=this.options.chunkSize,T=this.options.dictionary,N=!1;if(this.ended)return!1;m=c===~~c?c:c===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof l=="string"?P.input=s.binstring2buf(l):u.call(l)==="[object ArrayBuffer]"?P.input=new Uint8Array(l):P.input=l,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new n.Buf8(U),P.next_out=0,P.avail_out=U),(a=h.inflate(P,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&T&&(D=typeof T=="string"?s.string2buf(T):u.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,a=h.inflateSetDictionary(this.strm,D)),a===d.Z_BUF_ERROR&&N===!0&&(a=d.Z_OK,N=!1),a!==d.Z_STREAM_END&&a!==d.Z_OK)return this.onEnd(a),!(this.ended=!0);P.next_out&&(P.avail_out!==0&&a!==d.Z_STREAM_END&&(P.avail_in!==0||m!==d.Z_FINISH&&m!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=s.utf8border(P.output,P.next_out),I=P.next_out-k,O=s.buf2string(P.output,k),P.next_out=I,P.avail_out=U-I,I&&n.arraySet(P.output,P.output,k,I,0),this.onData(O)):this.onData(n.shrinkBuf(P.output,P.next_out)))),P.avail_in===0&&P.avail_out===0&&(N=!0)}while((0<P.avail_in||P.avail_out===0)&&a!==d.Z_STREAM_END);return a===d.Z_STREAM_END&&(m=d.Z_FINISH),m===d.Z_FINISH?(a=h.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===d.Z_OK):m!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(P.avail_out=0))},o.prototype.onData=function(l){this.chunks.push(l)},o.prototype.onEnd=function(l){l===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg},f.Inflate=o,f.inflate=_,f.inflateRaw=function(l,c){return(c=c||{}).raw=!0,_(l,c)},f.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(i,e,f){var h=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";f.assign=function(d){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var v=p.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var b in v)v.hasOwnProperty(b)&&(d[b]=v[b])}}return d},f.shrinkBuf=function(d,p){return d.length===p?d:d.subarray?d.subarray(0,p):(d.length=p,d)};var n={arraySet:function(d,p,v,b,u){if(p.subarray&&d.subarray)d.set(p.subarray(v,v+b),u);else for(var o=0;o<b;o++)d[u+o]=p[v+o]},flattenChunks:function(d){var p,v,b,u,o,_;for(p=b=0,v=d.length;p<v;p++)b+=d[p].length;for(_=new Uint8Array(b),p=u=0,v=d.length;p<v;p++)o=d[p],_.set(o,u),u+=o.length;return _}},s={arraySet:function(d,p,v,b,u){for(var o=0;o<b;o++)d[u+o]=p[v+o]},flattenChunks:function(d){return[].concat.apply([],d)}};f.setTyped=function(d){d?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,n)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,s))},f.setTyped(h)},{}],42:[function(i,e,f){var h=i("./common"),n=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var d=new h.Buf8(256),p=0;p<256;p++)d[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;function v(b,u){if(u<65537&&(b.subarray&&s||!b.subarray&&n))return String.fromCharCode.apply(null,h.shrinkBuf(b,u));for(var o="",_=0;_<u;_++)o+=String.fromCharCode(b[_]);return o}d[254]=d[254]=1,f.string2buf=function(b){var u,o,_,l,c,a=b.length,m=0;for(l=0;l<a;l++)(64512&(o=b.charCodeAt(l)))==55296&&l+1<a&&(64512&(_=b.charCodeAt(l+1)))==56320&&(o=65536+(o-55296<<10)+(_-56320),l++),m+=o<128?1:o<2048?2:o<65536?3:4;for(u=new h.Buf8(m),l=c=0;c<m;l++)(64512&(o=b.charCodeAt(l)))==55296&&l+1<a&&(64512&(_=b.charCodeAt(l+1)))==56320&&(o=65536+(o-55296<<10)+(_-56320),l++),o<128?u[c++]=o:(o<2048?u[c++]=192|o>>>6:(o<65536?u[c++]=224|o>>>12:(u[c++]=240|o>>>18,u[c++]=128|o>>>12&63),u[c++]=128|o>>>6&63),u[c++]=128|63&o);return u},f.buf2binstring=function(b){return v(b,b.length)},f.binstring2buf=function(b){for(var u=new h.Buf8(b.length),o=0,_=u.length;o<_;o++)u[o]=b.charCodeAt(o);return u},f.buf2string=function(b,u){var o,_,l,c,a=u||b.length,m=new Array(2*a);for(o=_=0;o<a;)if((l=b[o++])<128)m[_++]=l;else if(4<(c=d[l]))m[_++]=65533,o+=c-1;else{for(l&=c===2?31:c===3?15:7;1<c&&o<a;)l=l<<6|63&b[o++],c--;1<c?m[_++]=65533:l<65536?m[_++]=l:(l-=65536,m[_++]=55296|l>>10&1023,m[_++]=56320|1023&l)}return v(m,_)},f.utf8border=function(b,u){var o;for((u=u||b.length)>b.length&&(u=b.length),o=u-1;0<=o&&(192&b[o])==128;)o--;return o<0||o===0?u:o+d[b[o]]>u?o:u}},{"./common":41}],43:[function(i,e,f){e.exports=function(h,n,s,d){for(var p=65535&h|0,v=h>>>16&65535|0,b=0;s!==0;){for(s-=b=2e3<s?2e3:s;v=v+(p=p+n[d++]|0)|0,--b;);p%=65521,v%=65521}return p|v<<16|0}},{}],44:[function(i,e,f){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(i,e,f){var h=function(){for(var n,s=[],d=0;d<256;d++){n=d;for(var p=0;p<8;p++)n=1&n?3988292384^n>>>1:n>>>1;s[d]=n}return s}();e.exports=function(n,s,d,p){var v=h,b=p+d;n^=-1;for(var u=p;u<b;u++)n=n>>>8^v[255&(n^s[u])];return-1^n}},{}],46:[function(i,e,f){var h,n=i("../utils/common"),s=i("./trees"),d=i("./adler32"),p=i("./crc32"),v=i("./messages"),b=0,u=4,o=0,_=-2,l=-1,c=4,a=2,m=8,k=9,I=286,O=30,D=19,P=2*I+1,U=15,T=3,N=258,te=N+T+1,S=42,B=113,r=1,j=2,se=3,G=4;function ae(t,F){return t.msg=v[F],F}function L(t){return(t<<1)-(4<t?9:0)}function Q(t){for(var F=t.length;0<=--F;)t[F]=0}function A(t){var F=t.state,R=F.pending;R>t.avail_out&&(R=t.avail_out),R!==0&&(n.arraySet(t.output,F.pending_buf,F.pending_out,R,t.next_out),t.next_out+=R,F.pending_out+=R,t.total_out+=R,t.avail_out-=R,F.pending-=R,F.pending===0&&(F.pending_out=0))}function C(t,F){s._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,F),t.block_start=t.strstart,A(t.strm)}function q(t,F){t.pending_buf[t.pending++]=F}function $(t,F){t.pending_buf[t.pending++]=F>>>8&255,t.pending_buf[t.pending++]=255&F}function W(t,F){var R,y,g=t.max_chain_length,E=t.strstart,V=t.prev_length,H=t.nice_match,x=t.strstart>t.w_size-te?t.strstart-(t.w_size-te):0,Z=t.window,K=t.w_mask,Y=t.prev,oe=t.strstart+N,me=Z[E+V-1],he=Z[E+V];t.prev_length>=t.good_match&&(g>>=2),H>t.lookahead&&(H=t.lookahead);do if(Z[(R=F)+V]===he&&Z[R+V-1]===me&&Z[R]===Z[E]&&Z[++R]===Z[E+1]){E+=2,R++;do;while(Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&Z[++E]===Z[++R]&&E<oe);if(y=N-(oe-E),E=oe-N,V<y){if(t.match_start=F,H<=(V=y))break;me=Z[E+V-1],he=Z[E+V]}}while((F=Y[F&K])>x&&--g!=0);return V<=t.lookahead?V:t.lookahead}function le(t){var F,R,y,g,E,V,H,x,Z,K,Y=t.w_size;do{if(g=t.window_size-t.lookahead-t.strstart,t.strstart>=Y+(Y-te)){for(n.arraySet(t.window,t.window,Y,Y,0),t.match_start-=Y,t.strstart-=Y,t.block_start-=Y,F=R=t.hash_size;y=t.head[--F],t.head[F]=Y<=y?y-Y:0,--R;);for(F=R=Y;y=t.prev[--F],t.prev[F]=Y<=y?y-Y:0,--R;);g+=Y}if(t.strm.avail_in===0)break;if(V=t.strm,H=t.window,x=t.strstart+t.lookahead,Z=g,K=void 0,K=V.avail_in,Z<K&&(K=Z),R=K===0?0:(V.avail_in-=K,n.arraySet(H,V.input,V.next_in,K,x),V.state.wrap===1?V.adler=d(V.adler,H,K,x):V.state.wrap===2&&(V.adler=p(V.adler,H,K,x)),V.next_in+=K,V.total_in+=K,K),t.lookahead+=R,t.lookahead+t.insert>=T)for(E=t.strstart-t.insert,t.ins_h=t.window[E],t.ins_h=(t.ins_h<<t.hash_shift^t.window[E+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[E+T-1])&t.hash_mask,t.prev[E&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=E,E++,t.insert--,!(t.lookahead+t.insert<T)););}while(t.lookahead<te&&t.strm.avail_in!==0)}function pe(t,F){for(var R,y;;){if(t.lookahead<te){if(le(t),t.lookahead<te&&F===b)return r;if(t.lookahead===0)break}if(R=0,t.lookahead>=T&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+T-1])&t.hash_mask,R=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),R!==0&&t.strstart-R<=t.w_size-te&&(t.match_length=W(t,R)),t.match_length>=T)if(y=s._tr_tally(t,t.strstart-t.match_start,t.match_length-T),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=T){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+T-1])&t.hash_mask,R=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else y=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(y&&(C(t,!1),t.strm.avail_out===0))return r}return t.insert=t.strstart<T-1?t.strstart:T-1,F===u?(C(t,!0),t.strm.avail_out===0?se:G):t.last_lit&&(C(t,!1),t.strm.avail_out===0)?r:j}function ce(t,F){for(var R,y,g;;){if(t.lookahead<te){if(le(t),t.lookahead<te&&F===b)return r;if(t.lookahead===0)break}if(R=0,t.lookahead>=T&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+T-1])&t.hash_mask,R=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=T-1,R!==0&&t.prev_length<t.max_lazy_match&&t.strstart-R<=t.w_size-te&&(t.match_length=W(t,R),t.match_length<=5&&(t.strategy===1||t.match_length===T&&4096<t.strstart-t.match_start)&&(t.match_length=T-1)),t.prev_length>=T&&t.match_length<=t.prev_length){for(g=t.strstart+t.lookahead-T,y=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-T),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=g&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+T-1])&t.hash_mask,R=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=T-1,t.strstart++,y&&(C(t,!1),t.strm.avail_out===0))return r}else if(t.match_available){if((y=s._tr_tally(t,0,t.window[t.strstart-1]))&&C(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return r}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(y=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<T-1?t.strstart:T-1,F===u?(C(t,!0),t.strm.avail_out===0?se:G):t.last_lit&&(C(t,!1),t.strm.avail_out===0)?r:j}function fe(t,F,R,y,g){this.good_length=t,this.max_lazy=F,this.nice_length=R,this.max_chain=y,this.func=g}function we(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*P),this.dyn_dtree=new n.Buf16(2*(2*O+1)),this.bl_tree=new n.Buf16(2*(2*D+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*I+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*I+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _e(t){var F;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=a,(F=t.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?S:B,t.adler=F.wrap===2?0:1,F.last_flush=b,s._tr_init(F),o):ae(t,_)}function Me(t){var F=_e(t);return F===o&&function(R){R.window_size=2*R.w_size,Q(R.head),R.max_lazy_match=h[R.level].max_lazy,R.good_match=h[R.level].good_length,R.nice_match=h[R.level].nice_length,R.max_chain_length=h[R.level].max_chain,R.strstart=0,R.block_start=0,R.lookahead=0,R.insert=0,R.match_length=R.prev_length=T-1,R.match_available=0,R.ins_h=0}(t.state),F}function Ce(t,F,R,y,g,E){if(!t)return _;var V=1;if(F===l&&(F=6),y<0?(V=0,y=-y):15<y&&(V=2,y-=16),g<1||k<g||R!==m||y<8||15<y||F<0||9<F||E<0||c<E)return ae(t,_);y===8&&(y=9);var H=new we;return(t.state=H).strm=t,H.wrap=V,H.gzhead=null,H.w_bits=y,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=g+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+T-1)/T),H.window=new n.Buf8(2*H.w_size),H.head=new n.Buf16(H.hash_size),H.prev=new n.Buf16(H.w_size),H.lit_bufsize=1<<g+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new n.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=F,H.strategy=E,H.method=R,Me(t)}h=[new fe(0,0,0,0,function(t,F){var R=65535;for(R>t.pending_buf_size-5&&(R=t.pending_buf_size-5);;){if(t.lookahead<=1){if(le(t),t.lookahead===0&&F===b)return r;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var y=t.block_start+R;if((t.strstart===0||t.strstart>=y)&&(t.lookahead=t.strstart-y,t.strstart=y,C(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-te&&(C(t,!1),t.strm.avail_out===0))return r}return t.insert=0,F===u?(C(t,!0),t.strm.avail_out===0?se:G):(t.strstart>t.block_start&&(C(t,!1),t.strm.avail_out),r)}),new fe(4,4,8,4,pe),new fe(4,5,16,8,pe),new fe(4,6,32,32,pe),new fe(4,4,16,16,ce),new fe(8,16,32,32,ce),new fe(8,16,128,128,ce),new fe(8,32,128,256,ce),new fe(32,128,258,1024,ce),new fe(32,258,258,4096,ce)],f.deflateInit=function(t,F){return Ce(t,F,m,15,8,0)},f.deflateInit2=Ce,f.deflateReset=Me,f.deflateResetKeep=_e,f.deflateSetHeader=function(t,F){return t&&t.state?t.state.wrap!==2?_:(t.state.gzhead=F,o):_},f.deflate=function(t,F){var R,y,g,E;if(!t||!t.state||5<F||F<0)return t?ae(t,_):_;if(y=t.state,!t.output||!t.input&&t.avail_in!==0||y.status===666&&F!==u)return ae(t,t.avail_out===0?-5:_);if(y.strm=t,R=y.last_flush,y.last_flush=F,y.status===S)if(y.wrap===2)t.adler=0,q(y,31),q(y,139),q(y,8),y.gzhead?(q(y,(y.gzhead.text?1:0)+(y.gzhead.hcrc?2:0)+(y.gzhead.extra?4:0)+(y.gzhead.name?8:0)+(y.gzhead.comment?16:0)),q(y,255&y.gzhead.time),q(y,y.gzhead.time>>8&255),q(y,y.gzhead.time>>16&255),q(y,y.gzhead.time>>24&255),q(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),q(y,255&y.gzhead.os),y.gzhead.extra&&y.gzhead.extra.length&&(q(y,255&y.gzhead.extra.length),q(y,y.gzhead.extra.length>>8&255)),y.gzhead.hcrc&&(t.adler=p(t.adler,y.pending_buf,y.pending,0)),y.gzindex=0,y.status=69):(q(y,0),q(y,0),q(y,0),q(y,0),q(y,0),q(y,y.level===9?2:2<=y.strategy||y.level<2?4:0),q(y,3),y.status=B);else{var V=m+(y.w_bits-8<<4)<<8;V|=(2<=y.strategy||y.level<2?0:y.level<6?1:y.level===6?2:3)<<6,y.strstart!==0&&(V|=32),V+=31-V%31,y.status=B,$(y,V),y.strstart!==0&&($(y,t.adler>>>16),$(y,65535&t.adler)),t.adler=1}if(y.status===69)if(y.gzhead.extra){for(g=y.pending;y.gzindex<(65535&y.gzhead.extra.length)&&(y.pending!==y.pending_buf_size||(y.gzhead.hcrc&&y.pending>g&&(t.adler=p(t.adler,y.pending_buf,y.pending-g,g)),A(t),g=y.pending,y.pending!==y.pending_buf_size));)q(y,255&y.gzhead.extra[y.gzindex]),y.gzindex++;y.gzhead.hcrc&&y.pending>g&&(t.adler=p(t.adler,y.pending_buf,y.pending-g,g)),y.gzindex===y.gzhead.extra.length&&(y.gzindex=0,y.status=73)}else y.status=73;if(y.status===73)if(y.gzhead.name){g=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>g&&(t.adler=p(t.adler,y.pending_buf,y.pending-g,g)),A(t),g=y.pending,y.pending===y.pending_buf_size)){E=1;break}E=y.gzindex<y.gzhead.name.length?255&y.gzhead.name.charCodeAt(y.gzindex++):0,q(y,E)}while(E!==0);y.gzhead.hcrc&&y.pending>g&&(t.adler=p(t.adler,y.pending_buf,y.pending-g,g)),E===0&&(y.gzindex=0,y.status=91)}else y.status=91;if(y.status===91)if(y.gzhead.comment){g=y.pending;do{if(y.pending===y.pending_buf_size&&(y.gzhead.hcrc&&y.pending>g&&(t.adler=p(t.adler,y.pending_buf,y.pending-g,g)),A(t),g=y.pending,y.pending===y.pending_buf_size)){E=1;break}E=y.gzindex<y.gzhead.comment.length?255&y.gzhead.comment.charCodeAt(y.gzindex++):0,q(y,E)}while(E!==0);y.gzhead.hcrc&&y.pending>g&&(t.adler=p(t.adler,y.pending_buf,y.pending-g,g)),E===0&&(y.status=103)}else y.status=103;if(y.status===103&&(y.gzhead.hcrc?(y.pending+2>y.pending_buf_size&&A(t),y.pending+2<=y.pending_buf_size&&(q(y,255&t.adler),q(y,t.adler>>8&255),t.adler=0,y.status=B)):y.status=B),y.pending!==0){if(A(t),t.avail_out===0)return y.last_flush=-1,o}else if(t.avail_in===0&&L(F)<=L(R)&&F!==u)return ae(t,-5);if(y.status===666&&t.avail_in!==0)return ae(t,-5);if(t.avail_in!==0||y.lookahead!==0||F!==b&&y.status!==666){var H=y.strategy===2?function(x,Z){for(var K;;){if(x.lookahead===0&&(le(x),x.lookahead===0)){if(Z===b)return r;break}if(x.match_length=0,K=s._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++,K&&(C(x,!1),x.strm.avail_out===0))return r}return x.insert=0,Z===u?(C(x,!0),x.strm.avail_out===0?se:G):x.last_lit&&(C(x,!1),x.strm.avail_out===0)?r:j}(y,F):y.strategy===3?function(x,Z){for(var K,Y,oe,me,he=x.window;;){if(x.lookahead<=N){if(le(x),x.lookahead<=N&&Z===b)return r;if(x.lookahead===0)break}if(x.match_length=0,x.lookahead>=T&&0<x.strstart&&(Y=he[oe=x.strstart-1])===he[++oe]&&Y===he[++oe]&&Y===he[++oe]){me=x.strstart+N;do;while(Y===he[++oe]&&Y===he[++oe]&&Y===he[++oe]&&Y===he[++oe]&&Y===he[++oe]&&Y===he[++oe]&&Y===he[++oe]&&Y===he[++oe]&&oe<me);x.match_length=N-(me-oe),x.match_length>x.lookahead&&(x.match_length=x.lookahead)}if(x.match_length>=T?(K=s._tr_tally(x,1,x.match_length-T),x.lookahead-=x.match_length,x.strstart+=x.match_length,x.match_length=0):(K=s._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++),K&&(C(x,!1),x.strm.avail_out===0))return r}return x.insert=0,Z===u?(C(x,!0),x.strm.avail_out===0?se:G):x.last_lit&&(C(x,!1),x.strm.avail_out===0)?r:j}(y,F):h[y.level].func(y,F);if(H!==se&&H!==G||(y.status=666),H===r||H===se)return t.avail_out===0&&(y.last_flush=-1),o;if(H===j&&(F===1?s._tr_align(y):F!==5&&(s._tr_stored_block(y,0,0,!1),F===3&&(Q(y.head),y.lookahead===0&&(y.strstart=0,y.block_start=0,y.insert=0))),A(t),t.avail_out===0))return y.last_flush=-1,o}return F!==u?o:y.wrap<=0?1:(y.wrap===2?(q(y,255&t.adler),q(y,t.adler>>8&255),q(y,t.adler>>16&255),q(y,t.adler>>24&255),q(y,255&t.total_in),q(y,t.total_in>>8&255),q(y,t.total_in>>16&255),q(y,t.total_in>>24&255)):($(y,t.adler>>>16),$(y,65535&t.adler)),A(t),0<y.wrap&&(y.wrap=-y.wrap),y.pending!==0?o:1)},f.deflateEnd=function(t){var F;return t&&t.state?(F=t.state.status)!==S&&F!==69&&F!==73&&F!==91&&F!==103&&F!==B&&F!==666?ae(t,_):(t.state=null,F===B?ae(t,-3):o):_},f.deflateSetDictionary=function(t,F){var R,y,g,E,V,H,x,Z,K=F.length;if(!t||!t.state||(E=(R=t.state).wrap)===2||E===1&&R.status!==S||R.lookahead)return _;for(E===1&&(t.adler=d(t.adler,F,K,0)),R.wrap=0,K>=R.w_size&&(E===0&&(Q(R.head),R.strstart=0,R.block_start=0,R.insert=0),Z=new n.Buf8(R.w_size),n.arraySet(Z,F,K-R.w_size,R.w_size,0),F=Z,K=R.w_size),V=t.avail_in,H=t.next_in,x=t.input,t.avail_in=K,t.next_in=0,t.input=F,le(R);R.lookahead>=T;){for(y=R.strstart,g=R.lookahead-(T-1);R.ins_h=(R.ins_h<<R.hash_shift^R.window[y+T-1])&R.hash_mask,R.prev[y&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=y,y++,--g;);R.strstart=y,R.lookahead=T-1,le(R)}return R.strstart+=R.lookahead,R.block_start=R.strstart,R.insert=R.lookahead,R.lookahead=0,R.match_length=R.prev_length=T-1,R.match_available=0,t.next_in=H,t.input=x,t.avail_in=V,R.wrap=E,o},f.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(i,e,f){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(i,e,f){e.exports=function(h,n){var s,d,p,v,b,u,o,_,l,c,a,m,k,I,O,D,P,U,T,N,te,S,B,r,j;s=h.state,d=h.next_in,r=h.input,p=d+(h.avail_in-5),v=h.next_out,j=h.output,b=v-(n-h.avail_out),u=v+(h.avail_out-257),o=s.dmax,_=s.wsize,l=s.whave,c=s.wnext,a=s.window,m=s.hold,k=s.bits,I=s.lencode,O=s.distcode,D=(1<<s.lenbits)-1,P=(1<<s.distbits)-1;e:do{k<15&&(m+=r[d++]<<k,k+=8,m+=r[d++]<<k,k+=8),U=I[m&D];t:for(;;){if(m>>>=T=U>>>24,k-=T,(T=U>>>16&255)===0)j[v++]=65535&U;else{if(!(16&T)){if(!(64&T)){U=I[(65535&U)+(m&(1<<T)-1)];continue t}if(32&T){s.mode=12;break e}h.msg="invalid literal/length code",s.mode=30;break e}N=65535&U,(T&=15)&&(k<T&&(m+=r[d++]<<k,k+=8),N+=m&(1<<T)-1,m>>>=T,k-=T),k<15&&(m+=r[d++]<<k,k+=8,m+=r[d++]<<k,k+=8),U=O[m&P];n:for(;;){if(m>>>=T=U>>>24,k-=T,!(16&(T=U>>>16&255))){if(!(64&T)){U=O[(65535&U)+(m&(1<<T)-1)];continue n}h.msg="invalid distance code",s.mode=30;break e}if(te=65535&U,k<(T&=15)&&(m+=r[d++]<<k,(k+=8)<T&&(m+=r[d++]<<k,k+=8)),o<(te+=m&(1<<T)-1)){h.msg="invalid distance too far back",s.mode=30;break e}if(m>>>=T,k-=T,(T=v-b)<te){if(l<(T=te-T)&&s.sane){h.msg="invalid distance too far back",s.mode=30;break e}if(B=a,(S=0)===c){if(S+=_-T,T<N){for(N-=T;j[v++]=a[S++],--T;);S=v-te,B=j}}else if(c<T){if(S+=_+c-T,(T-=c)<N){for(N-=T;j[v++]=a[S++],--T;);if(S=0,c<N){for(N-=T=c;j[v++]=a[S++],--T;);S=v-te,B=j}}}else if(S+=c-T,T<N){for(N-=T;j[v++]=a[S++],--T;);S=v-te,B=j}for(;2<N;)j[v++]=B[S++],j[v++]=B[S++],j[v++]=B[S++],N-=3;N&&(j[v++]=B[S++],1<N&&(j[v++]=B[S++]))}else{for(S=v-te;j[v++]=j[S++],j[v++]=j[S++],j[v++]=j[S++],2<(N-=3););N&&(j[v++]=j[S++],1<N&&(j[v++]=j[S++]))}break}}break}}while(d<p&&v<u);d-=N=k>>3,m&=(1<<(k-=N<<3))-1,h.next_in=d,h.next_out=v,h.avail_in=d<p?p-d+5:5-(d-p),h.avail_out=v<u?u-v+257:257-(v-u),s.hold=m,s.bits=k}},{}],49:[function(i,e,f){var h=i("../utils/common"),n=i("./adler32"),s=i("./crc32"),d=i("./inffast"),p=i("./inftrees"),v=1,b=2,u=0,o=-2,_=1,l=852,c=592;function a(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new h.Buf16(320),this.work=new h.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(S){var B;return S&&S.state?(B=S.state,S.total_in=S.total_out=B.total=0,S.msg="",B.wrap&&(S.adler=1&B.wrap),B.mode=_,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new h.Buf32(l),B.distcode=B.distdyn=new h.Buf32(c),B.sane=1,B.back=-1,u):o}function I(S){var B;return S&&S.state?((B=S.state).wsize=0,B.whave=0,B.wnext=0,k(S)):o}function O(S,B){var r,j;return S&&S.state?(j=S.state,B<0?(r=0,B=-B):(r=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?o:(j.window!==null&&j.wbits!==B&&(j.window=null),j.wrap=r,j.wbits=B,I(S))):o}function D(S,B){var r,j;return S?(j=new m,(S.state=j).window=null,(r=O(S,B))!==u&&(S.state=null),r):o}var P,U,T=!0;function N(S){if(T){var B;for(P=new h.Buf32(512),U=new h.Buf32(32),B=0;B<144;)S.lens[B++]=8;for(;B<256;)S.lens[B++]=9;for(;B<280;)S.lens[B++]=7;for(;B<288;)S.lens[B++]=8;for(p(v,S.lens,0,288,P,0,S.work,{bits:9}),B=0;B<32;)S.lens[B++]=5;p(b,S.lens,0,32,U,0,S.work,{bits:5}),T=!1}S.lencode=P,S.lenbits=9,S.distcode=U,S.distbits=5}function te(S,B,r,j){var se,G=S.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new h.Buf8(G.wsize)),j>=G.wsize?(h.arraySet(G.window,B,r-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(j<(se=G.wsize-G.wnext)&&(se=j),h.arraySet(G.window,B,r-j,se,G.wnext),(j-=se)?(h.arraySet(G.window,B,r-j,j,0),G.wnext=j,G.whave=G.wsize):(G.wnext+=se,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=se))),0}f.inflateReset=I,f.inflateReset2=O,f.inflateResetKeep=k,f.inflateInit=function(S){return D(S,15)},f.inflateInit2=D,f.inflate=function(S,B){var r,j,se,G,ae,L,Q,A,C,q,$,W,le,pe,ce,fe,we,_e,Me,Ce,t,F,R,y,g=0,E=new h.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return o;(r=S.state).mode===12&&(r.mode=13),ae=S.next_out,se=S.output,Q=S.avail_out,G=S.next_in,j=S.input,L=S.avail_in,A=r.hold,C=r.bits,q=L,$=Q,F=u;e:for(;;)switch(r.mode){case _:if(r.wrap===0){r.mode=13;break}for(;C<16;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(2&r.wrap&&A===35615){E[r.check=0]=255&A,E[1]=A>>>8&255,r.check=s(r.check,E,2,0),C=A=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&A)<<8)+(A>>8))%31){S.msg="incorrect header check",r.mode=30;break}if((15&A)!=8){S.msg="unknown compression method",r.mode=30;break}if(C-=4,t=8+(15&(A>>>=4)),r.wbits===0)r.wbits=t;else if(t>r.wbits){S.msg="invalid window size",r.mode=30;break}r.dmax=1<<t,S.adler=r.check=1,r.mode=512&A?10:12,C=A=0;break;case 2:for(;C<16;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(r.flags=A,(255&r.flags)!=8){S.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){S.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=A>>8&1),512&r.flags&&(E[0]=255&A,E[1]=A>>>8&255,r.check=s(r.check,E,2,0)),C=A=0,r.mode=3;case 3:for(;C<32;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}r.head&&(r.head.time=A),512&r.flags&&(E[0]=255&A,E[1]=A>>>8&255,E[2]=A>>>16&255,E[3]=A>>>24&255,r.check=s(r.check,E,4,0)),C=A=0,r.mode=4;case 4:for(;C<16;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}r.head&&(r.head.xflags=255&A,r.head.os=A>>8),512&r.flags&&(E[0]=255&A,E[1]=A>>>8&255,r.check=s(r.check,E,2,0)),C=A=0,r.mode=5;case 5:if(1024&r.flags){for(;C<16;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}r.length=A,r.head&&(r.head.extra_len=A),512&r.flags&&(E[0]=255&A,E[1]=A>>>8&255,r.check=s(r.check,E,2,0)),C=A=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(L<(W=r.length)&&(W=L),W&&(r.head&&(t=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),h.arraySet(r.head.extra,j,G,W,t)),512&r.flags&&(r.check=s(r.check,j,W,G)),L-=W,G+=W,r.length-=W),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(L===0)break e;for(W=0;t=j[G+W++],r.head&&t&&r.length<65536&&(r.head.name+=String.fromCharCode(t)),t&&W<L;);if(512&r.flags&&(r.check=s(r.check,j,W,G)),L-=W,G+=W,t)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(L===0)break e;for(W=0;t=j[G+W++],r.head&&t&&r.length<65536&&(r.head.comment+=String.fromCharCode(t)),t&&W<L;);if(512&r.flags&&(r.check=s(r.check,j,W,G)),L-=W,G+=W,t)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;C<16;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(A!==(65535&r.check)){S.msg="header crc mismatch",r.mode=30;break}C=A=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),S.adler=r.check=0,r.mode=12;break;case 10:for(;C<32;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}S.adler=r.check=a(A),C=A=0,r.mode=11;case 11:if(r.havedict===0)return S.next_out=ae,S.avail_out=Q,S.next_in=G,S.avail_in=L,r.hold=A,r.bits=C,2;S.adler=r.check=1,r.mode=12;case 12:if(B===5||B===6)break e;case 13:if(r.last){A>>>=7&C,C-=7&C,r.mode=27;break}for(;C<3;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}switch(r.last=1&A,C-=1,3&(A>>>=1)){case 0:r.mode=14;break;case 1:if(N(r),r.mode=20,B!==6)break;A>>>=2,C-=2;break e;case 2:r.mode=17;break;case 3:S.msg="invalid block type",r.mode=30}A>>>=2,C-=2;break;case 14:for(A>>>=7&C,C-=7&C;C<32;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if((65535&A)!=(A>>>16^65535)){S.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&A,C=A=0,r.mode=15,B===6)break e;case 15:r.mode=16;case 16:if(W=r.length){if(L<W&&(W=L),Q<W&&(W=Q),W===0)break e;h.arraySet(se,j,G,W,ae),L-=W,G+=W,Q-=W,ae+=W,r.length-=W;break}r.mode=12;break;case 17:for(;C<14;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(r.nlen=257+(31&A),A>>>=5,C-=5,r.ndist=1+(31&A),A>>>=5,C-=5,r.ncode=4+(15&A),A>>>=4,C-=4,286<r.nlen||30<r.ndist){S.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;C<3;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}r.lens[V[r.have++]]=7&A,A>>>=3,C-=3}for(;r.have<19;)r.lens[V[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},F=p(0,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,F){S.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;fe=(g=r.lencode[A&(1<<r.lenbits)-1])>>>16&255,we=65535&g,!((ce=g>>>24)<=C);){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(we<16)A>>>=ce,C-=ce,r.lens[r.have++]=we;else{if(we===16){for(y=ce+2;C<y;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(A>>>=ce,C-=ce,r.have===0){S.msg="invalid bit length repeat",r.mode=30;break}t=r.lens[r.have-1],W=3+(3&A),A>>>=2,C-=2}else if(we===17){for(y=ce+3;C<y;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}C-=ce,t=0,W=3+(7&(A>>>=ce)),A>>>=3,C-=3}else{for(y=ce+7;C<y;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}C-=ce,t=0,W=11+(127&(A>>>=ce)),A>>>=7,C-=7}if(r.have+W>r.nlen+r.ndist){S.msg="invalid bit length repeat",r.mode=30;break}for(;W--;)r.lens[r.have++]=t}}if(r.mode===30)break;if(r.lens[256]===0){S.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,R={bits:r.lenbits},F=p(v,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,F){S.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},F=p(b,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,F){S.msg="invalid distances set",r.mode=30;break}if(r.mode=20,B===6)break e;case 20:r.mode=21;case 21:if(6<=L&&258<=Q){S.next_out=ae,S.avail_out=Q,S.next_in=G,S.avail_in=L,r.hold=A,r.bits=C,d(S,$),ae=S.next_out,se=S.output,Q=S.avail_out,G=S.next_in,j=S.input,L=S.avail_in,A=r.hold,C=r.bits,r.mode===12&&(r.back=-1);break}for(r.back=0;fe=(g=r.lencode[A&(1<<r.lenbits)-1])>>>16&255,we=65535&g,!((ce=g>>>24)<=C);){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(fe&&!(240&fe)){for(_e=ce,Me=fe,Ce=we;fe=(g=r.lencode[Ce+((A&(1<<_e+Me)-1)>>_e)])>>>16&255,we=65535&g,!(_e+(ce=g>>>24)<=C);){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}A>>>=_e,C-=_e,r.back+=_e}if(A>>>=ce,C-=ce,r.back+=ce,r.length=we,fe===0){r.mode=26;break}if(32&fe){r.back=-1,r.mode=12;break}if(64&fe){S.msg="invalid literal/length code",r.mode=30;break}r.extra=15&fe,r.mode=22;case 22:if(r.extra){for(y=r.extra;C<y;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}r.length+=A&(1<<r.extra)-1,A>>>=r.extra,C-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;fe=(g=r.distcode[A&(1<<r.distbits)-1])>>>16&255,we=65535&g,!((ce=g>>>24)<=C);){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(!(240&fe)){for(_e=ce,Me=fe,Ce=we;fe=(g=r.distcode[Ce+((A&(1<<_e+Me)-1)>>_e)])>>>16&255,we=65535&g,!(_e+(ce=g>>>24)<=C);){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}A>>>=_e,C-=_e,r.back+=_e}if(A>>>=ce,C-=ce,r.back+=ce,64&fe){S.msg="invalid distance code",r.mode=30;break}r.offset=we,r.extra=15&fe,r.mode=24;case 24:if(r.extra){for(y=r.extra;C<y;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}r.offset+=A&(1<<r.extra)-1,A>>>=r.extra,C-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){S.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(Q===0)break e;if(W=$-Q,r.offset>W){if((W=r.offset-W)>r.whave&&r.sane){S.msg="invalid distance too far back",r.mode=30;break}le=W>r.wnext?(W-=r.wnext,r.wsize-W):r.wnext-W,W>r.length&&(W=r.length),pe=r.window}else pe=se,le=ae-r.offset,W=r.length;for(Q<W&&(W=Q),Q-=W,r.length-=W;se[ae++]=pe[le++],--W;);r.length===0&&(r.mode=21);break;case 26:if(Q===0)break e;se[ae++]=r.length,Q--,r.mode=21;break;case 27:if(r.wrap){for(;C<32;){if(L===0)break e;L--,A|=j[G++]<<C,C+=8}if($-=Q,S.total_out+=$,r.total+=$,$&&(S.adler=r.check=r.flags?s(r.check,se,$,ae-$):n(r.check,se,$,ae-$)),$=Q,(r.flags?A:a(A))!==r.check){S.msg="incorrect data check",r.mode=30;break}C=A=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;C<32;){if(L===0)break e;L--,A+=j[G++]<<C,C+=8}if(A!==(4294967295&r.total)){S.msg="incorrect length check",r.mode=30;break}C=A=0}r.mode=29;case 29:F=1;break e;case 30:F=-3;break e;case 31:return-4;case 32:default:return o}return S.next_out=ae,S.avail_out=Q,S.next_in=G,S.avail_in=L,r.hold=A,r.bits=C,(r.wsize||$!==S.avail_out&&r.mode<30&&(r.mode<27||B!==4))&&te(S,S.output,S.next_out,$-S.avail_out)?(r.mode=31,-4):(q-=S.avail_in,$-=S.avail_out,S.total_in+=q,S.total_out+=$,r.total+=$,r.wrap&&$&&(S.adler=r.check=r.flags?s(r.check,se,$,S.next_out-$):n(r.check,se,$,S.next_out-$)),S.data_type=r.bits+(r.last?64:0)+(r.mode===12?128:0)+(r.mode===20||r.mode===15?256:0),(q==0&&$===0||B===4)&&F===u&&(F=-5),F)},f.inflateEnd=function(S){if(!S||!S.state)return o;var B=S.state;return B.window&&(B.window=null),S.state=null,u},f.inflateGetHeader=function(S,B){var r;return S&&S.state&&2&(r=S.state).wrap?((r.head=B).done=!1,u):o},f.inflateSetDictionary=function(S,B){var r,j=B.length;return S&&S.state?(r=S.state).wrap!==0&&r.mode!==11?o:r.mode===11&&n(1,B,j,0)!==r.check?-3:te(S,B,j,j)?(r.mode=31,-4):(r.havedict=1,u):o},f.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(i,e,f){var h=i("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(v,b,u,o,_,l,c,a){var m,k,I,O,D,P,U,T,N,te=a.bits,S=0,B=0,r=0,j=0,se=0,G=0,ae=0,L=0,Q=0,A=0,C=null,q=0,$=new h.Buf16(16),W=new h.Buf16(16),le=null,pe=0;for(S=0;S<=15;S++)$[S]=0;for(B=0;B<o;B++)$[b[u+B]]++;for(se=te,j=15;1<=j&&$[j]===0;j--);if(j<se&&(se=j),j===0)return _[l++]=20971520,_[l++]=20971520,a.bits=1,0;for(r=1;r<j&&$[r]===0;r++);for(se<r&&(se=r),S=L=1;S<=15;S++)if(L<<=1,(L-=$[S])<0)return-1;if(0<L&&(v===0||j!==1))return-1;for(W[1]=0,S=1;S<15;S++)W[S+1]=W[S]+$[S];for(B=0;B<o;B++)b[u+B]!==0&&(c[W[b[u+B]]++]=B);if(P=v===0?(C=le=c,19):v===1?(C=n,q-=257,le=s,pe-=257,256):(C=d,le=p,-1),S=r,D=l,ae=B=A=0,I=-1,O=(Q=1<<(G=se))-1,v===1&&852<Q||v===2&&592<Q)return 1;for(;;){for(U=S-ae,N=c[B]<P?(T=0,c[B]):c[B]>P?(T=le[pe+c[B]],C[q+c[B]]):(T=96,0),m=1<<S-ae,r=k=1<<G;_[D+(A>>ae)+(k-=m)]=U<<24|T<<16|N|0,k!==0;);for(m=1<<S-1;A&m;)m>>=1;if(m!==0?(A&=m-1,A+=m):A=0,B++,--$[S]==0){if(S===j)break;S=b[u+c[B]]}if(se<S&&(A&O)!==I){for(ae===0&&(ae=se),D+=r,L=1<<(G=S-ae);G+ae<j&&!((L-=$[G+ae])<=0);)G++,L<<=1;if(Q+=1<<G,v===1&&852<Q||v===2&&592<Q)return 1;_[I=A&O]=se<<24|G<<16|D-l|0}}return A!==0&&(_[D+A]=S-ae<<24|64<<16|0),a.bits=se,0}},{"../utils/common":41}],51:[function(i,e,f){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(i,e,f){var h=i("../utils/common"),n=0,s=1;function d(g){for(var E=g.length;0<=--E;)g[E]=0}var p=0,v=29,b=256,u=b+1+v,o=30,_=19,l=2*u+1,c=15,a=16,m=7,k=256,I=16,O=17,D=18,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],U=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=new Array(2*(u+2));d(te);var S=new Array(2*o);d(S);var B=new Array(512);d(B);var r=new Array(256);d(r);var j=new Array(v);d(j);var se,G,ae,L=new Array(o);function Q(g,E,V,H,x){this.static_tree=g,this.extra_bits=E,this.extra_base=V,this.elems=H,this.max_length=x,this.has_stree=g&&g.length}function A(g,E){this.dyn_tree=g,this.max_code=0,this.stat_desc=E}function C(g){return g<256?B[g]:B[256+(g>>>7)]}function q(g,E){g.pending_buf[g.pending++]=255&E,g.pending_buf[g.pending++]=E>>>8&255}function $(g,E,V){g.bi_valid>a-V?(g.bi_buf|=E<<g.bi_valid&65535,q(g,g.bi_buf),g.bi_buf=E>>a-g.bi_valid,g.bi_valid+=V-a):(g.bi_buf|=E<<g.bi_valid&65535,g.bi_valid+=V)}function W(g,E,V){$(g,V[2*E],V[2*E+1])}function le(g,E){for(var V=0;V|=1&g,g>>>=1,V<<=1,0<--E;);return V>>>1}function pe(g,E,V){var H,x,Z=new Array(c+1),K=0;for(H=1;H<=c;H++)Z[H]=K=K+V[H-1]<<1;for(x=0;x<=E;x++){var Y=g[2*x+1];Y!==0&&(g[2*x]=le(Z[Y]++,Y))}}function ce(g){var E;for(E=0;E<u;E++)g.dyn_ltree[2*E]=0;for(E=0;E<o;E++)g.dyn_dtree[2*E]=0;for(E=0;E<_;E++)g.bl_tree[2*E]=0;g.dyn_ltree[2*k]=1,g.opt_len=g.static_len=0,g.last_lit=g.matches=0}function fe(g){8<g.bi_valid?q(g,g.bi_buf):0<g.bi_valid&&(g.pending_buf[g.pending++]=g.bi_buf),g.bi_buf=0,g.bi_valid=0}function we(g,E,V,H){var x=2*E,Z=2*V;return g[x]<g[Z]||g[x]===g[Z]&&H[E]<=H[V]}function _e(g,E,V){for(var H=g.heap[V],x=V<<1;x<=g.heap_len&&(x<g.heap_len&&we(E,g.heap[x+1],g.heap[x],g.depth)&&x++,!we(E,H,g.heap[x],g.depth));)g.heap[V]=g.heap[x],V=x,x<<=1;g.heap[V]=H}function Me(g,E,V){var H,x,Z,K,Y=0;if(g.last_lit!==0)for(;H=g.pending_buf[g.d_buf+2*Y]<<8|g.pending_buf[g.d_buf+2*Y+1],x=g.pending_buf[g.l_buf+Y],Y++,H===0?W(g,x,E):(W(g,(Z=r[x])+b+1,E),(K=P[Z])!==0&&$(g,x-=j[Z],K),W(g,Z=C(--H),V),(K=U[Z])!==0&&$(g,H-=L[Z],K)),Y<g.last_lit;);W(g,k,E)}function Ce(g,E){var V,H,x,Z=E.dyn_tree,K=E.stat_desc.static_tree,Y=E.stat_desc.has_stree,oe=E.stat_desc.elems,me=-1;for(g.heap_len=0,g.heap_max=l,V=0;V<oe;V++)Z[2*V]!==0?(g.heap[++g.heap_len]=me=V,g.depth[V]=0):Z[2*V+1]=0;for(;g.heap_len<2;)Z[2*(x=g.heap[++g.heap_len]=me<2?++me:0)]=1,g.depth[x]=0,g.opt_len--,Y&&(g.static_len-=K[2*x+1]);for(E.max_code=me,V=g.heap_len>>1;1<=V;V--)_e(g,Z,V);for(x=oe;V=g.heap[1],g.heap[1]=g.heap[g.heap_len--],_e(g,Z,1),H=g.heap[1],g.heap[--g.heap_max]=V,g.heap[--g.heap_max]=H,Z[2*x]=Z[2*V]+Z[2*H],g.depth[x]=(g.depth[V]>=g.depth[H]?g.depth[V]:g.depth[H])+1,Z[2*V+1]=Z[2*H+1]=x,g.heap[1]=x++,_e(g,Z,1),2<=g.heap_len;);g.heap[--g.heap_max]=g.heap[1],function(he,Ie){var $e,Te,Ge,be,Xe,ct,De=Ie.dyn_tree,Ot=Ie.max_code,Qt=Ie.stat_desc.static_tree,en=Ie.stat_desc.has_stree,tn=Ie.stat_desc.extra_bits,Et=Ie.stat_desc.extra_base,qe=Ie.stat_desc.max_length,Qe=0;for(be=0;be<=c;be++)he.bl_count[be]=0;for(De[2*he.heap[he.heap_max]+1]=0,$e=he.heap_max+1;$e<l;$e++)qe<(be=De[2*De[2*(Te=he.heap[$e])+1]+1]+1)&&(be=qe,Qe++),De[2*Te+1]=be,Ot<Te||(he.bl_count[be]++,Xe=0,Et<=Te&&(Xe=tn[Te-Et]),ct=De[2*Te],he.opt_len+=ct*(be+Xe),en&&(he.static_len+=ct*(Qt[2*Te+1]+Xe)));if(Qe!==0){do{for(be=qe-1;he.bl_count[be]===0;)be--;he.bl_count[be]--,he.bl_count[be+1]+=2,he.bl_count[qe]--,Qe-=2}while(0<Qe);for(be=qe;be!==0;be--)for(Te=he.bl_count[be];Te!==0;)Ot<(Ge=he.heap[--$e])||(De[2*Ge+1]!==be&&(he.opt_len+=(be-De[2*Ge+1])*De[2*Ge],De[2*Ge+1]=be),Te--)}}(g,E),pe(Z,me,g.bl_count)}function t(g,E,V){var H,x,Z=-1,K=E[1],Y=0,oe=7,me=4;for(K===0&&(oe=138,me=3),E[2*(V+1)+1]=65535,H=0;H<=V;H++)x=K,K=E[2*(H+1)+1],++Y<oe&&x===K||(Y<me?g.bl_tree[2*x]+=Y:x!==0?(x!==Z&&g.bl_tree[2*x]++,g.bl_tree[2*I]++):Y<=10?g.bl_tree[2*O]++:g.bl_tree[2*D]++,Z=x,me=(Y=0)===K?(oe=138,3):x===K?(oe=6,3):(oe=7,4))}function F(g,E,V){var H,x,Z=-1,K=E[1],Y=0,oe=7,me=4;for(K===0&&(oe=138,me=3),H=0;H<=V;H++)if(x=K,K=E[2*(H+1)+1],!(++Y<oe&&x===K)){if(Y<me)for(;W(g,x,g.bl_tree),--Y!=0;);else x!==0?(x!==Z&&(W(g,x,g.bl_tree),Y--),W(g,I,g.bl_tree),$(g,Y-3,2)):Y<=10?(W(g,O,g.bl_tree),$(g,Y-3,3)):(W(g,D,g.bl_tree),$(g,Y-11,7));Z=x,me=(Y=0)===K?(oe=138,3):x===K?(oe=6,3):(oe=7,4)}}d(L);var R=!1;function y(g,E,V,H){$(g,(p<<1)+(H?1:0),3),function(x,Z,K,Y){fe(x),q(x,K),q(x,~K),h.arraySet(x.pending_buf,x.window,Z,K,x.pending),x.pending+=K}(g,E,V)}f._tr_init=function(g){R||(function(){var E,V,H,x,Z,K=new Array(c+1);for(x=H=0;x<v-1;x++)for(j[x]=H,E=0;E<1<<P[x];E++)r[H++]=x;for(r[H-1]=x,x=Z=0;x<16;x++)for(L[x]=Z,E=0;E<1<<U[x];E++)B[Z++]=x;for(Z>>=7;x<o;x++)for(L[x]=Z<<7,E=0;E<1<<U[x]-7;E++)B[256+Z++]=x;for(V=0;V<=c;V++)K[V]=0;for(E=0;E<=143;)te[2*E+1]=8,E++,K[8]++;for(;E<=255;)te[2*E+1]=9,E++,K[9]++;for(;E<=279;)te[2*E+1]=7,E++,K[7]++;for(;E<=287;)te[2*E+1]=8,E++,K[8]++;for(pe(te,u+1,K),E=0;E<o;E++)S[2*E+1]=5,S[2*E]=le(E,5);se=new Q(te,P,b+1,u,c),G=new Q(S,U,0,o,c),ae=new Q(new Array(0),T,0,_,m)}(),R=!0),g.l_desc=new A(g.dyn_ltree,se),g.d_desc=new A(g.dyn_dtree,G),g.bl_desc=new A(g.bl_tree,ae),g.bi_buf=0,g.bi_valid=0,ce(g)},f._tr_stored_block=y,f._tr_flush_block=function(g,E,V,H){var x,Z,K=0;0<g.level?(g.strm.data_type===2&&(g.strm.data_type=function(Y){var oe,me=4093624447;for(oe=0;oe<=31;oe++,me>>>=1)if(1&me&&Y.dyn_ltree[2*oe]!==0)return n;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return s;for(oe=32;oe<b;oe++)if(Y.dyn_ltree[2*oe]!==0)return s;return n}(g)),Ce(g,g.l_desc),Ce(g,g.d_desc),K=function(Y){var oe;for(t(Y,Y.dyn_ltree,Y.l_desc.max_code),t(Y,Y.dyn_dtree,Y.d_desc.max_code),Ce(Y,Y.bl_desc),oe=_-1;3<=oe&&Y.bl_tree[2*N[oe]+1]===0;oe--);return Y.opt_len+=3*(oe+1)+5+5+4,oe}(g),x=g.opt_len+3+7>>>3,(Z=g.static_len+3+7>>>3)<=x&&(x=Z)):x=Z=V+5,V+4<=x&&E!==-1?y(g,E,V,H):g.strategy===4||Z===x?($(g,2+(H?1:0),3),Me(g,te,S)):($(g,4+(H?1:0),3),function(Y,oe,me,he){var Ie;for($(Y,oe-257,5),$(Y,me-1,5),$(Y,he-4,4),Ie=0;Ie<he;Ie++)$(Y,Y.bl_tree[2*N[Ie]+1],3);F(Y,Y.dyn_ltree,oe-1),F(Y,Y.dyn_dtree,me-1)}(g,g.l_desc.max_code+1,g.d_desc.max_code+1,K+1),Me(g,g.dyn_ltree,g.dyn_dtree)),ce(g),H&&fe(g)},f._tr_tally=function(g,E,V){return g.pending_buf[g.d_buf+2*g.last_lit]=E>>>8&255,g.pending_buf[g.d_buf+2*g.last_lit+1]=255&E,g.pending_buf[g.l_buf+g.last_lit]=255&V,g.last_lit++,E===0?g.dyn_ltree[2*V]++:(g.matches++,E--,g.dyn_ltree[2*(r[V]+b+1)]++,g.dyn_dtree[2*C(E)]++),g.last_lit===g.lit_bufsize-1},f._tr_align=function(g){$(g,2,3),W(g,k,te),function(E){E.bi_valid===16?(q(E,E.bi_buf),E.bi_buf=0,E.bi_valid=0):8<=E.bi_valid&&(E.pending_buf[E.pending++]=255&E.bi_buf,E.bi_buf>>=8,E.bi_valid-=8)}(g)}},{"../utils/common":41}],53:[function(i,e,f){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(i,e,f){(function(h){(function(n,s){if(!n.setImmediate){var d,p,v,b,u=1,o={},_=!1,l=n.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(n);c=c&&c.setTimeout?c:n,d={}.toString.call(n.process)==="[object process]"?function(I){process.nextTick(function(){m(I)})}:function(){if(n.postMessage&&!n.importScripts){var I=!0,O=n.onmessage;return n.onmessage=function(){I=!1},n.postMessage("","*"),n.onmessage=O,I}}()?(b="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",k,!1):n.attachEvent("onmessage",k),function(I){n.postMessage(b+I,"*")}):n.MessageChannel?((v=new MessageChannel).port1.onmessage=function(I){m(I.data)},function(I){v.port2.postMessage(I)}):l&&"onreadystatechange"in l.createElement("script")?(p=l.documentElement,function(I){var O=l.createElement("script");O.onreadystatechange=function(){m(I),O.onreadystatechange=null,p.removeChild(O),O=null},p.appendChild(O)}):function(I){setTimeout(m,0,I)},c.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var O=new Array(arguments.length-1),D=0;D<O.length;D++)O[D]=arguments[D+1];var P={callback:I,args:O};return o[u]=P,d(u),u++},c.clearImmediate=a}function a(I){delete o[I]}function m(I){if(_)setTimeout(m,0,I);else{var O=o[I];if(O){_=!0;try{(function(D){var P=D.callback,U=D.args;switch(U.length){case 0:P();break;case 1:P(U[0]);break;case 2:P(U[0],U[1]);break;case 3:P(U[0],U[1],U[2]);break;default:P.apply(s,U)}})(O)}finally{a(I),_=!1}}}}function k(I){I.source===n&&typeof I.data=="string"&&I.data.indexOf(b)===0&&m(+I.data.slice(b.length))}})(typeof self>"u"?h===void 0?this:h:self)}).call(this,typeof Re<"u"?Re:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Kt);var ks=Kt.exports;const Nt=vn(ks);var Xt={exports:{}};(function(z,w){(function(i,e){e()})(Re,function(){function i(p,v){return typeof v>"u"?v={autoBom:!1}:typeof v!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),v={autoBom:!v}),v.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(p.type)?new Blob(["\uFEFF",p],{type:p.type}):p}function e(p,v,b){var u=new XMLHttpRequest;u.open("GET",p),u.responseType="blob",u.onload=function(){d(u.response,v,b)},u.onerror=function(){console.error("could not download file")},u.send()}function f(p){var v=new XMLHttpRequest;v.open("HEAD",p,!1);try{v.send()}catch{}return 200<=v.status&&299>=v.status}function h(p){try{p.dispatchEvent(new MouseEvent("click"))}catch{var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),p.dispatchEvent(v)}}var n=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Re=="object"&&Re.global===Re?Re:void 0,s=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=n.saveAs||(typeof window!="object"||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(p,v,b){var u=n.URL||n.webkitURL,o=document.createElement("a");v=v||p.name||"download",o.download=v,o.rel="noopener",typeof p=="string"?(o.href=p,o.origin===location.origin?h(o):f(o.href)?e(p,v,b):h(o,o.target="_blank")):(o.href=u.createObjectURL(p),setTimeout(function(){u.revokeObjectURL(o.href)},4e4),setTimeout(function(){h(o)},0))}:"msSaveOrOpenBlob"in navigator?function(p,v,b){if(v=v||p.name||"download",typeof p!="string")navigator.msSaveOrOpenBlob(i(p,b),v);else if(f(p))e(p,v,b);else{var u=document.createElement("a");u.href=p,u.target="_blank",setTimeout(function(){h(u)})}}:function(p,v,b,u){if(u=u||open("","_blank"),u&&(u.document.title=u.document.body.innerText="downloading..."),typeof p=="string")return e(p,v,b);var o=p.type==="application/octet-stream",_=/constructor/i.test(n.HTMLElement)||n.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&_||s)&&typeof FileReader<"u"){var c=new FileReader;c.onloadend=function(){var k=c.result;k=l?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=k:location=k,u=null},c.readAsDataURL(p)}else{var a=n.URL||n.webkitURL,m=a.createObjectURL(p);u?u.location=m:location.href=m,u=null,setTimeout(function(){a.revokeObjectURL(m)},4e4)}});n.saveAs=d.saveAs=d,z.exports=d})})(Xt);var Wt=Xt.exports;const Ss={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none"};function Cs(z,w){return J(),ee("svg",Ss,w[0]||(w[0]=[bn('<g stroke="currentColor" stroke-width="1.67" clip-path="url(#a)"><path stroke-linecap="round" stroke-linejoin="round" d="m9.5 12 2.5 2.497L14.5 12M11.998 14.494V9.5"></path><path d="M15 4.446V3a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h1.446"></path><rect width="14" height="14" x="5" y="5" rx="2"></rect></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h20v20H0z"></path></clipPath></defs>',2)]))}const xs={render:Cs},Os={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-file",viewBox:"0 0 24 24"};function Es(z,w){return J(),ee("svg",Os,w[0]||(w[0]=[M("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"},null,-1),M("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"},null,-1)]))}const Ms={render:Es},Is={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",class:"lucide lucide-mouse-pointer-click",viewBox:"0 0 24 24"};function zs(z,w){return J(),ee("svg",Is,w[0]||(w[0]=[M("path",{d:"M14 4.1 12 6M5.1 8l-2.9-.8M6 12l-1.9 2M7.2 2.2 8 5.1M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z"},null,-1)]))}const As={render:zs},Ts={__name:"fileClass",setup(z,{expose:w}){w();const i=ke(),{messages:e}=ve(i),{t:f}=Le(),h=ne(!1),n=ne(!1),s=ne("all"),d=ne(!1),p=ne({}),v=ne(""),b=ne(!1),u=ne(!1),o=Mt([]),_=()=>{const L=zt.viewLocal(e.value,!1),Q=new Map(o.map(A=>[A.id,A.selected]));o.length=0,L.forEach(A=>{o.push({...A,selected:Q.get(A.id)??!1})})};_(),je(e,_,{deep:!0});const l=["all","document","image","codeFile","link"],c={link:["com"],codeFile:["js","css","html","java","c#","cpp","py","go","php","ruby","swift","kotlin","scala","rust"],image:["jpg","jpeg","png","gif","bmp","svg","tiff","webp","ico"],document:["doc","docx","xls","xlsx","ppt","pptx","pdf","txt","md"]},a=ue(()=>(console.log("chooseClassType.value",s.value),s.value==="all"?o:o.filter(L=>{var A;const Q=L.filename.split(".").pop().toLowerCase();return(A=c[s.value])==null?void 0:A.includes(Q)}))),m=ue(()=>U(a.value)),k=ne(!1),I=ue(()=>{const L=a.value;if(L.length===0)return!1;const Q=L.some(C=>C.selected),A=L.every(C=>C.selected);return Q&&!A}),O=()=>{k.value=!k.value,a.value.forEach(L=>{L.selected=k.value})},D=()=>{const L=a.value;if(L.length===0){k.value=!1;return}k.value=L.every(Q=>Q.selected)},P=ue(()=>Object.values(m.value).some(L=>L.some(Q=>Q.selected)));je(P,L=>{u.value=!L},{immediate:!0}),je(a,L=>{D()},{immediate:!0});function U(L){d.value=L.length==0;const Q=new Date;Q.setHours(0,0,0,0);const A=new Date(Q);A.setDate(A.getDate()-1);const C={today:[],yesterday:[],earlier:[]};return L.sort((q,$)=>new Date($.timestamp)-new Date(q.timestamp)),L.forEach(q=>{const $=new Date(q.timestamp);$.setHours(0,0,0,0),$.getTime()===Q.getTime()?C.today.push(q):$.getTime()===A.getTime()?C.yesterday.push(q):C.earlier.push(q)}),Object.fromEntries(Object.entries(C).filter(([q,$])=>$.length>0))}const T=()=>{n.value=!1},N=()=>{h.value=!0},te=()=>{h.value=!1,k.value=!1,o.forEach(L=>{L.selected=!1})};async function S(L){p.value[L.id]=!1,et.handleFileDownload(L)}const B=L=>{et.imgType.includes(L.filename.split(".").pop())?tt.getFile(L.filepath).then(Q=>{v.value=URL.createObjectURL(Q),b.value=!0}):Oe.emit("fullPreviewVisable",L),n.value=!1},r=L=>{et.imgType.includes(L.filename.split(".").pop())?tt.getFile(L.filepath).then(Q=>{v.value=URL.createObjectURL(Q),b.value=!0}):B(L),p.value[L.id]=!1},j=L=>{p.value[L]=!p.value[L]},se=(L,Q)=>{p.value[L]=Q};async function G(){if(u.value)return;const L=Object.values(m.value).flat().filter(C=>C.selected);if(L.length===0){h.value=!1;return}console.log("selectedFiles",L);const Q=new Nt,A=L.map(async C=>{const q=C.filename.split("/").pop(),$=await tt.getFile(C.filepath);console.log("fileContent",$);const W=q.split(".").pop().toLowerCase(),le=c.image.includes(W)||["pdf","doc","docx","xls","xlsx","ppt","pptx","zip","rar"].includes(W);let pe=$;!le&&typeof $!="string"&&(pe=typeof $=="object"?JSON.stringify($,null,2):String($)),Q.file(q,pe,{binary:le})});try{await Promise.all(A);const C=await Q.generateAsync({type:"blob"});Wt.saveAs(C,`files_${new Date().toISOString().slice(0,10)}.zip`)}catch(C){console.error("Error creating ZIP file:",C)}h.value=!1,k.value=!1,o.forEach(C=>{C.selected=!1})}Oe.on("file-explorer-visible",()=>{n.value=!0});const ae={chatStore:i,messages:e,t:f,batchDownload:h,fileExplorerVisible:n,chooseClassType:s,clickDisable:d,tooltipVisible:p,imgUrl:v,imgVisable:b,clickDowload:u,fileListState:o,updateFileList:_,fileTypes:l,fileTypeExtensions:c,filteredFiles:a,fileListFilterByTimeAndType:m,selectedAll:k,isIndeterminate:I,selectAll:O,updateSelectedAll:D,hasSelectedFilesInCurrentGroup:P,groupFilesByTime:U,handleClose:T,handleBatchDownload:N,handleCancelBatchDownload:te,handleFileDownload:S,handleOpenFile:B,handlePreview:r,toggleTooltip:j,handleTooltipVisibleChange:se,confirmBatchDownload:G,ref:ne,computed:ue,reactive:Mt,watch:je,get useI18n(){return Le},get JSZip(){return Nt},get saveAs(){return Wt.saveAs},get downloadSvg(){return xs},get closeSvg(){return Mn},get emitter(){return Oe},fileSvg:qt,get moreOptionsSvg(){return Tn},get fileEmptySvg(){return Ms},get clickSvg(){return As},get downloadSvgDown(){return An},get viewList(){return zt},get useChatStore(){return ke},get storeToRefs(){return ve},get workspaceService(){return tt},imgModal:zn,get fileUtil(){return et},get formatTimeWithHMS(){return En}};return Object.defineProperty(ae,"__isScriptSetup",{enumerable:!1,value:!0}),ae}},Ps={class:"content"},Ls={key:0,class:"classList"},Ds={class:"header"},Rs={class:"title"},Bs={class:"btns"},Us={class:"svg"},Fs={class:"main"},js={class:"classTitle"},Ns=["onClick"],Ws={key:0,class:"classFiles"},Zs={class:"timeTitle"},Vs={class:"fileList"},Hs=["onClick"],$s={class:"fileInfo"},Gs={class:"fileNameContainer"},qs={class:"fileNameDiv"},Js={class:"fileNameSpan"},Ys={class:"time"},Ks={class:"custom-tooltip"},Xs=["onClick"],Qs=["onClick"],eo={key:1,class:"empty"},to={class:"emptyIcon"},no={class:"emptyText"},ro={class:"batchDownloadList"},io={class:"header"},so={class:"batchMain"},oo={class:"batchMainContent"},ao={class:"timeTitle"},lo={class:"fileList"},co={class:"timeContainer"},uo={class:"fileName"},ho={class:"time"},fo={class:"batchFooter"},po={class:"span"};function mo(z,w,i,e,f,h){const n=wn,s=yn,d=Ke,p=We;return J(),ee(ge,null,[X(p,{open:e.fileExplorerVisible,footer:null,style:{width:"600px","background-color":"#fff","border-color":"hsla(0, 0%, 100%, .05)","border-width":"1px","border-radius":"20px",overflow:"auto","flex-direction":"column","max-width":"95%","max-height":"95%",height:"680px",padding:"0px"},closable:!1,onCancel:e.handleClose,centered:!0,class:"modal"},{default:de(()=>[M("div",Ps,[e.batchDownload?(J(),ee(ge,{key:1},[ie(" Batch download mode "),M("div",ro,[ie(" 全选 + 取消 "),M("div",io,[M("div",{class:"selectAll",onClick:e.selectAll},[X(s,{checked:e.selectedAll,"onUpdate:checked":w[1]||(w[1]=v=>e.selectedAll=v),indeterminate:e.isIndeterminate},null,8,["checked","indeterminate"]),M("span",null,re(z.$t("lemon.fileExplorer.selectAll")),1)]),M("span",{class:"cancel",onClick:e.handleCancelBatchDownload},re(z.$t("lemon.fileExplorer.cancel")),1)]),ie(" 文件列表 "),M("div",so,[M("div",oo,[(J(!0),ee(ge,null,Se(e.fileListFilterByTimeAndType,(v,b)=>(J(),ee("div",{key:b,class:"timeGroup"},[M("h3",ao,re(z.$t(`lemon.fileExplorer.timeGroups.${b}`)),1),M("div",lo,[(J(!0),ee(ge,null,Se(v,u=>(J(),ee("div",{key:u.id,class:"fileItem"},[X(s,{checked:u.selected,"onUpdate:checked":o=>u.selected=o,onChange:e.updateSelectedAll},null,8,["checked","onUpdate:checked"]),X(e.fileSvg,{url:u.filepath,filepath:u.filepath,class:"svgItem"},null,8,["url","filepath"]),M("div",co,[M("span",uo,re(u.filename.split("/").pop().split("\\").pop()),1),M("span",ho,re(e.formatTimeWithHMS(u.timestamp)),1)])]))),128))])]))),128))])]),ie(" 底部按钮 批量下载 "),M("div",fo,[X(d,{type:"primary",onClick:e.confirmBatchDownload,class:Be(["btnDownload",e.clickDowload?"disableDownload":"enableDownload"])},{default:de(()=>[X(e.downloadSvg,{class:"svg"}),M("span",po,re(z.$t("lemon.fileExplorer.batchDownload")),1)]),_:1},8,["class"])])])],2112)):(J(),ee("div",Ls,[M("div",Ds,[M("h1",Rs,re(z.$t("lemon.fileExplorer.allFilesInTask")),1),M("div",Bs,[M("div",Us,[X(e.downloadSvg,{onClick:e.handleBatchDownload,class:Be(e.clickDisable?"disable":"svgDownload")},null,8,["class"])]),M("div",{class:"svg",onClick:e.handleClose},[X(e.closeSvg,{class:"svgClose"})])])]),M("div",Fs,[M("div",js,[(J(),ee(ge,null,Se(e.fileTypes,v=>M("div",{key:v,class:Be(["classBtn",e.chooseClassType===v?"active":""]),onClick:b=>e.chooseClassType=v},re(z.$t(`lemon.fileExplorer.fileTypes.${v}`)),11,Ns)),64))]),e.clickDisable?e.clickDisable?(J(),ee("div",eo,[M("div",to,[X(e.fileEmptySvg)]),M("div",no,[M("span",null,re(z.$t("lemon.fileExplorer.noContent")),1)])])):ie("v-if",!0):(J(),ee("div",Ws,[(J(!0),ee(ge,null,Se(e.fileListFilterByTimeAndType,(v,b)=>(J(),ee("div",{key:b,class:"timeGroup"},[M("h3",Zs,re(z.$t(`lemon.fileExplorer.timeGroups.${b}`)),1),M("div",Vs,[(J(!0),ee(ge,null,Se(v,u=>(J(),ee("div",{key:u.id,class:"fileItem",onClick:o=>e.handleOpenFile(u)},[X(e.fileSvg,{url:u.filename,filepath:u.filepath,class:"svgItem"},null,8,["url","filepath"]),M("div",$s,[ie(" 文件名 "),M("div",Gs,[M("div",qs,[M("span",Js,re(u.filename.split("/").pop().split("\\").pop()),1)]),M("span",Ys,re(e.formatTimeWithHMS(u.timestamp)),1)]),ie(" 更多选项 "),M("div",{class:"moreOption",onClick:w[0]||(w[0]=Ne(()=>{},["stop"]))},[X(n,{placement:"bottomRight",arrow:!1,color:"#ffffff",trigger:"click",visible:e.tooltipVisible[u.id]||!1,onVisibleChange:o=>e.handleTooltipVisibleChange(u.id,o)},{title:de(()=>[M("div",Ks,[M("div",{class:"svg-tooltip",onClick:o=>e.handlePreview(u)},[X(e.clickSvg),xe(" "+re(z.$t("lemon.fileExplorer.preview")),1)],8,Xs),M("div",{class:"svg-tooltip",onClick:o=>e.handleFileDownload(u)},[X(e.downloadSvgDown),xe(" "+re(z.$t("lemon.fileExplorer.download")),1)],8,Qs)])]),default:de(()=>[X(e.moreOptionsSvg,{onClick:o=>e.toggleTooltip(u.id)},null,8,["onClick"])]),_:2},1032,["visible","onVisibleChange"])])])],8,Hs))),128))])]))),128))]))])]))])]),_:1},8,["open"]),X(e.imgModal,{url:e.imgUrl,visible:e.imgVisable,onClose:w[2]||(w[2]=v=>e.imgVisable=!1)},null,8,["url","visible"])],64)}const _o=Ee(Ts,[["render",mo],["__scopeId","data-v-16bcb186"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/components/preview/fileClass.vue"]]),go={__name:"SuggestionCard",props:{icon:String,title:String,description:String},setup(z,{expose:w}){w();const i={};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},vo={class:"suggestion-card"},bo={class:"card-content"},wo={class:"card-title"},yo={class:"card-desc"};function ko(z,w,i,e,f,h){return J(),ee("div",vo,[w[0]||(w[0]=M("div",{class:"card-icon"},[ie(' <i :class="icon"></i> '),M("img",{src:"",style:{"aspect-ratio":"4 / 3",width:"100%"},alt:"icon",class:"card-icon-img"})],-1)),M("div",bo,[M("h3",wo,re(i.title),1),M("p",yo,re(i.description),1)])])}const So=Ee(go,[["render",ko],["__scopeId","data-v-182d2800"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/SuggestionCard.vue"]]),Co={__name:"Suggestion",setup(z,{expose:w}){w();const i=ke(),e=Ae(),f=ne(null),h=async d=>{const p=await i.createConversation(d.title);console.log("createConversation",p);const{conversation_id:v}=p;v&&(e.push(`/lemon/${v}`),await Pe.sendMessage(d.title,v,[]))},n=ne([{id:1,icon:"icon-japan",title:"四月日本之旅",description:"Lemon集成全面的旅游信息,制定个性化的行程表,并制作专为您定制的日本旅行计划"},{id:2,icon:"icon-analysis",title:"深度分析特斯拉股票",description:"Lemon提供深入的股票分析,通过现代化的引力分析仪表展现特斯拉的技术特点"},{id:3,icon:"icon-education",title:"动量定理互动课程",description:"Lemon为中学教育者制作了引人入胜的视频演示,通过演讲增进教育内容"},{id:4,icon:"icon-report",title:"保险资管报告分析",description:"Lemon生成清晰、结构化的对比表格,突出关键数据"}]),s={chatStore:i,router:e,currentChat:f,handleCardClick:h,suggestionCards:n,ref:ne,SuggestionCard:So,get useChatStore(){return ke},get seeAgent(){return Pe},get useRouter(){return Ae}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}},xo={class:"suggestion-cards"};function Oo(z,w,i,e,f,h){return J(),ee("div",xo,[(J(!0),ee(ge,null,Se(e.suggestionCards,n=>(J(),ye(e.SuggestionCard,kn({key:n.id,ref_for:!0},n,{onClick:s=>e.handleCardClick(n)}),null,16,["onClick"]))),128))])}const Eo=Ee(Co,[["render",Oo],["__scopeId","data-v-6032e9e3"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/Suggestion.vue"]]),Mo={__name:"Sample",emits:["sampleClick"],setup(z,{expose:w,emit:i}){w();const e=i,f=ne([{name:"Apple Market Analysis and Sales Forecast 2025",content:`Based on Apple's financial reports over the past five years and market analysis data from IDC/Partner, combined with the following multidimensional elements:
Regional market trends (China US trade policy, India manufacturing incentive program, EU digital bill)
Product line evolution (iPhone iteration cycle, AR/VR device launch plan, service business growth)
Macroeconomic indicators (IMF's 2025 GDP forecast for major economies, exchange rate volatility model)
Competitive landscape (Huawei's return to high-end models, Samsung's layout of foldable devices)
Supply chain factors (progress of Southeast Asian production base transfer, stability of chip supply)
requirement:

When predicting the top three sales markets, please provide:
Proportion of sales revenue segmented by product category (hardware/service)
Calculation of compound growth rate year-on-year in 2023
Local market specificity (such as China's trade in policy and India's tariff structure)
Using sensitivity analysis method, provide three predictions: baseline scenario, optimistic scenario, and conservative scenario
Annotations on key variables (such as the possibility of upgrading technology bans between China and the United States, and the risk of global economic recession)
Compare 2022 actual data with 2025 forecast data in the form of web pages and reports`},{name:"Children's Clock Quiz Web App",content:"Create a web application with the following requirements: randomly display a clock, display the time scale with numbers on the clock, provide two drop-down boxes for children to choose the hour and minute displayed on the current clock, and verify if the result is correct.final use nohup python3 http server to serve the app html"},{name:"Evolution of U.S. AI Industry Policies Over the Past Decade",content:"Create an illustrated report analyzing the evolution of U.S. AI industry policies over the past decade."}]),n={emit:e,data:f,handleClick:s=>{e("sampleClick",s)},ref:ne};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},Io={class:"sample"},zo=["onClick"],Ao={class:"item-title"};function To(z,w,i,e,f,h){return J(),ee("div",Io,[(J(!0),ee(ge,null,Se(e.data,(n,s)=>(J(),ee("div",{key:s,class:"sample-item"},[M("div",{class:"item",onClick:d=>e.handleClick(n)},[M("div",Ao,re(n.name),1)],8,zo)]))),128))])}const Po=Ee(Mo,[["render",To],["__scopeId","data-v-8ee31851"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/Sample.vue"]]),Lo={__name:"Welcome",props:{username:String},setup(z,{expose:w}){w();const i=ke(),e=Ae(),{t:f}=Le(),{chatInfo:h,mode:n}=ve(i),s=z,d=ne(!1),p=ne("Creating Agent...");function v(m="Creating Agent..."){p.value=m,d.value=!0}function b(m){p.value=m}function u(){d.value=!1}const o=m=>{Oe.emit("changeMessageText",m.content)},_=async m=>{const{text:k,files:I,mcp_server_ids:O,is_public:D,workMode:P}=m,U=await i.createConversation(k,n.value),{conversation_id:T}=U;if(n.value==="chat"&&T)e.push(`/lemon/chat/${T}`),await Pe.sendMessage(k,T,[],O,P);else{v("Creating Agent..."),await new Promise(te=>setTimeout(te,1e3)),b("Learning from the Experience base...");let N=await lt.generate(k,T,D);u(),Oe.emit("selectedAgent",N),e.push(`/lemon/${N.id}/${T}`),await Pe.sendMessage(k,T,I,O,P)}},l=ue(()=>n.value==="chat"?"ChatBot":"Agent"),a={chatStore:i,router:e,t:f,chatInfo:h,mode:n,props:s,isLoadingVisible:d,tip:p,show:v,update:b,hide:u,sampleClick:o,handleWelcomeInput:_,handleModeTitle:l,toggleMobileMenu:()=>{console.log("toggleMobileMenu"),Oe.emit("toggleMobileMenu",!0)},ref:ne,computed:ue,Suggestion:Eo,Sample:Po,ChatInput:xt,get useChatStore(){return ke},get seeAgent(){return Pe},get useRouter(){return Ae},get useI18n(){return Le},get emitter(){return Oe},get fileServices(){return Ze},get agentServices(){return lt},get Modal(){return We},get storeToRefs(){return ve}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}},Do={class:"welcome-screen"},Ro={class:"welcome-content"},Bo={key:0},Uo={key:1},Fo={key:0,class:"agent-loading"},jo={class:"tip"};function No(z,w,i,e,f,h){return J(),ee("div",Do,[M("div",{class:"welcome-header"},[M("button",{class:"mobile-menu-btn",onClick:e.toggleMobileMenu},w[0]||(w[0]=[M("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[M("path",{d:"M3 12H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),M("path",{d:"M3 6H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),M("path",{d:"M3 18H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))]),w[2]||(w[2]=M("div",{class:"welcome-mode"},[ie(" <h2>{{handleModeTitle }}</h2> ")],-1)),M("div",Ro,[M("h1",null,re(z.$t("lemon.welcome.greeting",{username:i.username})),1),e.mode=="chat"?(J(),ee("p",Bo,re(z.$t("lemon.welcome.question")),1)):(J(),ee("p",Uo,"Create, Training, Evoloving you new Agent")),X(e.ChatInput,{onSend:e.handleWelcomeInput})]),ie(' <Store class="store"></Store> '),e.isLoadingVisible?(J(),ee("div",Fo,[w[1]||(w[1]=M("div",{class:"loader"},null,-1)),M("p",jo,re(e.tip),1)])):ie("v-if",!0)])}const Wo=Ee(Lo,[["render",No],["__scopeId","data-v-178aa29e"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/Welcome.vue"]]),Zo={__name:"AgentWelcome",props:{username:String},setup(z,{expose:w}){w();const i=ke(),e=Ae(),{t:f}=Le(),{mode:h,agent:n}=ve(i),s=z,d=ne(null),p=ne(!1),v=()=>{console.log("editKnowledge"),l.value=!1,d.value.visible=!0},b=()=>{l.value=!1,p.value=!0},u=k=>{Oe.emit("changeMessageText",k.content)},o=async k=>{const{text:I,files:O,mcp_server_ids:D,workMode:P}=k,U=await i.createConversation(I,h.value),{conversation_id:T}=U;T&&e.push(`/lemon/${n.value.id}/${T}`),h.value==="chat"?await Pe.sendMessage(I,T,[],D,P):await Pe.sendMessage(I,T,O,D,P)},_=ue(()=>"Agent"),l=ne(!1),m={chatStore:i,router:e,t:f,mode:h,agent:n,props:s,knowledgeModalRef:d,editVisible:p,editKnowledge:v,openEdit:b,sampleClick:u,handleWelcomeInput:o,handleModeTitle:_,showDropdown:l,toggleDropdown:()=>{l.value=!l.value},closeDropdown:()=>{l.value=!1},ref:ne,computed:ue,ChatInput:xt,get CaretDownOutlined(){return xn},get useChatStore(){return ke},get seeAgent(){return Pe},get useRouter(){return Ae},get useI18n(){return Le},get emitter(){return Oe},get storeToRefs(){return ve},get EditOutlined(){return Cn},get DeleteOutlined(){return Sn},get ReadOutlined(){return Nn},KnowledgeModal:jn,AgentsEdit:Fn};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}},Vo={class:"welcome-mode"},Ho={key:0,class:"dropdown-menu"},$o={class:"welcome-content"};function Go(z,w,i,e,f,h){return J(),ee("div",{class:"welcome-screen",onClick:e.closeDropdown},[M("div",Vo,[M("span",null,re(e.agent.name),1),M("div",{class:"dropdown-icon-wrapper",onClick:Ne(e.toggleDropdown,["stop"])},[X(e.CaretDownOutlined,{class:"dropdown-icon"}),e.showDropdown?(J(),ee("div",Ho,[M("div",{class:"menu-item",onClick:Ne(e.openEdit,["stop"])},[X(e.EditOutlined,{class:"icon"}),w[2]||(w[2]=xe(" Edit "))]),M("div",{class:"menu-item",onClick:Ne(e.editKnowledge,["stop"])},[X(e.ReadOutlined,{class:"icon"}),w[3]||(w[3]=xe(" Knowledge "))]),ie(` <div class="menu-item danger" @click.stop="confirmDelete(agent.id)">
            <DeleteOutlined class="icon" /> Delete
          </div> `)])):ie("v-if",!0)])]),M("div",$o,[M("h1",null,re(z.$t("lemon.welcome.greeting",{username:i.username})),1),w[4]||(w[4]=M("p",null,"Create, Training, Evoloving you new Agent",-1)),X(e.ChatInput,{onSend:e.handleWelcomeInput})]),X(e.KnowledgeModal,{ref:"knowledgeModalRef",agentId:null},null,512),X(e.AgentsEdit,{visible:e.editVisible,"onUpdate:visible":w[0]||(w[0]=n=>e.editVisible=n),id:e.agent.id,"onUpdate:id":w[1]||(w[1]=n=>e.agent.id=n)},null,8,["visible","id"])])}const qo=Ee(Zo,[["render",Go],["__scopeId","data-v-3ea45d06"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/AgentWelcome.vue"]]);function Jo(z){console.log("convertToTree",z);const w=new Map;z.forEach(e=>{console.log("msg",e);let f=e.meta;typeof f=="string"&&(f=JSON.parse(f)),w.set(e.id,{id:e.id,pid:f.pid,role:e.role,content:e.content,is_active:f.is_active,children:[]})}),console.log("messageMap",w);const i=[];return w.forEach(e=>{if(e.pid===-1)i.push(e);else{const f=w.get(e.pid);f&&f.children.push(e)}}),i.sort((e,f)=>e.id-f.id),i}const Zt={convertToTree:Jo},Yo=Ve(),ze=ke(),{chatInfo:Ko,mode:Xo,model_id:Qo,agent:ea}=ve(ze),{membership:ta,points:na}=ve(Yo),ht=Ye();async function ra(){const z=localStorage.getItem("model_info");if(z&&!JSON.parse(z).is_subscribe)return;let w=await Yt.getUserInfo();ta.value=w.membership,na.value=w.points}const ia=async(z,w)=>{z.forEach(async i=>{await Ze.putFile(i.id,w)})},sa=z=>{},oa=()=>{console.log("throttledScrollToBottom")},aa=async(z,w,i,e=[],f="auto")=>{const h=new AbortController;let n=[];i&&i.length>0&&(n=i.map(c=>c.id),i=i.map(c=>{const a=`${c.workspace_dir}/Conversation_${w.slice(0,6)}/upload/${c.name}`,m=c.name;return{...c,filepath:a,filename:m}}),await ia(i,w));let s=ze.list.find(c=>c.conversation_id==w);s&&(s.status="running");const d=ht.selectedHtml,p=ht.selectedPath,v=ht.selectedScreenshot;ze.handleInitMessage(z,i,v,p);let b="/api/agent/coding/sse",u={requirement:z,selection:d,screenshot:v,filepath:p,agent_id:ea.value.id,conversation_id:w,fileIds:n,mcp_server_ids:e,model_id:Qo.value,mode:f};console.log("options",u),console.log("mode.value",Xo.value),console.log("chatInfo.value",Ko.value);let o=null;Pn(b,u,(c,a,m)=>{let k=ze.list.find(O=>O.conversation_id==m);if(k&&k.status==="done")return;const I=ze.conversationId;if(console.log("onTokenStream",a),a.startsWith("__lemon_mode__"))try{const O=a.substring(14);o=JSON.parse(O).mode;const P=ze.messages.findLastIndex(U=>U.role==="assistant"&&U.is_temp===!0);if(P!==-1){const U=ze.messages[P];o=="chat"?(U.meta={action_type:"chat"},U.content=""):U.content=st.global.t("lemon.message.botInitialResponse")}else if(o=="chat"){const U={content:"",role:"assistant",meta:{action_type:"chat"},is_temp:!0};ze.messages.push(U)}else{const U={content:st.global.t("lemon.message.botInitialResponse"),role:"assistant",is_temp:!0};ze.messages.push(U)}return}catch(O){console.error("Failed to parse mode data:",O);return}a&&a.startsWith("{")&&a.endsWith("}")&&I===m&&la(a)},sa(),"",oa,h,w).then(c=>c).catch(c=>(console.error(c),"")).finally(()=>{Oe.emit("coding-message-sent",{conversationId:w}),ze.list.find(c=>c.conversation_id==w).status="done",ra()})};function la(z,w){let i;try{i=JSON.parse(z)}catch{console.error("Failed to parse JSON:",z);return}console.log("=== ch === ",i);const e=ze.messages,f=ca(e);f!==-1&&e.splice(f,1),In.handleMessage(i,e),ze.scrollToBottom()}function ca(z){return z.findIndex(w=>w.is_temp===!0&&w.role==="assistant")}const Vt={sendMessage:aa},da={__name:"ChatPanel",setup(z,{expose:w}){w();const i=ke(),e=ot(),{chatInfo:f,mode:h}=ve(i),n=Ye(),s=async D=>{const{text:P,mode:U,files:T,mcp_server_ids:N,workMode:te}=D;if(n.showSelectionPreview){n.setShowSelectionPreview(!1),await Vt.sendMessage(P,i.chat.conversation_id,T,N,te);return}await Pe.sendMessage(P,i.chat.conversation_id,T,N,te)},d=ne(e.params.id),p=ue(()=>e.params.agentId&&e.params.agentId!="chat");it(()=>{console.log("route.params",e.params),d.value=e.params.id,e.params.id||(i.conversationId=null,i.chat=null,i.messages=[])});const v=ue(()=>i.chat),b=ne(""),u=ue(()=>{switch(console.log("出发了messages computed"),h.value){case"task":return i.messages;case"chat":return console.log("chatInfo.value.msgList",f.value.msgList),Zt.convertToTree(f.value.msgList);default:return i.messages}}),o=ne(!1);Ue(()=>{const D=document.querySelector(".chat-messages");if(!D)return!1;D.addEventListener("scroll",()=>{D.scrollHeight-D.scrollTop-D.clientHeight>200?o.value=!0:o.value=!1})});const _=()=>{const D=document.querySelector(".chat-messages");if(!D)return!1;D.scrollTop=D.scrollHeight-D.clientHeight},l=()=>{const D=i.events,P=JSON.stringify(D,null,2),U=new Blob([P],{type:"application/json"}),T=URL.createObjectURL(U),N=document.createElement("a");N.href=T,N.download=`chat-events-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(T)},c=ne(!1),O={chatStore:i,route:e,chatInfo:f,mode:h,editorStore:n,handleSendMessage:s,conversationId:d,agentId:p,currentChat:v,inputText:b,messages:u,isShowScrollToBottom:o,scrollToBottom:_,viewEvents:l,showConfirm:c,handleShare:()=>{},handleWelcomeInput:()=>{c.value=!0},handleAcceptConfirm:()=>{c.value=!1,v.value={id:Date.now(),title:b.value},u.value=[{id:Date.now(),type:"user",sender:username.value,content:b.value,time:new Date().toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}],b.value=""},handleRejectConfirm:()=>{c.value=!1},ref:ne,computed:ue,watchEffect:it,onMounted:Ue,ConversationList:br,ChatHeader:Rn,ChatMessages:Dn,Preview:Ln,LocalPreview:At,ChatInput:xt,get seeAgent(){return Pe},get useChatStore(){return ke},fullPreview:At,get Down(){return ys},fileClass:_o,get storeToRefs(){return ve},get useRoute(){return ot},Welcome:Wo,AgentWelcome:qo,get chat(){return Zt},get useEditorStore(){return Ye},get sse_coding(){return Vt}};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}},ua={class:"chat-layout"},ha={class:"chat-panel"},fa={key:1,class:"chat-panel-content"};function pa(z,w,i,e,f,h){var n;return J(),ee("div",ua,[X(e.ConversationList),M("div",ha,[e.agentId&&!e.conversationId?(J(),ye(e.AgentWelcome,{key:0,class:"welcome"})):e.conversationId?(J(),ee("div",fa,[X(e.ChatHeader,{title:(n=e.currentChat)==null?void 0:n.title,onShare:e.handleShare},null,8,["title"]),X(e.ChatMessages,{messages:e.messages,mode:e.mode},null,8,["messages","mode"]),X(e.ChatInput,{onSend:e.handleSendMessage}),e.isShowScrollToBottom?(J(),ee("div",{key:0,class:"scroll-to-bottom",onClick:e.scrollToBottom},[X(e.Down)])):ie("v-if",!0)])):(J(),ye(e.Welcome,{key:2,class:"welcome"})),X(e.fileClass)]),X(e.Preview,{class:"preview"}),X(e.LocalPreview,{class:"preview"})])}const Pa=Ee(da,[["render",pa],["__scopeId","data-v-a7e0635d"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/lemon/components/ChatPanel.vue"]]);export{Pa as default};
