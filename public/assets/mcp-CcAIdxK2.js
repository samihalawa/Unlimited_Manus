import{a as i,I as ne,_ as L,c as P,h as O,t as m,F as ce,Y as le,af as q,l as a,j as U,av as de,w as C,k as T,B as se,V as ve,ab as ae,aA as me,aB as ue,u as N,r as I,e as E,v as J,A as Y,X as R,g as p,L as pe,aC as X,aD as _e,n as fe,az as Se,i as ge,Z,o as Q,aE as he}from"./index-COUhflQL.js";import{C as ie}from"./CodeOutlined-U-EmMVev.js";import{s as K}from"./mcp-CPgW5lOl.js";import{h as A}from"./http-B5vhwVWP.js";var ye={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};function ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable}))),r.forEach(function(c){Oe(t,c,n[c])})}return t}function Oe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var W=function(e,n){var r=ee({},e,n.attrs);return i(ne,ee({},r,{icon:ye}),null)};W.displayName="ImportOutlined";W.inheritAttrs=!1;var be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};function te(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable}))),r.forEach(function(c){Ce(t,c,n[c])})}return t}function Ce(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var G=function(e,n){var r=te({},e,n.attrs);return i(ne,te({},r,{icon:be}),null)};G.displayName="SaveOutlined";G.inheritAttrs=!1;const Pe={__name:"ServerList",props:{servers:{type:Array,required:!0},selectedServerId:{type:[String,Number],default:null}},emits:["select"],setup(t,{expose:e}){e();const n={get CodeOutlined(){return ie}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},xe={class:"mcp-server-menu"},we={key:0,class:"no-servers-info"},ke=["onClick"],Ie={class:"menu-item-label"};function Me(t,e,n,r,c,d){return O(),P("div",xe,[!n.servers||n.servers.length===0?(O(),P("div",we,m(t.$t("setting.mcpService.noServersAvailable")),1)):(O(!0),P(ce,{key:1},le(n.servers,u=>(O(),P("div",{key:u.id,class:q(["menu-item",{"menu-item-selected":u.id===n.selectedServerId}]),onClick:b=>t.$emit("select",u)},[i(r.CodeOutlined),a("span",Ie,m(u.name),1),a("span",{class:q(["menu-item-status",{"menu-item-status-on":u.activate,"menu-item-status-off":!u.activate}])},null,2)],10,ke))),128))])}const Te=L(Pe,[["render",Me],["__scopeId","data-v-23e0bd52"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/components/mcpServer/ServerList.vue"]]),Ue={__name:"ServerSettings",props:{server:{type:Object,required:!0}},emits:["update:server","save","delete"],setup(t,{expose:e,emit:n}){e();const r=t,{t:c}=N(),d=n,u=I(""),b=I(""),S=I(!1),v=E(()=>{var s,_;return(_=(s=r.server)==null?void 0:s.command)==null?void 0:_.startsWith("npx")}),f=E(()=>{var s,_;return(_=(s=r.server)==null?void 0:s.command)==null?void 0:_.startsWith("uv")}),w=async()=>{try{return S.value=!0,(await K.connect(r.server)).ok}catch(s){return p.error(s.message),!1}finally{S.value=!1}},o=async s=>{if(s&&!await w()){p.error(c("mcpService.connectionFailed")),d("update:server",{...r.server,activate:!1});return}d("update:server",{...r.server,activate:s}),d("save")},z=s=>{if(!s){d("update:server",{...r.server,args:[]});return}const _=s.split(`
`).filter(k=>k.trim()!=="");d("update:server",{...r.server,args:_})},B=s=>{if(!s){d("update:server",{...r.server,env:{}});return}const _={};s.split(`
`).forEach(k=>{const l=k.trim();if(l){const[g,...x]=l.split("="),h=g.trim(),y=x.join("=").trim();h&&y&&(_[h]=y)}}),d("update:server",{...r.server,env:_})},V=s=>Array.isArray(s)?s.join(`
`):"",j=s=>Object.entries(s||{}).map(([_,k])=>`${_}=${k}`).join(`
`),F=s=>{R.confirm({title:c("setting.mcpService.deleteConfirmTitle"),icon:()=>Y(X,{style:"color: #ff4d4f"}),content:c("setting.mcpService.deleteConfirmContent"),okText:c("common.yes","Yes"),okType:"danger",cancelText:c("common.cancel","Cancel"),onOk(){d("delete",s)},onCancel(){console.log("Cancel")}})},H=s=>{d("update:server",{...r.server,...s})};J(()=>r.server,s=>{s&&(u.value=V(s.args||[]),b.value=j(s.env||{}))},{immediate:!0,deep:!0});const $={props:r,t:c,emit:d,argsText:u,envText:b,loading:S,startsWithNpx:v,startsWithUvx:f,validateServerConnection:w,handleActivateChange:o,handleArgsChange:z,handleEnvChange:B,formatArgsText:V,formatEnvText:j,showDeleteConfirm:F,handleUpdateServer:H,computed:E,ref:I,watch:J,h:Y,get SaveOutlined(){return G},get DeleteOutlined(){return _e},get ExclamationCircleOutlined(){return X},get LoadingOutlined(){return pe},get message(){return p},get Modal(){return R},get useI18n(){return N},get mcp_service(){return K}};return Object.defineProperty($,"__isScriptSetup",{enumerable:!1,value:!0}),$}},Ve={key:0,class:"mcp-server-content"},je={class:"mcp-server-content-header"},$e={style:{display:"flex","align-items":"center"}},De={class:"mcp-server-content-header-title"},Ae={style:{display:"flex","align-items":"center"}},Ee={class:"mcp-server-content-header-save-button-container"},Ne={class:"mcp-server-content-main"},Je={class:"mcp-server-content-main-name mcp-server-content-main-item"},Le={class:"mcp-server-content-main-description mcp-server-content-main-item"},ze={class:"mcp-server-content-main-type mcp-server-content-main-item"},Be={key:0,class:"mcp-server-content-main-command mcp-server-content-main-item"},Fe={key:2,class:"mcp-server-content-main-url mcp-server-content-main-item"},He={class:"mcp-server-content-main-args mcp-server-content-main-item"},Re={class:"mcp-server-content-main-env mcp-server-content-main-item"};function We(t,e,n,r,c,d){const u=de,b=se,S=ve,v=ae,f=me,w=ue;return n.server?(O(),P("div",Ve,[a("div",je,[a("div",$e,[a("span",De,m(n.server.name),1),i(r.DeleteOutlined,{class:"mcp-server-content-header-delete-button",onClick:e[0]||(e[0]=o=>r.showDeleteConfirm(n.server.id))})]),a("div",Ae,[i(u,{checked:n.server.activate,"onUpdate:checked":e[1]||(e[1]=o=>n.server.activate=o),class:"mcp-server-content-header-activate-switch",loading:r.loading,onChange:r.handleActivateChange},null,8,["checked","loading"]),a("div",Ee,[i(b,{type:"primary",onClick:e[2]||(e[2]=o=>t.$emit("save")),class:"mcp-server-content-header-save-button"},{default:C(()=>[i(r.SaveOutlined),T(" "+m(t.$t("setting.mcpService.save")),1)]),_:1})])])]),a("div",Ne,[a("div",Je,[a("span",null,m(t.$t("setting.mcpService.name")),1),i(S,{value:n.server.name,"onUpdate:value":e[3]||(e[3]=o=>n.server.name=o),placeholder:t.$t("setting.mcpService.namePlaceholder"),class:"text-item input"},null,8,["value","placeholder"])]),a("div",Le,[a("span",null,m(t.$t("setting.mcpService.description")),1),i(v,{value:n.server.description,"onUpdate:value":e[4]||(e[4]=o=>n.server.description=o),rows:4,placeholder:t.$t("setting.mcpService.descriptionPlaceholder"),class:"text-item"},null,8,["value","placeholder"])]),U(" type "),a("div",ze,[a("span",null,m(t.$t("setting.mcpService.type")),1),i(w,{value:n.server.type,"onUpdate:value":e[5]||(e[5]=o=>n.server.type=o),name:"radioGroup",class:"input radio"},{default:C(()=>[i(f,{value:"stdio"},{default:C(()=>[T(m(t.$t("setting.mcpService.stdio")),1)]),_:1}),i(f,{value:"sse"},{default:C(()=>[T(m(t.$t("setting.mcpService.sse")),1)]),_:1}),i(f,{value:"streamableHttp"},{default:C(()=>[T(m(t.$t("setting.mcpService.streamableHttp")),1)]),_:1})]),_:1},8,["value"])]),n.server.type==="stdio"?(O(),P("div",Be,[a("span",null,m(t.$t("setting.mcpService.command")),1),i(S,{value:n.server.command,"onUpdate:value":e[6]||(e[6]=o=>n.server.command=o),placeholder:t.$t("setting.mcpService.commandPlaceholder"),class:"text-item input"},null,8,["value","placeholder"])])):U("v-if",!0),U("v-if",!0),n.server.type==="sse"||n.server.type==="streamableHttp"?(O(),P("div",Fe,[a("span",null,m(t.$t("setting.mcpService.url")),1),i(S,{value:n.server.url,"onUpdate:value":[e[9]||(e[9]=o=>n.server.url=o),e[10]||(e[10]=o=>r.handleUpdateServer({url:o}))],placeholder:t.$t("setting.mcpService.url"),class:"text-item input"},null,8,["value","placeholder"])])):U("v-if",!0),a("div",He,[a("span",null,m(t.$t("setting.mcpService.args")),1),i(v,{value:r.argsText,"onUpdate:value":[e[11]||(e[11]=o=>r.argsText=o),r.handleArgsChange],rows:4,placeholder:t.$t("setting.mcpService.argsPlaceholder"),class:"text-item"},null,8,["value","placeholder"])]),a("div",Re,[a("span",null,m(t.$t("setting.mcpService.env")),1),i(v,{value:r.envText,"onUpdate:value":[e[12]||(e[12]=o=>r.envText=o),r.handleEnvChange],rows:4,placeholder:t.$t("setting.mcpService.envPlaceholder"),class:"text-item"},null,8,["value","placeholder"])])])])):U("v-if",!0)}const Ge=L(Ue,[["render",We],["__scopeId","data-v-3c52b7ae"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/components/mcpServer/ServerSettings.vue"]]),M=Se.global.t,re=fe("server",{state:()=>({servers:[]}),actions:{async fetchServers(){try{const t=await A.get("/api/mcp_server");console.log("response",t),this.servers=t,console.log("servers",this.servers)}catch(t){p.error(M("setting.mcpService.fetchFailed")),console.error("Fetch servers error:",t)}},async addServer(t){try{const e=await A.post("/api/mcp_server",t);console.log("add.server.response",e),this.servers.push(e),p.success(M("setting.mcpService.addSuccess"))}catch(e){p.error(M("setting.mcpService.addFailed")),console.error("Add server error:",e)}},async updateServer(t){try{await A.put(`/api/mcp_server/${t.id}`,t);const e=this.servers.findIndex(n=>n.id===t.id);e!==-1&&(this.servers[e]=t),p.success(M("setting.mcpService.updateSuccess"))}catch(e){p.error(M("setting.mcpService.updateFailed")),console.error("Update server error:",e)}},async deleteServer(t){try{await A.del(`/api/mcp_server/${t}`);const e=this.servers.findIndex(n=>n.id===t);e!==-1&&this.servers.splice(e,1),p.success(M("setting.mcpService.deleteSuccess"))}catch(e){p.error(M("setting.mcpService.deleteFailed")),console.error("Delete server error:",e)}}}}),qe={__name:"index",setup(t,{expose:e}){e();const{t:n}=N(),r=re(),{servers:c}=Z(r),{addServer:d,updateServer:u,deleteServer:b,fetchServers:S}=r,v=I(null),f=I(!1),w=I(""),o={mcpServers:{"amap-amap-sse":{url:"https://mcp.amap.com/sse?key=amap_key"}}},z=JSON.stringify(o,null,2),B=l=>{v.value=l},V=l=>{v.value={...v.value,...l}},j=()=>{v.value&&u(v.value)},F=l=>{b(l)},H=()=>{d({name:"MCP Server",description:"",activate:!1,type:"stdio",command:"",registryUrl:"",args:[],env:{}})},$=()=>{f.value=!0,w.value=""},s=l=>{const{url:g="",command:x=""}=l;return g.includes("sse")?"sse":x.startsWith("npx")||x.startsWith("uvx")?"stdio":g.includes("mcp")?"streamableHttp":"stdio"},_=()=>{try{const l=JSON.parse(w.value);if(l.mcpServers){const g=l.mcpServers;let x=0;for(const h in g)if(Object.prototype.hasOwnProperty.call(g,h)){const y=g[h],D=s(y),oe={name:h,description:y.description||"",activate:!1,url:y.url,type:D,command:D==="stdio"?y.command:"",args:y.args||[],env:y.env||{}};d(oe),x++}x>0?p.success(n("mcpService.importSuccess",{count:x})):p.warn(n("mcpService.noValidServer"))}else{if(!l.name){p.error(n("mcpService.nameRequired"));return}d(l),p.success(n("mcpService.importSuccessSingle"))}f.value=!1}catch(l){p.error(n("mcpService.invalidJson")),console.error("JSON parsing error:",l)}};J(()=>[...c.value],(l,g)=>{if(l.length>g.length){const h=l.find(y=>!g.some(D=>D.id===y.id));if(h){v.value=h;return}}v.value&&l.some(h=>h.id===v.value.id)||(v.value=l[0]||null)},{deep:!0}),Q(()=>{S()});const k={t:n,serverStore:r,mcpServerList:c,addServer:d,updateServer:u,deleteServer:b,fetchServers:S,chooseMCPServer:v,importModalVisible:f,importJsonText:w,exampleServer:o,exampleJson:z,handleMcpServer:B,handleUpdateServer:V,handleMCPServerSave:j,handleMCPServerDelete:F,handleAddServer:H,showImportModal:$,resolveMcpServerType:s,handleImportOk:_,ref:I,onMounted:Q,watch:J,computed:E,get storeToRefs(){return Z},get message(){return p},get PlusOutlined(){return he},get CodeOutlined(){return ie},get ImportOutlined(){return W},get useI18n(){return N},ServerList:Te,ServerSettings:Ge,get useServerStore(){return re}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},Ye={class:"mcp-manager-container"},Xe={class:"top-action-bar"},Ze={class:"title"},Qe={class:"actions"},Ke={class:"main-content"},et={class:"server-list-panel"},tt={class:"server-settings-panel"},rt={key:1,class:"no-server-placeholder"},nt={class:"placeholder-content"},st={class:"placeholder-icon"},at={class:"placeholder-text"};function it(t,e,n,r,c,d){var v;const u=se,b=ae,S=R;return O(),P("div",Ye,[a("div",Xe,[a("h2",Ze,m(t.$t("setting.mcpService.title")),1),a("div",Qe,[i(u,{onClick:r.showImportModal},{icon:C(()=>[i(r.ImportOutlined)]),default:C(()=>[T(" "+m(t.$t("setting.mcpService.importFromJson")),1)]),_:1}),i(u,{type:"primary",onClick:r.handleAddServer,style:{"margin-left":"8px"}},{icon:C(()=>[i(r.PlusOutlined)]),default:C(()=>[T(" "+m(t.$t("setting.mcpService.addMcpServer")),1)]),_:1})])]),a("div",Ke,[a("div",et,[i(r.ServerList,{servers:r.mcpServerList,selectedServerId:(v=r.chooseMCPServer)==null?void 0:v.id,onSelect:r.handleMcpServer},null,8,["servers","selectedServerId"])]),a("div",tt,[r.chooseMCPServer?(O(),ge(r.ServerSettings,{key:0,server:r.chooseMCPServer,"onUpdate:server":r.handleUpdateServer,onSave:r.handleMCPServerSave,onDelete:r.handleMCPServerDelete},null,8,["server"])):(O(),P("div",rt,[a("div",nt,[a("div",st,[i(r.CodeOutlined)]),a("p",at,m(t.$t("setting.mcpService.noServerSelected")),1)])]))])]),i(S,{visible:r.importModalVisible,"onUpdate:visible":e[1]||(e[1]=f=>r.importModalVisible=f),title:t.$t("setting.mcpService.importModalTitle"),onOk:r.handleImportOk,"ok-text":t.$t("setting.mcpService.ok"),"cancel-text":t.$t("setting.mcpService.cancel")},{default:C(()=>[a("pre",null,m(r.exampleJson),1),i(b,{value:r.importJsonText,"onUpdate:value":e[0]||(e[0]=f=>r.importJsonText=f),placeholder:"",rows:10},null,8,["value"])]),_:1},8,["visible","title","ok-text","cancel-text"])])}const ot=L(qe,[["render",it],["__scopeId","data-v-25b46fca"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/components/mcpServer/index.vue"]]),ct={__name:"mcp",setup(t,{expose:e}){e();const n={McpServer:ot};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},lt={class:"mcp-service"};function dt(t,e,n,r,c,d){return O(),P("div",lt,[i(r.McpServer)])}const _t=L(ct,[["render",dt],["__scopeId","data-v-c566bd5a"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/setting/mcp.vue"]]);export{_t as default};
