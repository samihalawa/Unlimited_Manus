import{s as L}from"./membership-BfcodThB.js";import{s as k}from"./auth-Cw-WJ-gA.js";import{u as T}from"./user-Bo0KfdR7.js";import{q as $,u as B,o as D,r as c,Y as N,d as R,l as t,e as r,t as l,x as a,w as p,W as H,C as O,g as j,h as q,U as A,V as E,$ as W,f as U}from"./index-DaULH4WC.js";import"./http-yCFEzgv3.js";const F={class:"usage"},G={class:"account-management"},J={class:"username-section",style:{"margin-bottom":"16px"}},K={class:"label"},Q={class:"password-reset-section"},X={class:"label"},Z={__name:"UserProfile",setup(ee){const{user:m,membership:ae,points:te}=T();j();const{t:e}=B();D(()=>{w()});const v=c(1),f=c(5),g=c(0),b=c([]),u=c(!1),d=c(""),i=c(!1),_=c(""),S=()=>{u.value=!0,d.value=m.user_name},P=async()=>{i.value=!0,_.value=""},x=async()=>{await k.updateUsername(d.value),u.value=!1,m.user_name=d.value,U.success(e("account.updateSuccess"))},C=async()=>{await k.resetPassword("",_.value,m.mobile),i.value=!1,U.success(e("account.updateSuccess"))},w=async()=>{const s=await L.getOrderList({page:v.value,pageSize:f.value});console.log(s),g.value=s.total,b.value=s.list},h=s=>{v.value=s.current,f.value=s.pageSize,w()},I=[{title:e("account.table.orderId"),dataIndex:"order_sn",key:"order_sn"},{title:e("account.table.orderAmount"),dataIndex:"amount",key:"amount"},{title:e("account.table.time"),dataIndex:"created_at",key:"created_at",customRender:({text:s})=>N(s).format("YYYY-MM-DD HH:mm")},{title:e("account.table.status"),key:"status",customRender:({record:s})=>{switch(s.status){case"pending":return e("account.orderStatus.pending");case"paid":return e("account.orderStatus.paid");case"cancelled":return e("account.orderStatus.cancelled");case"failed":return e("account.orderStatus.failed");default:return e("account.orderStatus.unknown")}}}];return(s,o)=>{const M=A,y=H,V=E,Y=W,z=O;return q(),R("div",F,[t("div",G,[t("div",J,[t("div",null,[t("span",K,l(a(e)("account.usernameLabel")),1),t("span",null,l(a(m).user_name),1)]),t("button",{onClick:S},l(a(e)("account.edit")),1)]),t("div",Q,[t("span",X,l(a(e)("account.passwordLabel")),1),t("button",{onClick:P},l(a(e)("account.resetPassword")),1)]),r(y,{centered:"",title:a(e)("account.editUsernameTitle"),open:u.value,"onUpdate:open":o[2]||(o[2]=n=>u.value=n)},{footer:p(()=>[t("button",{onClick:o[1]||(o[1]=n=>u.value=!1),style:{"background-color":"#0000330f","border-color":"#0000330f",color:"#1a1a19","margin-right":"8px"}},l(a(e)("account.cancel")),1),t("button",{type:"primary",onClick:x},l(a(e)("account.save")),1)]),default:p(()=>[r(M,{value:d.value,"onUpdate:value":o[0]||(o[0]=n=>d.value=n),placeholder:a(e)("account.newUsernamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["title","open"]),r(y,{centered:"",title:a(e)("account.resetPasswordTitle"),open:i.value,"onUpdate:open":o[5]||(o[5]=n=>i.value=n)},{footer:p(()=>[t("button",{onClick:o[4]||(o[4]=n=>i.value=!1),style:{"background-color":"#0000330f","border-color":"#0000330f",color:"#1a1a19","margin-right":"8px"}},l(a(e)("account.cancel")),1),t("button",{type:"primary",onClick:C},l(a(e)("account.save")),1)]),default:p(()=>[r(V,{value:_.value,"onUpdate:value":o[3]||(o[3]=n=>_.value=n),placeholder:a(e)("account.newPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["title","open"])]),r(z,{title:a(e)("account.ordersTitle")},{default:p(()=>[r(Y,{columns:I,onChange:h,"data-source":b.value,"row-key":"id",pagination:{current:v.value,pageSize:f.value,page:v.value,total:g.value}},null,8,["data-source","pagination"])]),_:1},8,["title"])])}}},re=$(Z,[["__scopeId","data-v-591c6219"]]);export{re as default};
