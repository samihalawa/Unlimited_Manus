import{a as s,I as ne,c as P,h as C,l as n,_ as U,j as u,i as L,w as i,k as _,t as m,B as N,U as j,V as B,W as J,P as D,u as E,Q as T,r as F,e as V,F as ae,aF as W,g as c,Z as X,d as Y,o as x}from"./index-COUhflQL.js";import{l as se}from"./lemon-D5W0kMi6.js";import{s as S}from"./auth-D-et7D_s.js";import{u as ee}from"./user-B_oAAdlF.js";import"./http-B5vhwVWP.js";var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"};function oe(t){for(var o=1;o<arguments.length;o++){var h=arguments[o]!=null?Object(arguments[o]):{},e=Object.keys(h);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(h).filter(function(p){return Object.getOwnPropertyDescriptor(h,p).enumerable}))),e.forEach(function(p){le(t,p,h[p])})}return t}function le(t,o,h){return o in t?Object.defineProperty(t,o,{value:h,enumerable:!0,configurable:!0,writable:!0}):t[o]=h,t}var G=function(o,h){var e=oe({},o,h.attrs);return s(ne,oe({},e,{icon:re}),null)};G.displayName="MobileOutlined";G.inheritAttrs=!1;const ie={xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24"};function de(t,o){return C(),P("svg",ie,o[0]||(o[0]=[n("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09"},null,-1),n("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23"},null,-1),n("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22z"},null,-1),n("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53"},null,-1)]))}const H={render:de},ue={__name:"login",emits:["toRegister","toForgot","handleLogin","handleGoogleLogin"],setup(t,{expose:o,emit:h}){o();const{t:e}=E(),p=h,l=T({email:"",phone:"",password:"",remember:!1}),a=F(!0),r=V(()=>{const I=!!l.password;return a.value?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email||"")&&I:/^1[3-9]\d{9}$/.test(l.phone||"")&&I}),k={t:e,emit:p,loginForm:l,isAbroad:a,isLoginValid:r,handleLogin:I=>{p("handleLogin",I)},handleSMSLogin:()=>{p("handleSMSLogin")},handleGoogleLogin:()=>{p("handleGoogleLogin")},toRegister:()=>{p("toRegister")},toForgot:()=>{p("toForgot")},computed:V,reactive:T,ref:F,get google(){return H},get MobileOutlined(){return G},get useI18n(){return E}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},me={class:"social-buttons"},ge={class:"divider"},ce={class:"form-label"},pe={class:"form-label"},fe={class:"password-label-container"},he={class:"form-label"},ve={class:"auth-footer"};function _e(t,o,h,e,p,l){const a=N,r=B,d=j,y=J,f=D;return C(),P("div",null,[u(" Login Form "),n("div",me,[e.isAbroad?(C(),L(a,{key:0,class:"social-button google",onClick:e.handleGoogleLogin},{icon:i(()=>[s(e.google)]),default:i(()=>[_(" "+m(t.$t("auth.loginWithGoogle")),1)]),_:1})):u("v-if",!0),u(" Apple login button hidden as requested "),u(" 手机号+短信验证码  登录 "),e.isAbroad?u("v-if",!0):(C(),L(a,{key:1,class:"social-button phone",onClick:e.handleSMSLogin},{icon:i(()=>[s(e.MobileOutlined)]),default:i(()=>[_(" "+m(t.$t("auth.loginWithPhone")),1)]),_:1}))]),n("div",ge,[n("span",null,m(t.$t("auth.or")),1)]),s(f,{model:e.loginForm,name:"login-form",onFinish:e.handleLogin,autocomplete:"off",layout:"vertical"},{default:i(()=>[u(" Email or Phone Input "),e.isAbroad?(C(),L(d,{key:0,name:"email",rules:[{required:!0,message:t.$t("auth.pleaseInputEmail")},{type:"email",message:t.$t("auth.pleaseInputValidEmail")}]},{default:i(()=>[n("div",ce,[_(m(t.$t("auth.email")),1),o[3]||(o[3]=n("span",{class:"required-mark"},"*",-1))]),s(r,{value:e.loginForm.email,"onUpdate:value":o[0]||(o[0]=b=>e.loginForm.email=b),placeholder:t.$t("auth.pleaseInputEmail")},null,8,["value","placeholder"])]),_:1},8,["rules"])):(C(),L(d,{key:1,name:"phone",rules:[{required:!0,message:t.$t("auth.pleaseInputPhone")},{pattern:/^1[3-9]\d{9}$/,message:t.$t("auth.pleaseInputValidPhone")}]},{default:i(()=>[n("div",pe,[_(m(t.$t("auth.phone")),1),o[4]||(o[4]=n("span",{class:"required-mark"},"*",-1))]),s(r,{value:e.loginForm.phone,"onUpdate:value":o[1]||(o[1]=b=>e.loginForm.phone=b),placeholder:t.$t("auth.pleaseInputPhone")},null,8,["value","placeholder"])]),_:1},8,["rules"])),u(" Password Input "),s(d,{name:"password",rules:[{required:!0,message:t.$t("auth.pleaseInputPassword")}]},{default:i(()=>[n("div",fe,[n("div",he,[_(m(t.$t("auth.password")),1),o[5]||(o[5]=n("span",{class:"required-mark"},"*",-1))]),n("a",{class:"forgot-link",onClick:e.toForgot},m(t.$t("auth.forgotPassword")),1)]),s(y,{value:e.loginForm.password,"onUpdate:value":o[2]||(o[2]=b=>e.loginForm.password=b),placeholder:t.$t("auth.pleaseInputPassword")},null,8,["value","placeholder"])]),_:1},8,["rules"]),u(" Submit Button "),s(d,null,{default:i(()=>[s(a,{type:"primary","html-type":"submit",block:"",loading:t.loading,disabled:!e.isLoginValid},{default:i(()=>[_(m(t.$t("auth.login")),1)]),_:1},8,["loading","disabled"])]),_:1}),u(" Footer "),n("div",ve,[n("span",null,m(t.$t("auth.noAccount")),1),n("a",{onClick:e.toRegister},m(t.$t("auth.register")),1),u(" 保持离线状态 ")])]),_:1},8,["model"])])}const we=U(ue,[["render",_e],["__scopeId","data-v-ad063d78"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/components/login.vue"]]),ye={__name:"register",emits:["toLogin","handleRegister","handleGoogleRegister"],setup(t,{expose:o,emit:h}){o();const e=F(!0),{t:p}=E(),l=h,a=F({fullname:"",email:"",phone:"",password:"",smsCode:""}),r=F(0);let d=null;const y=V(()=>a.value.fullname&&(e.value?a.value.email:a.value.phone)&&a.value.password&&(e.value?!0:a.value.smsCode)),f=async()=>{l("handleGoogleRegister")},b=()=>{l("toLogin")},v=async $=>{l("handleRegister",$)};function k(){if(!/^1[3-9]\d{9}$/.test(a.value.phone)){c.error(p("auth.pleaseInputValidPhone"));return}S.sendSmsCode(a.value.phone),r.value=60,d=setInterval(()=>{r.value--,r.value<=0&&(clearInterval(d),d=null)},1e3)}const I={isAbroad:e,t:p,emit:l,registerForm:a,smsCountdown:r,get smsTimer(){return d},set smsTimer($){d=$},isRegisterValid:y,handleGoogleRegister:f,toLogin:b,handleRegister:v,sendSMSCode:k,computed:V,reactive:T,ref:F,get google(){return H},get message(){return c},get MobileOutlined(){return G},get useI18n(){return E},get auth(){return S}};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}},Ce={class:"social-buttons"},be={key:0,class:"divider"},Se={class:"form-label"},Fe={class:"form-label"},Ie={class:"form-label"},Pe={class:"form-label"},Le={class:"form-label"},ke={class:"auth-footer"};function $e(t,o,h,e,p,l){const a=N,r=B,d=j,y=J,f=W,b=D;return C(),P("div",null,[u(" Register Form "),n("div",Ce,[e.isAbroad?(C(),L(a,{key:0,class:"social-button google",onClick:e.handleGoogleRegister},{icon:i(()=>[s(e.google)]),default:i(()=>[_(" "+m(t.$t("auth.registerWithGoogle")),1)]),_:1})):u("v-if",!0)]),e.isAbroad?(C(),P("div",be,[n("span",null,m(t.$t("auth.or")),1)])):u("v-if",!0),s(b,{model:e.registerForm,name:"register-form",onFinish:e.handleRegister,autocomplete:"off",layout:"vertical"},{default:i(()=>[u(" Fullname "),s(d,{name:"fullname",rules:[{required:!0,message:t.$t("auth.pleaseInputFullname")}]},{default:i(()=>[n("div",Se,[_(m(t.$t("auth.fullname")),1),o[5]||(o[5]=n("span",{class:"required-mark"},"*",-1))]),s(r,{value:e.registerForm.fullname,"onUpdate:value":o[0]||(o[0]=v=>e.registerForm.fullname=v),placeholder:t.$t("auth.pleaseInputFullname")},null,8,["value","placeholder"])]),_:1},8,["rules"]),u(" Email (abroad) "),e.isAbroad?(C(),L(d,{key:0,name:"email",rules:[{required:!0,message:t.$t("auth.pleaseInputEmail")},{type:"email",message:t.$t("auth.pleaseInputValidEmail")}]},{default:i(()=>[n("div",Fe,[_(m(t.$t("auth.email")),1),o[6]||(o[6]=n("span",{class:"required-mark"},"*",-1))]),s(r,{value:e.registerForm.email,"onUpdate:value":o[1]||(o[1]=v=>e.registerForm.email=v),placeholder:t.$t("auth.pleaseInputEmail")},null,8,["value","placeholder"])]),_:1},8,["rules"])):(C(),P(ae,{key:1},[u(" Phone (domestic) "),s(d,{name:"phone",rules:[{required:!0,message:t.$t("auth.pleaseInputPhone")},{pattern:/^1[3-9]\d{9}$/,message:t.$t("auth.pleaseInputValidPhone")}]},{default:i(()=>[n("div",Ie,[_(m(t.$t("auth.phone")),1),o[7]||(o[7]=n("span",{class:"required-mark"},"*",-1))]),s(r,{value:e.registerForm.phone,"onUpdate:value":o[2]||(o[2]=v=>e.registerForm.phone=v),placeholder:t.$t("auth.pleaseInputPhone")},null,8,["value","placeholder"])]),_:1},8,["rules"])],2112)),u(" Password "),s(d,{name:"password",rules:[{required:!0,message:t.$t("auth.pleaseInputPassword")}]},{default:i(()=>[n("div",Pe,[_(m(t.$t("auth.password")),1),o[8]||(o[8]=n("span",{class:"required-mark"},"*",-1))]),s(y,{value:e.registerForm.password,"onUpdate:value":o[3]||(o[3]=v=>e.registerForm.password=v),placeholder:t.$t("auth.pleaseInputPassword")},null,8,["value","placeholder"])]),_:1},8,["rules"]),u(" SMS Code (only for domestic users) "),e.isAbroad?u("v-if",!0):(C(),L(d,{key:2,name:"smsCode",rules:[{required:!0,message:t.$t("auth.pleaseInputSMSCode")}]},{default:i(()=>[n("div",Le,[_(m(t.$t("auth.smsCode")),1),o[9]||(o[9]=n("span",{class:"required-mark"},"*",-1))]),s(f,{compact:""},{default:i(()=>[s(r,{value:e.registerForm.smsCode,"onUpdate:value":o[4]||(o[4]=v=>e.registerForm.smsCode=v),style:{width:"65%"},placeholder:t.$t("auth.pleaseInputSMSCode")},null,8,["value","placeholder"]),s(a,{style:{width:"30%","margin-left":"5%",color:"#fff"},disabled:e.smsCountdown>0,onClick:e.sendSMSCode},{default:i(()=>[_(m(e.smsCountdown>0?`${e.smsCountdown}s`:t.$t("auth.sendCode")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["rules"])),u(" Submit Button "),s(d,null,{default:i(()=>[s(a,{type:"primary","html-type":"submit",block:"",loading:t.loading,disabled:!e.isRegisterValid},{default:i(()=>[_(m(t.$t("auth.register")),1)]),_:1},8,["loading","disabled"])]),_:1}),u(" Footer "),n("div",ke,[n("span",null,m(t.$t("auth.haveAccount")),1),n("a",{onClick:e.toLogin},m(t.$t("auth.login")),1)])]),_:1},8,["model"])])}const Ve=U(ye,[["render",$e],["__scopeId","data-v-b3c813ab"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/components/register.vue"]]),Re={__name:"forgot",emits:["toLogin","handleForgotPassword"],setup(t,{expose:o,emit:h}){o();const{t:e}=E(),p=h,l=F(!0),a=T({email:"",code:"",password:"",phone:"",smsCode:"",confirmPassword:""}),r=F(0);let d=null;const y=F(0);let f=null;const b=V(()=>{const R=a.password&&a.confirmPassword&&a.password===a.confirmPassword;if(l.value){const A=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email),K=!!a.code;return A&&K&&R}else{const A=/^1[3-9]\d{9}$/.test(a.phone),K=!!a.smsCode;return A&&K&&R}}),v=R=>{p("handleForgotPassword",R)};function k(){if(!/^1[3-9]\d{9}$/.test(a.phone)){c.error(e("auth.pleaseInputValidPhone"));return}S.sendSmsCode(a.phone),r.value=60,d=setInterval(()=>{r.value--,r.value<=0&&(clearInterval(d),d=null)},1e3)}function I(){if(!/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(a.email)){c.error(e("auth.pleaseEnterValidEmail"));return}S.sendEmailVerification(a.email),y.value=60,f=setInterval(()=>{y.value--,y.value<=0&&(clearInterval(f),f=null)},1e3),c.success(e("auth.codeSent"))}function $(R,A){return A!==a.password?Promise.reject(new Error(e("auth.passwordsDoNotMatch"))):Promise.resolve()}const O={t:e,emit:p,isAbroad:l,forgotForm:a,smsCountdown:r,get smsTimer(){return d},set smsTimer(R){d=R},emailCountdown:y,get emailTimer(){return f},set emailTimer(R){f=R},isForgotValid:b,handleForgotPassword:v,sendSMSCode:k,sendEmailCode:I,validateConfirmPassword:$,toLogin:()=>{p("toLogin")},computed:V,reactive:T,ref:F,get google(){return H},get message(){return c},get MobileOutlined(){return G},get useI18n(){return E},get auth(){return S}};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}},Ee={class:"form-label"},Me={class:"form-label"},Te={class:"form-label"},Oe={class:"form-label"},qe={class:"form-label"},Ae={class:"form-label"},Ue={class:"auth-footer"};function Ge(t,o,h,e,p,l){const a=B,r=j,d=N,y=W,f=J,b=D;return C(),P("div",null,[u(" Forgot Password Form "),s(b,{model:e.forgotForm,name:"forgot-form",onFinish:e.handleForgotPassword,autocomplete:"off",layout:"vertical"},{default:i(()=>[u(" 邮箱（海外）或手机号（国内） "),e.isAbroad?(C(),L(r,{key:0,name:"email",rules:[{required:!0,message:t.$t("auth.pleaseInputEmail")},{type:"email",message:t.$t("auth.pleaseInputValidEmail")}]},{default:i(()=>[n("div",Ee,[_(m(t.$t("auth.email")),1),o[6]||(o[6]=n("span",{class:"required-mark"},"*",-1))]),s(a,{value:e.forgotForm.email,"onUpdate:value":o[0]||(o[0]=v=>e.forgotForm.email=v),placeholder:t.$t("auth.pleaseInputEmail")},null,8,["value","placeholder"])]),_:1},8,["rules"])):(C(),L(r,{key:1,name:"phone",rules:[{required:!0,message:t.$t("auth.pleaseInputPhone")},{pattern:/^1[3-9]\d{9}$/,message:t.$t("auth.pleaseInputValidPhone")}]},{default:i(()=>[n("div",Me,[_(m(t.$t("auth.phone")),1),o[7]||(o[7]=n("span",{class:"required-mark"},"*",-1))]),s(a,{value:e.forgotForm.phone,"onUpdate:value":o[1]||(o[1]=v=>e.forgotForm.phone=v),placeholder:t.$t("auth.pleaseInputPhone")},null,8,["value","placeholder"])]),_:1},8,["rules"])),u(" 验证码 "),e.isAbroad?u("v-if",!0):(C(),L(r,{key:2,name:"smsCode",rules:[{required:!0,message:t.$t("auth.pleaseInputSMSCode")}]},{default:i(()=>[n("div",Te,[_(m(t.$t("auth.smsCode")),1),o[8]||(o[8]=n("span",{class:"required-mark"},"*",-1))]),s(y,{compact:""},{default:i(()=>[s(a,{value:e.forgotForm.smsCode,"onUpdate:value":o[2]||(o[2]=v=>e.forgotForm.smsCode=v),style:{width:"65%"},placeholder:t.$t("auth.pleaseInputSMSCode")},null,8,["value","placeholder"]),s(d,{style:{width:"30%","margin-left":"5%",color:"#fff"},disabled:e.smsCountdown>0,onClick:e.sendSMSCode},{default:i(()=>[_(m(e.smsCountdown>0?`${e.smsCountdown}s`:t.$t("auth.sendCode")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["rules"])),u(" 邮箱 验证码 "),e.isAbroad?(C(),L(r,{key:3,name:"code",rules:[{required:!0,message:t.$t("auth.pleaseInputVerifyCode")}]},{default:i(()=>[n("div",Oe,[_(m(t.$t("auth.verifyCode")),1),o[9]||(o[9]=n("span",{class:"required-mark"},"*",-1))]),s(y,{compact:""},{default:i(()=>[s(a,{value:e.forgotForm.code,"onUpdate:value":o[3]||(o[3]=v=>e.forgotForm.code=v),style:{width:"65%"},placeholder:t.$t("auth.pleaseInputVerifyCode")},null,8,["value","placeholder"]),s(d,{style:{width:"30%","margin-left":"5%",color:"#fff"},disabled:e.emailCountdown>0,onClick:e.sendEmailCode},{default:i(()=>[_(m(e.emailCountdown>0?`${e.emailCountdown}s`:t.$t("auth.sendCode")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["rules"])):u("v-if",!0),u(" 新密码 "),s(r,{name:"password",rules:[{required:!0,message:t.$t("auth.pleaseInputNewPassword")}]},{default:i(()=>[n("div",qe,[_(m(t.$t("auth.password")),1),o[10]||(o[10]=n("span",{class:"required-mark"},"*",-1))]),s(f,{value:e.forgotForm.password,"onUpdate:value":o[4]||(o[4]=v=>e.forgotForm.password=v),placeholder:t.$t("auth.pleaseInputNewPassword")},null,8,["value","placeholder"])]),_:1},8,["rules"]),u(" 确认密码 "),s(r,{name:"confirmPassword",rules:[{required:!0,message:t.$t("auth.pleaseConfirmPassword")},{validator:e.validateConfirmPassword}]},{default:i(()=>[n("div",Ae,[_(m(t.$t("auth.pleaseConfirmPassword")),1),o[11]||(o[11]=n("span",{class:"required-mark"},"*",-1))]),s(f,{value:e.forgotForm.confirmPassword,"onUpdate:value":o[5]||(o[5]=v=>e.forgotForm.confirmPassword=v),placeholder:t.$t("auth.pleaseConfirmPassword")},null,8,["value","placeholder"])]),_:1},8,["rules"]),u(" 提交按钮 "),s(r,null,{default:i(()=>[s(d,{type:"primary",disabled:!e.isForgotValid,"html-type":"submit",block:"",loading:t.loading},{default:i(()=>[_(m(t.$t("auth.resetPasswordButton")),1)]),_:1},8,["disabled","loading"])]),_:1}),u(" 返回登录 "),n("div",Ue,[n("a",{onClick:e.toLogin},m(t.$t("auth.backToLogin")),1)])]),_:1},8,["model"])])}const Ne=U(Re,[["render",Ge],["__scopeId","data-v-ee239622"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/components/forgot.vue"]]),je={__name:"sms-login",emits:["toLogin","handleLoginSMSCode"],setup(t,{expose:o,emit:h}){o();const{t:e}=E(),p=h,l=V(()=>!0),a=T({email:"",code:"",password:"",phone:"",smsCode:"",confirmPassword:""}),r=F(0);let d=null;const y=V(()=>{const I=/^1[3-9]\d{9}$/.test(a.phone),$=!!a.smsCode;return I&&$}),f=I=>{p("handleLoginSMSCode",I)};function b(){if(!/^1[3-9]\d{9}$/.test(a.phone)){c.error(e("auth.pleaseInputValidPhone"));return}S.sendSmsCode(a.phone),r.value=60,d=setInterval(()=>{r.value--,r.value<=0&&(clearInterval(d),d=null)},1e3)}const k={t:e,emit:p,isAbroad:l,loginForm:a,smsCountdown:r,get smsTimer(){return d},set smsTimer(I){d=I},isLoginValid:y,handleLoginSMSCode:f,sendSMSCode:b,toLogin:()=>{p("toLogin")},computed:V,reactive:T,ref:F,get google(){return H},get message(){return c},get MobileOutlined(){return G},get useI18n(){return E},get auth(){return S}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}},Be={class:"form-label"},De={class:"form-label"},He={class:"auth-footer"};function Ke(t,o,h,e,p,l){const a=B,r=j,d=N,y=W,f=D;return C(),P("div",null,[u(" Login Password Form "),s(f,{model:e.loginForm,name:"login-form",onFinish:e.handleLoginSMSCode,autocomplete:"off",layout:"vertical"},{default:i(()=>[s(r,{name:"phone",rules:[{required:!0,message:t.$t("auth.pleaseInputPhone")},{pattern:/^1[3-9]\d{9}$/,message:t.$t("auth.pleaseInputValidPhone")}]},{default:i(()=>[n("div",Be,[_(m(t.$t("auth.phone")),1),o[2]||(o[2]=n("span",{class:"required-mark"},"*",-1))]),s(a,{value:e.loginForm.phone,"onUpdate:value":o[0]||(o[0]=b=>e.loginForm.phone=b),placeholder:t.$t("auth.pleaseInputPhone")},null,8,["value","placeholder"])]),_:1},8,["rules"]),u(" 验证码 "),s(r,{name:"smsCode",rules:[{required:!0,message:t.$t("auth.pleaseInputSMSCode")}]},{default:i(()=>[n("div",De,[_(m(t.$t("auth.smsCode")),1),o[3]||(o[3]=n("span",{class:"required-mark"},"*",-1))]),s(y,{compact:""},{default:i(()=>[s(a,{value:e.loginForm.smsCode,"onUpdate:value":o[1]||(o[1]=b=>e.loginForm.smsCode=b),style:{width:"65%"},placeholder:t.$t("auth.pleaseInputSMSCode")},null,8,["value","placeholder"]),s(d,{style:{width:"30%","margin-left":"5%",color:"#fff"},disabled:e.smsCountdown>0,onClick:e.sendSMSCode},{default:i(()=>[_(m(e.smsCountdown>0?`${e.smsCountdown}s`:t.$t("auth.sendCode")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["rules"]),u(" 提交按钮 "),s(r,null,{default:i(()=>[s(d,{type:"primary",disabled:!e.isLoginValid,"html-type":"submit",block:"",loading:t.loading},{default:i(()=>[_(m(t.$t("auth.login")),1)]),_:1},8,["disabled","loading"])]),_:1}),u(" 返回登录 "),n("div",He,[n("a",{onClick:e.toLogin},m(t.$t("auth.otherLogin")),1)])]),_:1},8,["model"])])}const ze=U(je,[["render",Ke],["__scopeId","data-v-05687b44"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/components/sms-login.vue"]]),Je={__name:"Login",setup(t,{expose:o}){o();const h=ee(),{user:e}=X(h),p=Y(),{t:l}=E(),a=F("login"),r=F(!1);x(()=>{console.log("isClient === ",!1),window.electronAPI&&window.electronAPI.on("oauth-login-success",({code:w,state:q})=>{e.value.id?window.location.href="/":window.location.hash=`/auth/google?code=${w}&state=${q}`})});const d=F(!0),y=F(""),f=T({code:""}),b=V(()=>{switch(a.value){case"login":return l("auth.loginToLemonAI");case"register":return l("auth.registerLemonAIAccount");case"verify":return l("auth.verifyEmail");case"smsLogin":return l("auth.loginToLemonAI");default:return l("auth.resetPassword")}}),v=async()=>{try{r.value=!0;const g=await S.verifyEmailVerifyCode(y.value,f.code);if(g.code===200){const w=await S.register(O.value.fullname,O.value.email,O.value.password,"");w.code===200?(c.success(l("auth.registrationSuccessful")),a.value="login"):c.error(w.message)}else c.error(g.message)}catch{c.error(l("auth.verificationCodeError"))}finally{r.value=!1}},k=async()=>{const g=new Date,w=localStorage.getItem("lastSendTime");if(w){const M=new Date(w);if(g-M<6e4){c.error(l("auth.doNotSendFrequently"));return}}localStorage.setItem("lastSendTime",g.toString()),r.value=!0;const q=await S.sendEmailVerification(y.value);q.code===200?(f.code="",c.info(l("auth.codeResent")),r.value=!1):(c.error(q.message),r.value=!1)},I=()=>{p.push("/")},$=async g=>{try{r.value=!0;const w=await S.login(g.email,g.password,g.phone);console.log("res",w),w.code===200?(c.success(l("auth.loginSuccessful")),p.push({name:"lemon"})):c.error(w.message)}catch(w){console.log("error",w),c.error(l("auth.loginFailed"))}finally{r.value=!1}},Z=async g=>{const w=await S.loginSMSCode(g.phone,g.smsCode);if(w.code===200)c.success(l("auth.loginSuccessful")),p.push({name:"lemon"});else{c.error(w.message);return}},O=F({}),Q={userStore:h,user:e,router:p,t:l,activeKey:a,loading:r,isAbroad:d,verifyEmail:y,verifyForm:f,pageTitle:b,handleVerify:v,resendCode:k,toHome:I,handleLogin:$,handleLoginSMSCode:Z,registerForm:O,handleRegister:async g=>{console.log("handleRegister",g),O.value=g;try{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.email)&&d.value)throw new Error(l("auth.pleaseEnterValidEmail"));if(!/^1[3-9]\d{9}$/.test(g.phone)&&!d.value)throw new Error(l("auth.pleaseInputValidPhone"));if(g.password.length<6)throw new Error(l("auth.passwordTooShort"));if(d.value){y.value=g.email;const M=await S.sendEmailVerification(g.email);M.code===200?(c.success(l("auth.codeSent")),a.value="verify"):c.error(M.message)}else{let M=await S.verifySmsVerifyCode(g.phone,g.smsCode);if(M.code===200){let z=await S.register(g.fullname,"",g.password,g.phone);z.code===200?(c.success(l("auth.registrationSuccessful")),a.value="login"):c.error(z.message)}else c.error(l("auth.verificationCodeError"));console.log("smsRes",M)}localStorage.setItem("lastSendTime",new Date().toString())}catch(w){c.error(w.message||l("auth.registrationFailed"))}finally{}},handleForgotPassword:async g=>{try{r.value=!0;let w=null;if(d.value?w=await S.verifyEmailVerifyCode(g.email,g.code):w=await S.verifySmsVerifyCode(g.phone,g.smsCode),w.code===200)(await S.resetPassword(g.email,g.password,g.phone)).code===200?(c.success(l("auth.passwordResetSuccessful")),a.value="login"):c.error(l("auth.passwordResetFailed"));else{c.error(l("auth.codeError"));return}}catch{c.error(l("auth.passwordResetFailed"))}finally{r.value=!1}},handleGoogleLogin:()=>{try{r.value=!0;const w=!1?"/api/users/auth/google":"http://localhost:5005/api/users/auth/google",q="973572698649-hbp15ju1nhlsja1k2gbqktmrulk0hopp.apps.googleusercontent.com",M=encodeURIComponent("profile email"),te=`https://accounts.google.com/o/oauth2/auth?client_id=${q}&redirect_uri=${w}&scope=${M}&response_type=code&access_type=offline&prompt=consent`;window.location.href=te}catch{c.error(l("auth.googleLoginFailed"))}finally{r.value=!1}},handleAppleLogin:async()=>{try{r.value=!0,c.info(l("auth.appleLoginInProgress"))}finally{r.value=!1}},handleAppleRegister:async()=>{try{r.value=!0,c.info(l("auth.appleRegisterInProgress"))}finally{r.value=!1}},ref:F,reactive:T,computed:V,onMounted:x,get logo(){return se},get google(){return H},get useRouter(){return Y},get message(){return c},get auth(){return S},login:we,register:Ve,forgot:Ne,smsLogin:ze,get storeToRefs(){return X},get useUserStore(){return ee},get useI18n(){return E}};return Object.defineProperty(Q,"__isScriptSetup",{enumerable:!1,value:!0}),Q}},We={class:"auth-container"},Ze={class:"auth-content"},Qe={class:"logo-container"},Xe={class:"logo"},Ye=["src"],xe={class:"auth-title"},eo={key:0},oo={key:1},to={key:2},no={key:3},ao={key:4},so={class:"verify-container"},ro={class:"verify-text"},lo={class:"verify-footer"},io={class:"auth-footer"};function uo(t,o,h,e,p,l){const a=B,r=j,d=N,y=D;return C(),P("div",We,[n("div",Ze,[u(" Logo "),n("div",Qe,[n("div",Xe,[n("img",{src:e.logo,alt:"logo"},null,8,Ye)])]),u(" Title "),n("h2",xe,m(e.pageTitle),1),e.activeKey==="login"?(C(),P("div",eo,[s(e.login,{onToRegister:o[0]||(o[0]=f=>e.activeKey="register"),onHandleLogin:e.handleLogin,onToForgot:o[1]||(o[1]=f=>e.activeKey="forgot"),onHandleGoogleLogin:e.handleGoogleLogin,onHandleSMSLogin:o[2]||(o[2]=f=>e.activeKey="smsLogin")})])):u("v-if",!0),e.activeKey==="smsLogin"?(C(),P("div",oo,[s(e.smsLogin,{onToLogin:o[3]||(o[3]=f=>e.activeKey="login"),onHandleLoginSMSCode:e.handleLoginSMSCode})])):u("v-if",!0),e.activeKey==="register"?(C(),P("div",to,[u(" Register Form "),s(e.register,{onToLogin:o[4]||(o[4]=f=>e.activeKey="login"),onHandleRegister:e.handleRegister,onHandleGoogleRegister:e.handleGoogleLogin})])):u("v-if",!0),e.activeKey==="forgot"?(C(),P("div",no,[s(e.forgot,{onToLogin:o[5]||(o[5]=f=>e.activeKey="login"),onHandleForgotPassword:e.handleForgotPassword})])):u("v-if",!0),e.activeKey==="verify"?(C(),P("div",ao,[u(" Email Verification Form "),n("div",so,[n("p",ro,m(t.$t("auth.codeSentTo"))+" "+m(e.verifyEmail),1),s(y,{model:e.verifyForm,name:"verify-form",onFinish:e.handleVerify,autocomplete:"off",layout:"vertical"},{default:i(()=>[s(r,{name:"code",rules:[{required:!0,message:t.$t("auth.pleaseInput6DigitCode")}]},{default:i(()=>[s(a,{value:e.verifyForm.code,"onUpdate:value":o[6]||(o[6]=f=>e.verifyForm.code=f),placeholder:t.$t("auth.pleaseInput6DigitCode")},null,8,["value","placeholder"])]),_:1},8,["rules"]),s(r,null,{default:i(()=>[s(d,{type:"primary","html-type":"submit",block:"",loading:e.loading,disabled:!e.verifyForm.code},{default:i(()=>[_(m(t.$t("auth.verifyEmailButton")),1)]),_:1},8,["loading","disabled"])]),_:1}),n("div",lo,[n("p",null,[_(m(t.$t("auth.notReceivedCode"))+" ",1),n("a",{onClick:e.resendCode},m(t.$t("auth.resendCode")),1)])])]),_:1},8,["model"])])])):u("v-if",!0),n("div",io,[n("span",{class:"auth-footer-keep-offline",onClick:e.toHome},m(t.$t("auth.keepOffline")),1)])])])}const mo=U(Je,[["render",uo],["__scopeId","data-v-cc9726e5"],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/Login.vue"]]),go={__name:"index",setup(t,{expose:o}){o();const h={Login:mo};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}};function co(t,o,h,e,p,l){return C(),L(e.Login)}const Co=U(go,[["render",co],["__file","/Users/samihalawa/git/PROJECTS_CODING/lemonai/frontend/src/view/auth/index.vue"]]);export{Co as default};
